var nI=Object.defineProperty;var p0=n=>{throw TypeError(n)};var iI=(n,e,t)=>e in n?nI(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var J=(n,e,t)=>iI(n,typeof e!="symbol"?e+"":e,t),jp=(n,e,t)=>e.has(n)||p0("Cannot "+t);var c=(n,e,t)=>(jp(n,e,"read from private field"),t?t.call(n):e.get(n)),S=(n,e,t)=>e.has(n)?p0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),v=(n,e,t,i)=>(jp(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),w=(n,e,t)=>(jp(n,e,"access private method"),t);var Ut=(n,e,t,i)=>({set _(s){v(n,e,s,t)},get _(){return c(n,e,i)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function sI(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var yE={exports:{}},Tp={},vE={exports:{}},ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sh=Symbol.for("react.element"),rI=Symbol.for("react.portal"),oI=Symbol.for("react.fragment"),aI=Symbol.for("react.strict_mode"),lI=Symbol.for("react.profiler"),uI=Symbol.for("react.provider"),cI=Symbol.for("react.context"),dI=Symbol.for("react.forward_ref"),hI=Symbol.for("react.suspense"),fI=Symbol.for("react.memo"),pI=Symbol.for("react.lazy"),g0=Symbol.iterator;function gI(n){return n===null||typeof n!="object"?null:(n=g0&&n[g0]||n["@@iterator"],typeof n=="function"?n:null)}var _E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},AE=Object.assign,EE={};function mu(n,e,t){this.props=n,this.context=e,this.refs=EE,this.updater=t||_E}mu.prototype.isReactComponent={};mu.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};mu.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function SE(){}SE.prototype=mu.prototype;function Jy(n,e,t){this.props=n,this.context=e,this.refs=EE,this.updater=t||_E}var Xy=Jy.prototype=new SE;Xy.constructor=Jy;AE(Xy,mu.prototype);Xy.isPureReactComponent=!0;var m0=Array.isArray,wE=Object.prototype.hasOwnProperty,Qy={current:null},CE={key:!0,ref:!0,__self:!0,__source:!0};function TE(n,e,t){var i,s={},r=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(r=""+e.key),e)wE.call(e,i)&&!CE.hasOwnProperty(i)&&(s[i]=e[i]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)s[i]===void 0&&(s[i]=a[i]);return{$$typeof:sh,type:n,key:r,ref:o,props:s,_owner:Qy.current}}function mI(n,e){return{$$typeof:sh,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Zy(n){return typeof n=="object"&&n!==null&&n.$$typeof===sh}function yI(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var y0=/\/+/g;function eg(n,e){return typeof n=="object"&&n!==null&&n.key!=null?yI(""+n.key):e.toString(36)}function bh(n,e,t,i,s){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case sh:case rI:o=!0}}if(o)return o=n,s=s(o),n=i===""?"."+eg(o,0):i,m0(s)?(t="",n!=null&&(t=n.replace(y0,"$&/")+"/"),bh(s,e,t,"",function(u){return u})):s!=null&&(Zy(s)&&(s=mI(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(y0,"$&/")+"/")+n)),e.push(s)),1;if(o=0,i=i===""?".":i+":",m0(n))for(var a=0;a<n.length;a++){r=n[a];var l=i+eg(r,a);o+=bh(r,e,t,l,s)}else if(l=gI(n),typeof l=="function")for(n=l.call(n),a=0;!(r=n.next()).done;)r=r.value,l=i+eg(r,a++),o+=bh(r,e,t,l,s);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function hh(n,e,t){if(n==null)return n;var i=[],s=0;return bh(n,i,"","",function(r){return e.call(t,r,s++)}),i}function vI(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Kt={current:null},Dh={transition:null},_I={ReactCurrentDispatcher:Kt,ReactCurrentBatchConfig:Dh,ReactCurrentOwner:Qy};function IE(){throw Error("act(...) is not supported in production builds of React.")}ae.Children={map:hh,forEach:function(n,e,t){hh(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return hh(n,function(){e++}),e},toArray:function(n){return hh(n,function(e){return e})||[]},only:function(n){if(!Zy(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ae.Component=mu;ae.Fragment=oI;ae.Profiler=lI;ae.PureComponent=Jy;ae.StrictMode=aI;ae.Suspense=hI;ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_I;ae.act=IE;ae.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=AE({},n.props),s=n.key,r=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,o=Qy.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)wE.call(e,l)&&!CE.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:sh,type:n.type,key:s,ref:r,props:i,_owner:o}};ae.createContext=function(n){return n={$$typeof:cI,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:uI,_context:n},n.Consumer=n};ae.createElement=TE;ae.createFactory=function(n){var e=TE.bind(null,n);return e.type=n,e};ae.createRef=function(){return{current:null}};ae.forwardRef=function(n){return{$$typeof:dI,render:n}};ae.isValidElement=Zy;ae.lazy=function(n){return{$$typeof:pI,_payload:{_status:-1,_result:n},_init:vI}};ae.memo=function(n,e){return{$$typeof:fI,type:n,compare:e===void 0?null:e}};ae.startTransition=function(n){var e=Dh.transition;Dh.transition={};try{n()}finally{Dh.transition=e}};ae.unstable_act=IE;ae.useCallback=function(n,e){return Kt.current.useCallback(n,e)};ae.useContext=function(n){return Kt.current.useContext(n)};ae.useDebugValue=function(){};ae.useDeferredValue=function(n){return Kt.current.useDeferredValue(n)};ae.useEffect=function(n,e){return Kt.current.useEffect(n,e)};ae.useId=function(){return Kt.current.useId()};ae.useImperativeHandle=function(n,e,t){return Kt.current.useImperativeHandle(n,e,t)};ae.useInsertionEffect=function(n,e){return Kt.current.useInsertionEffect(n,e)};ae.useLayoutEffect=function(n,e){return Kt.current.useLayoutEffect(n,e)};ae.useMemo=function(n,e){return Kt.current.useMemo(n,e)};ae.useReducer=function(n,e,t){return Kt.current.useReducer(n,e,t)};ae.useRef=function(n){return Kt.current.useRef(n)};ae.useState=function(n){return Kt.current.useState(n)};ae.useSyncExternalStore=function(n,e,t){return Kt.current.useSyncExternalStore(n,e,t)};ae.useTransition=function(){return Kt.current.useTransition()};ae.version="18.3.1";vE.exports=ae;var nt=vE.exports;const AI=sI(nt);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EI=nt,SI=Symbol.for("react.element"),wI=Symbol.for("react.fragment"),CI=Object.prototype.hasOwnProperty,TI=EI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,II={key:!0,ref:!0,__self:!0,__source:!0};function xE(n,e,t){var i,s={},r=null,o=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)CI.call(e,i)&&!II.hasOwnProperty(i)&&(s[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)s[i]===void 0&&(s[i]=e[i]);return{$$typeof:SI,type:n,key:r,ref:o,props:s,_owner:TI.current}}Tp.Fragment=wI;Tp.jsx=xE;Tp.jsxs=xE;yE.exports=Tp;var D=yE.exports,bg={},PE={exports:{}},Mn={},RE={exports:{}},ME={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(U,K){var Q=U.length;U.push(K);e:for(;0<Q;){var ce=Q-1>>>1,le=U[ce];if(0<s(le,K))U[ce]=K,U[Q]=le,Q=ce;else break e}}function t(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var K=U[0],Q=U.pop();if(Q!==K){U[0]=Q;e:for(var ce=0,le=U.length,Re=le>>>1;ce<Re;){var Xt=2*(ce+1)-1,Yi=U[Xt],Ge=Xt+1,me=U[Ge];if(0>s(Yi,Q))Ge<le&&0>s(me,Yi)?(U[ce]=me,U[Ge]=Q,ce=Ge):(U[ce]=Yi,U[Xt]=Q,ce=Xt);else if(Ge<le&&0>s(me,Q))U[ce]=me,U[Ge]=Q,ce=Ge;else break e}}return K}function s(U,K){var Q=U.sortIndex-K.sortIndex;return Q!==0?Q:U.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,p=null,g=3,m=!1,y=!1,A=!1,T=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(U){for(var K=t(u);K!==null;){if(K.callback===null)i(u);else if(K.startTime<=U)i(u),K.sortIndex=K.expirationTime,e(l,K);else break;K=t(u)}}function I(U){if(A=!1,C(U),!y)if(t(l)!==null)y=!0,F(x);else{var K=t(u);K!==null&&$(I,K.startTime-U)}}function x(U,K){y=!1,A&&(A=!1,_(M),M=-1),m=!0;var Q=g;try{for(C(K),p=t(l);p!==null&&(!(p.expirationTime>K)||U&&!L());){var ce=p.callback;if(typeof ce=="function"){p.callback=null,g=p.priorityLevel;var le=ce(p.expirationTime<=K);K=n.unstable_now(),typeof le=="function"?p.callback=le:p===t(l)&&i(l),C(K)}else i(l);p=t(l)}if(p!==null)var Re=!0;else{var Xt=t(u);Xt!==null&&$(I,Xt.startTime-K),Re=!1}return Re}finally{p=null,g=Q,m=!1}}var R=!1,P=null,M=-1,k=5,N=-1;function L(){return!(n.unstable_now()-N<k)}function Y(){if(P!==null){var U=n.unstable_now();N=U;var K=!0;try{K=P(!0,U)}finally{K?ie():(R=!1,P=null)}}else R=!1}var ie;if(typeof E=="function")ie=function(){E(Y)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,De=se.port2;se.port1.onmessage=Y,ie=function(){De.postMessage(null)}}else ie=function(){T(Y,0)};function F(U){P=U,R||(R=!0,ie())}function $(U,K){M=T(function(){U(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(U){U.callback=null},n.unstable_continueExecution=function(){y||m||(y=!0,F(x))},n.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<U?Math.floor(1e3/U):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(U){switch(g){case 1:case 2:case 3:var K=3;break;default:K=g}var Q=g;g=K;try{return U()}finally{g=Q}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(U,K){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var Q=g;g=U;try{return K()}finally{g=Q}},n.unstable_scheduleCallback=function(U,K,Q){var ce=n.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ce+Q:ce):Q=ce,U){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=Q+le,U={id:h++,callback:K,priorityLevel:U,startTime:Q,expirationTime:le,sortIndex:-1},Q>ce?(U.sortIndex=Q,e(u,U),t(l)===null&&U===t(u)&&(A?(_(M),M=-1):A=!0,$(I,Q-ce))):(U.sortIndex=le,e(l,U),y||m||(y=!0,F(x))),U},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(U){var K=g;return function(){var Q=g;g=K;try{return U.apply(this,arguments)}finally{g=Q}}}})(ME);RE.exports=ME;var xI=RE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PI=nt,Rn=xI;function b(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kE=new Set,fc={};function _a(n,e){uu(n,e),uu(n+"Capture",e)}function uu(n,e){for(fc[n]=e,n=0;n<e.length;n++)kE.add(e[n])}var Ns=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dg=Object.prototype.hasOwnProperty,RI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v0={},_0={};function MI(n){return Dg.call(_0,n)?!0:Dg.call(v0,n)?!1:RI.test(n)?_0[n]=!0:(v0[n]=!0,!1)}function kI(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function NI(n,e,t,i){if(e===null||typeof e>"u"||kI(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Jt(n,e,t,i,s,r,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=o}var St={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){St[n]=new Jt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];St[e]=new Jt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){St[n]=new Jt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){St[n]=new Jt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){St[n]=new Jt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){St[n]=new Jt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){St[n]=new Jt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){St[n]=new Jt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){St[n]=new Jt(n,5,!1,n.toLowerCase(),null,!1,!1)});var jy=/[\-:]([a-z])/g;function ev(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(jy,ev);St[e]=new Jt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(jy,ev);St[e]=new Jt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(jy,ev);St[e]=new Jt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){St[n]=new Jt(n,1,!1,n.toLowerCase(),null,!1,!1)});St.xlinkHref=new Jt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){St[n]=new Jt(n,1,!1,n.toLowerCase(),null,!0,!0)});function tv(n,e,t,i){var s=St.hasOwnProperty(e)?St[e]:null;(s!==null?s.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(NI(e,t,s,i)&&(t=null),i||s===null?MI(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,i=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var Vs=PI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fh=Symbol.for("react.element"),Na=Symbol.for("react.portal"),ba=Symbol.for("react.fragment"),nv=Symbol.for("react.strict_mode"),Lg=Symbol.for("react.profiler"),NE=Symbol.for("react.provider"),bE=Symbol.for("react.context"),iv=Symbol.for("react.forward_ref"),Fg=Symbol.for("react.suspense"),Ug=Symbol.for("react.suspense_list"),sv=Symbol.for("react.memo"),qs=Symbol.for("react.lazy"),DE=Symbol.for("react.offscreen"),A0=Symbol.iterator;function Su(n){return n===null||typeof n!="object"?null:(n=A0&&n[A0]||n["@@iterator"],typeof n=="function"?n:null)}var Oe=Object.assign,tg;function Lu(n){if(tg===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);tg=e&&e[1]||""}return`
`+tg+n}var ng=!1;function ig(n,e){if(!n||ng)return"";ng=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){i=u}n.call(e.prototype)}else{try{throw Error()}catch(u){i=u}n()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),r=i.stack.split(`
`),o=s.length-1,a=r.length-1;1<=o&&0<=a&&s[o]!==r[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==r[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==r[a]){var l=`
`+s[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{ng=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Lu(n):""}function bI(n){switch(n.tag){case 5:return Lu(n.type);case 16:return Lu("Lazy");case 13:return Lu("Suspense");case 19:return Lu("SuspenseList");case 0:case 2:case 15:return n=ig(n.type,!1),n;case 11:return n=ig(n.type.render,!1),n;case 1:return n=ig(n.type,!0),n;default:return""}}function Hg(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case ba:return"Fragment";case Na:return"Portal";case Lg:return"Profiler";case nv:return"StrictMode";case Fg:return"Suspense";case Ug:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case bE:return(n.displayName||"Context")+".Consumer";case NE:return(n._context.displayName||"Context")+".Provider";case iv:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case sv:return e=n.displayName||null,e!==null?e:Hg(n.type)||"Memo";case qs:e=n._payload,n=n._init;try{return Hg(n(e))}catch{}}return null}function DI(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hg(e);case 8:return e===nv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ur(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function LE(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function LI(n){var e=LE(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){i=""+o,r.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function ph(n){n._valueTracker||(n._valueTracker=LI(n))}function FE(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=LE(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function Cf(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Vg(n,e){var t=e.checked;return Oe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function E0(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Ur(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function UE(n,e){e=e.checked,e!=null&&tv(n,"checked",e,!1)}function Og(n,e){UE(n,e);var t=Ur(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Gg(n,e.type,t):e.hasOwnProperty("defaultValue")&&Gg(n,e.type,Ur(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function S0(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Gg(n,e,t){(e!=="number"||Cf(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Fu=Array.isArray;function Ya(n,e,t,i){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Ur(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,i&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function Bg(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(b(91));return Oe({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function w0(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(b(92));if(Fu(t)){if(1<t.length)throw Error(b(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Ur(t)}}function HE(n,e){var t=Ur(e.value),i=Ur(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function C0(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function VE(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zg(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?VE(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var gh,OE=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(gh=gh||document.createElement("div"),gh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=gh.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function pc(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var tc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FI=["Webkit","ms","Moz","O"];Object.keys(tc).forEach(function(n){FI.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),tc[e]=tc[n]})});function GE(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||tc.hasOwnProperty(n)&&tc[n]?(""+e).trim():e+"px"}function BE(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,s=GE(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,s):n[t]=s}}var UI=Oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qg(n,e){if(e){if(UI[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(b(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(b(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(b(61))}if(e.style!=null&&typeof e.style!="object")throw Error(b(62))}}function $g(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wg=null;function rv(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Yg=null,Ka=null,Ja=null;function T0(n){if(n=ah(n)){if(typeof Yg!="function")throw Error(b(280));var e=n.stateNode;e&&(e=Mp(e),Yg(n.stateNode,n.type,e))}}function zE(n){Ka?Ja?Ja.push(n):Ja=[n]:Ka=n}function qE(){if(Ka){var n=Ka,e=Ja;if(Ja=Ka=null,T0(n),e)for(n=0;n<e.length;n++)T0(e[n])}}function $E(n,e){return n(e)}function WE(){}var sg=!1;function YE(n,e,t){if(sg)return n(e,t);sg=!0;try{return $E(n,e,t)}finally{sg=!1,(Ka!==null||Ja!==null)&&(WE(),qE())}}function gc(n,e){var t=n.stateNode;if(t===null)return null;var i=Mp(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(b(231,e,typeof t));return t}var Kg=!1;if(Ns)try{var wu={};Object.defineProperty(wu,"passive",{get:function(){Kg=!0}}),window.addEventListener("test",wu,wu),window.removeEventListener("test",wu,wu)}catch{Kg=!1}function HI(n,e,t,i,s,r,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var nc=!1,Tf=null,If=!1,Jg=null,VI={onError:function(n){nc=!0,Tf=n}};function OI(n,e,t,i,s,r,o,a,l){nc=!1,Tf=null,HI.apply(VI,arguments)}function GI(n,e,t,i,s,r,o,a,l){if(OI.apply(this,arguments),nc){if(nc){var u=Tf;nc=!1,Tf=null}else throw Error(b(198));If||(If=!0,Jg=u)}}function Aa(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function KE(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function I0(n){if(Aa(n)!==n)throw Error(b(188))}function BI(n){var e=n.alternate;if(!e){if(e=Aa(n),e===null)throw Error(b(188));return e!==n?null:n}for(var t=n,i=e;;){var s=t.return;if(s===null)break;var r=s.alternate;if(r===null){if(i=s.return,i!==null){t=i;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===t)return I0(s),n;if(r===i)return I0(s),e;r=r.sibling}throw Error(b(188))}if(t.return!==i.return)t=s,i=r;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o){for(a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o)throw Error(b(189))}}if(t.alternate!==i)throw Error(b(190))}if(t.tag!==3)throw Error(b(188));return t.stateNode.current===t?n:e}function JE(n){return n=BI(n),n!==null?XE(n):null}function XE(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=XE(n);if(e!==null)return e;n=n.sibling}return null}var QE=Rn.unstable_scheduleCallback,x0=Rn.unstable_cancelCallback,zI=Rn.unstable_shouldYield,qI=Rn.unstable_requestPaint,We=Rn.unstable_now,$I=Rn.unstable_getCurrentPriorityLevel,ov=Rn.unstable_ImmediatePriority,ZE=Rn.unstable_UserBlockingPriority,xf=Rn.unstable_NormalPriority,WI=Rn.unstable_LowPriority,jE=Rn.unstable_IdlePriority,Ip=null,qi=null;function YI(n){if(qi&&typeof qi.onCommitFiberRoot=="function")try{qi.onCommitFiberRoot(Ip,n,void 0,(n.current.flags&128)===128)}catch{}}var gi=Math.clz32?Math.clz32:XI,KI=Math.log,JI=Math.LN2;function XI(n){return n>>>=0,n===0?32:31-(KI(n)/JI|0)|0}var mh=64,yh=4194304;function Uu(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Pf(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,s=n.suspendedLanes,r=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?i=Uu(a):(r&=o,r!==0&&(i=Uu(r)))}else o=t&~s,o!==0?i=Uu(o):r!==0&&(i=Uu(r));if(i===0)return 0;if(e!==0&&e!==i&&!(e&s)&&(s=i&-i,r=e&-e,s>=r||s===16&&(r&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-gi(e),s=1<<t,i|=n[t],e&=~s;return i}function QI(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZI(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,s=n.expirationTimes,r=n.pendingLanes;0<r;){var o=31-gi(r),a=1<<o,l=s[o];l===-1?(!(a&t)||a&i)&&(s[o]=QI(a,e)):l<=e&&(n.expiredLanes|=a),r&=~a}}function Xg(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function eS(){var n=mh;return mh<<=1,!(mh&4194240)&&(mh=64),n}function rg(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function rh(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-gi(e),n[e]=t}function jI(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-gi(t),r=1<<s;e[s]=0,i[s]=-1,n[s]=-1,t&=~r}}function av(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-gi(t),s=1<<i;s&e|n[i]&e&&(n[i]|=e),t&=~s}}var _e=0;function tS(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var nS,lv,iS,sS,rS,Qg=!1,vh=[],Pr=null,Rr=null,Mr=null,mc=new Map,yc=new Map,Ws=[],ex="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function P0(n,e){switch(n){case"focusin":case"focusout":Pr=null;break;case"dragenter":case"dragleave":Rr=null;break;case"mouseover":case"mouseout":Mr=null;break;case"pointerover":case"pointerout":mc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":yc.delete(e.pointerId)}}function Cu(n,e,t,i,s,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:r,targetContainers:[s]},e!==null&&(e=ah(e),e!==null&&lv(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function tx(n,e,t,i,s){switch(e){case"focusin":return Pr=Cu(Pr,n,e,t,i,s),!0;case"dragenter":return Rr=Cu(Rr,n,e,t,i,s),!0;case"mouseover":return Mr=Cu(Mr,n,e,t,i,s),!0;case"pointerover":var r=s.pointerId;return mc.set(r,Cu(mc.get(r)||null,n,e,t,i,s)),!0;case"gotpointercapture":return r=s.pointerId,yc.set(r,Cu(yc.get(r)||null,n,e,t,i,s)),!0}return!1}function oS(n){var e=eo(n.target);if(e!==null){var t=Aa(e);if(t!==null){if(e=t.tag,e===13){if(e=KE(t),e!==null){n.blockedOn=e,rS(n.priority,function(){iS(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Lh(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Zg(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);Wg=i,t.target.dispatchEvent(i),Wg=null}else return e=ah(t),e!==null&&lv(e),n.blockedOn=t,!1;e.shift()}return!0}function R0(n,e,t){Lh(n)&&t.delete(e)}function nx(){Qg=!1,Pr!==null&&Lh(Pr)&&(Pr=null),Rr!==null&&Lh(Rr)&&(Rr=null),Mr!==null&&Lh(Mr)&&(Mr=null),mc.forEach(R0),yc.forEach(R0)}function Tu(n,e){n.blockedOn===e&&(n.blockedOn=null,Qg||(Qg=!0,Rn.unstable_scheduleCallback(Rn.unstable_NormalPriority,nx)))}function vc(n){function e(s){return Tu(s,n)}if(0<vh.length){Tu(vh[0],n);for(var t=1;t<vh.length;t++){var i=vh[t];i.blockedOn===n&&(i.blockedOn=null)}}for(Pr!==null&&Tu(Pr,n),Rr!==null&&Tu(Rr,n),Mr!==null&&Tu(Mr,n),mc.forEach(e),yc.forEach(e),t=0;t<Ws.length;t++)i=Ws[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<Ws.length&&(t=Ws[0],t.blockedOn===null);)oS(t),t.blockedOn===null&&Ws.shift()}var Xa=Vs.ReactCurrentBatchConfig,Rf=!0;function ix(n,e,t,i){var s=_e,r=Xa.transition;Xa.transition=null;try{_e=1,uv(n,e,t,i)}finally{_e=s,Xa.transition=r}}function sx(n,e,t,i){var s=_e,r=Xa.transition;Xa.transition=null;try{_e=4,uv(n,e,t,i)}finally{_e=s,Xa.transition=r}}function uv(n,e,t,i){if(Rf){var s=Zg(n,e,t,i);if(s===null)gg(n,e,i,Mf,t),P0(n,i);else if(tx(s,n,e,t,i))i.stopPropagation();else if(P0(n,i),e&4&&-1<ex.indexOf(n)){for(;s!==null;){var r=ah(s);if(r!==null&&nS(r),r=Zg(n,e,t,i),r===null&&gg(n,e,i,Mf,t),r===s)break;s=r}s!==null&&i.stopPropagation()}else gg(n,e,i,null,t)}}var Mf=null;function Zg(n,e,t,i){if(Mf=null,n=rv(i),n=eo(n),n!==null)if(e=Aa(n),e===null)n=null;else if(t=e.tag,t===13){if(n=KE(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Mf=n,null}function aS(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($I()){case ov:return 1;case ZE:return 4;case xf:case WI:return 16;case jE:return 536870912;default:return 16}default:return 16}}var Tr=null,cv=null,Fh=null;function lS(){if(Fh)return Fh;var n,e=cv,t=e.length,i,s="value"in Tr?Tr.value:Tr.textContent,r=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===s[r-i];i++);return Fh=s.slice(n,1<i?1-i:void 0)}function Uh(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function _h(){return!0}function M0(){return!1}function kn(n){function e(t,i,s,r,o){this._reactName=t,this._targetInst=s,this.type=i,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?_h:M0,this.isPropagationStopped=M0,this}return Oe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=_h)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=_h)},persist:function(){},isPersistent:_h}),e}var yu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dv=kn(yu),oh=Oe({},yu,{view:0,detail:0}),rx=kn(oh),og,ag,Iu,xp=Oe({},oh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hv,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Iu&&(Iu&&n.type==="mousemove"?(og=n.screenX-Iu.screenX,ag=n.screenY-Iu.screenY):ag=og=0,Iu=n),og)},movementY:function(n){return"movementY"in n?n.movementY:ag}}),k0=kn(xp),ox=Oe({},xp,{dataTransfer:0}),ax=kn(ox),lx=Oe({},oh,{relatedTarget:0}),lg=kn(lx),ux=Oe({},yu,{animationName:0,elapsedTime:0,pseudoElement:0}),cx=kn(ux),dx=Oe({},yu,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),hx=kn(dx),fx=Oe({},yu,{data:0}),N0=kn(fx),px={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yx(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=mx[n])?!!e[n]:!1}function hv(){return yx}var vx=Oe({},oh,{key:function(n){if(n.key){var e=px[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Uh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?gx[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hv,charCode:function(n){return n.type==="keypress"?Uh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Uh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),_x=kn(vx),Ax=Oe({},xp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),b0=kn(Ax),Ex=Oe({},oh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hv}),Sx=kn(Ex),wx=Oe({},yu,{propertyName:0,elapsedTime:0,pseudoElement:0}),Cx=kn(wx),Tx=Oe({},xp,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Ix=kn(Tx),xx=[9,13,27,32],fv=Ns&&"CompositionEvent"in window,ic=null;Ns&&"documentMode"in document&&(ic=document.documentMode);var Px=Ns&&"TextEvent"in window&&!ic,uS=Ns&&(!fv||ic&&8<ic&&11>=ic),D0=" ",L0=!1;function cS(n,e){switch(n){case"keyup":return xx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dS(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Da=!1;function Rx(n,e){switch(n){case"compositionend":return dS(e);case"keypress":return e.which!==32?null:(L0=!0,D0);case"textInput":return n=e.data,n===D0&&L0?null:n;default:return null}}function Mx(n,e){if(Da)return n==="compositionend"||!fv&&cS(n,e)?(n=lS(),Fh=cv=Tr=null,Da=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return uS&&e.locale!=="ko"?null:e.data;default:return null}}var kx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function F0(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!kx[n.type]:e==="textarea"}function hS(n,e,t,i){zE(i),e=kf(e,"onChange"),0<e.length&&(t=new dv("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var sc=null,_c=null;function Nx(n){wS(n,0)}function Pp(n){var e=Ua(n);if(FE(e))return n}function bx(n,e){if(n==="change")return e}var fS=!1;if(Ns){var ug;if(Ns){var cg="oninput"in document;if(!cg){var U0=document.createElement("div");U0.setAttribute("oninput","return;"),cg=typeof U0.oninput=="function"}ug=cg}else ug=!1;fS=ug&&(!document.documentMode||9<document.documentMode)}function H0(){sc&&(sc.detachEvent("onpropertychange",pS),_c=sc=null)}function pS(n){if(n.propertyName==="value"&&Pp(_c)){var e=[];hS(e,_c,n,rv(n)),YE(Nx,e)}}function Dx(n,e,t){n==="focusin"?(H0(),sc=e,_c=t,sc.attachEvent("onpropertychange",pS)):n==="focusout"&&H0()}function Lx(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Pp(_c)}function Fx(n,e){if(n==="click")return Pp(e)}function Ux(n,e){if(n==="input"||n==="change")return Pp(e)}function Hx(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var yi=typeof Object.is=="function"?Object.is:Hx;function Ac(n,e){if(yi(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var s=t[i];if(!Dg.call(e,s)||!yi(n[s],e[s]))return!1}return!0}function V0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function O0(n,e){var t=V0(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=V0(t)}}function gS(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?gS(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function mS(){for(var n=window,e=Cf();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Cf(n.document)}return e}function pv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Vx(n){var e=mS(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&gS(t.ownerDocument.documentElement,t)){if(i!==null&&pv(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,r=Math.min(i.start,s);i=i.end===void 0?r:Math.min(i.end,s),!n.extend&&r>i&&(s=i,i=r,r=s),s=O0(t,r);var o=O0(t,i);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),r>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Ox=Ns&&"documentMode"in document&&11>=document.documentMode,La=null,jg=null,rc=null,em=!1;function G0(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;em||La==null||La!==Cf(i)||(i=La,"selectionStart"in i&&pv(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),rc&&Ac(rc,i)||(rc=i,i=kf(jg,"onSelect"),0<i.length&&(e=new dv("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=La)))}function Ah(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Fa={animationend:Ah("Animation","AnimationEnd"),animationiteration:Ah("Animation","AnimationIteration"),animationstart:Ah("Animation","AnimationStart"),transitionend:Ah("Transition","TransitionEnd")},dg={},yS={};Ns&&(yS=document.createElement("div").style,"AnimationEvent"in window||(delete Fa.animationend.animation,delete Fa.animationiteration.animation,delete Fa.animationstart.animation),"TransitionEvent"in window||delete Fa.transitionend.transition);function Rp(n){if(dg[n])return dg[n];if(!Fa[n])return n;var e=Fa[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in yS)return dg[n]=e[t];return n}var vS=Rp("animationend"),_S=Rp("animationiteration"),AS=Rp("animationstart"),ES=Rp("transitionend"),SS=new Map,B0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Br(n,e){SS.set(n,e),_a(e,[n])}for(var hg=0;hg<B0.length;hg++){var fg=B0[hg],Gx=fg.toLowerCase(),Bx=fg[0].toUpperCase()+fg.slice(1);Br(Gx,"on"+Bx)}Br(vS,"onAnimationEnd");Br(_S,"onAnimationIteration");Br(AS,"onAnimationStart");Br("dblclick","onDoubleClick");Br("focusin","onFocus");Br("focusout","onBlur");Br(ES,"onTransitionEnd");uu("onMouseEnter",["mouseout","mouseover"]);uu("onMouseLeave",["mouseout","mouseover"]);uu("onPointerEnter",["pointerout","pointerover"]);uu("onPointerLeave",["pointerout","pointerover"]);_a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_a("onBeforeInput",["compositionend","keypress","textInput","paste"]);_a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hu));function z0(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,GI(i,e,void 0,n),n.currentTarget=null}function wS(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],s=i.event;i=i.listeners;e:{var r=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==r&&s.isPropagationStopped())break e;z0(s,a,u),r=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==r&&s.isPropagationStopped())break e;z0(s,a,u),r=l}}}if(If)throw n=Jg,If=!1,Jg=null,n}function Te(n,e){var t=e[rm];t===void 0&&(t=e[rm]=new Set);var i=n+"__bubble";t.has(i)||(CS(e,n,2,!1),t.add(i))}function pg(n,e,t){var i=0;e&&(i|=4),CS(t,n,i,e)}var Eh="_reactListening"+Math.random().toString(36).slice(2);function Ec(n){if(!n[Eh]){n[Eh]=!0,kE.forEach(function(t){t!=="selectionchange"&&(zx.has(t)||pg(t,!1,n),pg(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Eh]||(e[Eh]=!0,pg("selectionchange",!1,e))}}function CS(n,e,t,i){switch(aS(e)){case 1:var s=ix;break;case 4:s=sx;break;default:s=uv}t=s.bind(null,e,t,n),s=void 0,!Kg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),i?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function gg(n,e,t,i,s){var r=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=eo(a),o===null)return;if(l=o.tag,l===5||l===6){i=r=o;continue e}a=a.parentNode}}i=i.return}YE(function(){var u=r,h=rv(t),p=[];e:{var g=SS.get(n);if(g!==void 0){var m=dv,y=n;switch(n){case"keypress":if(Uh(t)===0)break e;case"keydown":case"keyup":m=_x;break;case"focusin":y="focus",m=lg;break;case"focusout":y="blur",m=lg;break;case"beforeblur":case"afterblur":m=lg;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=k0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=ax;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Sx;break;case vS:case _S:case AS:m=cx;break;case ES:m=Cx;break;case"scroll":m=rx;break;case"wheel":m=Ix;break;case"copy":case"cut":case"paste":m=hx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=b0}var A=(e&4)!==0,T=!A&&n==="scroll",_=A?g!==null?g+"Capture":null:g;A=[];for(var E=u,C;E!==null;){C=E;var I=C.stateNode;if(C.tag===5&&I!==null&&(C=I,_!==null&&(I=gc(E,_),I!=null&&A.push(Sc(E,I,C)))),T)break;E=E.return}0<A.length&&(g=new m(g,y,null,t,h),p.push({event:g,listeners:A}))}}if(!(e&7)){e:{if(g=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",g&&t!==Wg&&(y=t.relatedTarget||t.fromElement)&&(eo(y)||y[bs]))break e;if((m||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,m?(y=t.relatedTarget||t.toElement,m=u,y=y?eo(y):null,y!==null&&(T=Aa(y),y!==T||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(A=k0,I="onMouseLeave",_="onMouseEnter",E="mouse",(n==="pointerout"||n==="pointerover")&&(A=b0,I="onPointerLeave",_="onPointerEnter",E="pointer"),T=m==null?g:Ua(m),C=y==null?g:Ua(y),g=new A(I,E+"leave",m,t,h),g.target=T,g.relatedTarget=C,I=null,eo(h)===u&&(A=new A(_,E+"enter",y,t,h),A.target=C,A.relatedTarget=T,I=A),T=I,m&&y)t:{for(A=m,_=y,E=0,C=A;C;C=Ca(C))E++;for(C=0,I=_;I;I=Ca(I))C++;for(;0<E-C;)A=Ca(A),E--;for(;0<C-E;)_=Ca(_),C--;for(;E--;){if(A===_||_!==null&&A===_.alternate)break t;A=Ca(A),_=Ca(_)}A=null}else A=null;m!==null&&q0(p,g,m,A,!1),y!==null&&T!==null&&q0(p,T,y,A,!0)}}e:{if(g=u?Ua(u):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var x=bx;else if(F0(g))if(fS)x=Ux;else{x=Lx;var R=Dx}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(x=Fx);if(x&&(x=x(n,u))){hS(p,x,t,h);break e}R&&R(n,g,u),n==="focusout"&&(R=g._wrapperState)&&R.controlled&&g.type==="number"&&Gg(g,"number",g.value)}switch(R=u?Ua(u):window,n){case"focusin":(F0(R)||R.contentEditable==="true")&&(La=R,jg=u,rc=null);break;case"focusout":rc=jg=La=null;break;case"mousedown":em=!0;break;case"contextmenu":case"mouseup":case"dragend":em=!1,G0(p,t,h);break;case"selectionchange":if(Ox)break;case"keydown":case"keyup":G0(p,t,h)}var P;if(fv)e:{switch(n){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Da?cS(n,t)&&(M="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(M="onCompositionStart");M&&(uS&&t.locale!=="ko"&&(Da||M!=="onCompositionStart"?M==="onCompositionEnd"&&Da&&(P=lS()):(Tr=h,cv="value"in Tr?Tr.value:Tr.textContent,Da=!0)),R=kf(u,M),0<R.length&&(M=new N0(M,n,null,t,h),p.push({event:M,listeners:R}),P?M.data=P:(P=dS(t),P!==null&&(M.data=P)))),(P=Px?Rx(n,t):Mx(n,t))&&(u=kf(u,"onBeforeInput"),0<u.length&&(h=new N0("onBeforeInput","beforeinput",null,t,h),p.push({event:h,listeners:u}),h.data=P))}wS(p,e)})}function Sc(n,e,t){return{instance:n,listener:e,currentTarget:t}}function kf(n,e){for(var t=e+"Capture",i=[];n!==null;){var s=n,r=s.stateNode;s.tag===5&&r!==null&&(s=r,r=gc(n,t),r!=null&&i.unshift(Sc(n,r,s)),r=gc(n,e),r!=null&&i.push(Sc(n,r,s))),n=n.return}return i}function Ca(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function q0(n,e,t,i,s){for(var r=e._reactName,o=[];t!==null&&t!==i;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,s?(l=gc(t,r),l!=null&&o.unshift(Sc(t,l,a))):s||(l=gc(t,r),l!=null&&o.push(Sc(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var qx=/\r\n?/g,$x=/\u0000|\uFFFD/g;function $0(n){return(typeof n=="string"?n:""+n).replace(qx,`
`).replace($x,"")}function Sh(n,e,t){if(e=$0(e),$0(n)!==e&&t)throw Error(b(425))}function Nf(){}var tm=null,nm=null;function im(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var sm=typeof setTimeout=="function"?setTimeout:void 0,Wx=typeof clearTimeout=="function"?clearTimeout:void 0,W0=typeof Promise=="function"?Promise:void 0,Yx=typeof queueMicrotask=="function"?queueMicrotask:typeof W0<"u"?function(n){return W0.resolve(null).then(n).catch(Kx)}:sm;function Kx(n){setTimeout(function(){throw n})}function mg(n,e){var t=e,i=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(i===0){n.removeChild(s),vc(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=s}while(t);vc(e)}function kr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function Y0(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var vu=Math.random().toString(36).slice(2),zi="__reactFiber$"+vu,wc="__reactProps$"+vu,bs="__reactContainer$"+vu,rm="__reactEvents$"+vu,Jx="__reactListeners$"+vu,Xx="__reactHandles$"+vu;function eo(n){var e=n[zi];if(e)return e;for(var t=n.parentNode;t;){if(e=t[bs]||t[zi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=Y0(n);n!==null;){if(t=n[zi])return t;n=Y0(n)}return e}n=t,t=n.parentNode}return null}function ah(n){return n=n[zi]||n[bs],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Ua(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(b(33))}function Mp(n){return n[wc]||null}var om=[],Ha=-1;function zr(n){return{current:n}}function Pe(n){0>Ha||(n.current=om[Ha],om[Ha]=null,Ha--)}function Ce(n,e){Ha++,om[Ha]=n.current,n.current=e}var Hr={},Ft=zr(Hr),an=zr(!1),ca=Hr;function cu(n,e){var t=n.type.contextTypes;if(!t)return Hr;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var s={},r;for(r in t)s[r]=e[r];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function ln(n){return n=n.childContextTypes,n!=null}function bf(){Pe(an),Pe(Ft)}function K0(n,e,t){if(Ft.current!==Hr)throw Error(b(168));Ce(Ft,e),Ce(an,t)}function TS(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var s in i)if(!(s in e))throw Error(b(108,DI(n)||"Unknown",s));return Oe({},t,i)}function Df(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Hr,ca=Ft.current,Ce(Ft,n),Ce(an,an.current),!0}function J0(n,e,t){var i=n.stateNode;if(!i)throw Error(b(169));t?(n=TS(n,e,ca),i.__reactInternalMemoizedMergedChildContext=n,Pe(an),Pe(Ft),Ce(Ft,n)):Pe(an),Ce(an,t)}var es=null,kp=!1,yg=!1;function IS(n){es===null?es=[n]:es.push(n)}function Qx(n){kp=!0,IS(n)}function qr(){if(!yg&&es!==null){yg=!0;var n=0,e=_e;try{var t=es;for(_e=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}es=null,kp=!1}catch(s){throw es!==null&&(es=es.slice(n+1)),QE(ov,qr),s}finally{_e=e,yg=!1}}return null}var Va=[],Oa=0,Lf=null,Ff=0,On=[],Gn=0,da=null,xs=1,Ps="";function Yr(n,e){Va[Oa++]=Ff,Va[Oa++]=Lf,Lf=n,Ff=e}function xS(n,e,t){On[Gn++]=xs,On[Gn++]=Ps,On[Gn++]=da,da=n;var i=xs;n=Ps;var s=32-gi(i)-1;i&=~(1<<s),t+=1;var r=32-gi(e)+s;if(30<r){var o=s-s%5;r=(i&(1<<o)-1).toString(32),i>>=o,s-=o,xs=1<<32-gi(e)+s|t<<s|i,Ps=r+n}else xs=1<<r|t<<s|i,Ps=n}function gv(n){n.return!==null&&(Yr(n,1),xS(n,1,0))}function mv(n){for(;n===Lf;)Lf=Va[--Oa],Va[Oa]=null,Ff=Va[--Oa],Va[Oa]=null;for(;n===da;)da=On[--Gn],On[Gn]=null,Ps=On[--Gn],On[Gn]=null,xs=On[--Gn],On[Gn]=null}var xn=null,In=null,be=!1,fi=null;function PS(n,e){var t=qn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function X0(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,xn=n,In=kr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,xn=n,In=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=da!==null?{id:xs,overflow:Ps}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=qn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,xn=n,In=null,!0):!1;default:return!1}}function am(n){return(n.mode&1)!==0&&(n.flags&128)===0}function lm(n){if(be){var e=In;if(e){var t=e;if(!X0(n,e)){if(am(n))throw Error(b(418));e=kr(t.nextSibling);var i=xn;e&&X0(n,e)?PS(i,t):(n.flags=n.flags&-4097|2,be=!1,xn=n)}}else{if(am(n))throw Error(b(418));n.flags=n.flags&-4097|2,be=!1,xn=n}}}function Q0(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;xn=n}function wh(n){if(n!==xn)return!1;if(!be)return Q0(n),be=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!im(n.type,n.memoizedProps)),e&&(e=In)){if(am(n))throw RS(),Error(b(418));for(;e;)PS(n,e),e=kr(e.nextSibling)}if(Q0(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(b(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){In=kr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}In=null}}else In=xn?kr(n.stateNode.nextSibling):null;return!0}function RS(){for(var n=In;n;)n=kr(n.nextSibling)}function du(){In=xn=null,be=!1}function yv(n){fi===null?fi=[n]:fi.push(n)}var Zx=Vs.ReactCurrentBatchConfig;function xu(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(b(309));var i=t.stateNode}if(!i)throw Error(b(147,n));var s=i,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(o){var a=s.refs;o===null?delete a[r]:a[r]=o},e._stringRef=r,e)}if(typeof n!="string")throw Error(b(284));if(!t._owner)throw Error(b(290,n))}return n}function Ch(n,e){throw n=Object.prototype.toString.call(e),Error(b(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Z0(n){var e=n._init;return e(n._payload)}function MS(n){function e(_,E){if(n){var C=_.deletions;C===null?(_.deletions=[E],_.flags|=16):C.push(E)}}function t(_,E){if(!n)return null;for(;E!==null;)e(_,E),E=E.sibling;return null}function i(_,E){for(_=new Map;E!==null;)E.key!==null?_.set(E.key,E):_.set(E.index,E),E=E.sibling;return _}function s(_,E){return _=Lr(_,E),_.index=0,_.sibling=null,_}function r(_,E,C){return _.index=C,n?(C=_.alternate,C!==null?(C=C.index,C<E?(_.flags|=2,E):C):(_.flags|=2,E)):(_.flags|=1048576,E)}function o(_){return n&&_.alternate===null&&(_.flags|=2),_}function a(_,E,C,I){return E===null||E.tag!==6?(E=Cg(C,_.mode,I),E.return=_,E):(E=s(E,C),E.return=_,E)}function l(_,E,C,I){var x=C.type;return x===ba?h(_,E,C.props.children,I,C.key):E!==null&&(E.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===qs&&Z0(x)===E.type)?(I=s(E,C.props),I.ref=xu(_,E,C),I.return=_,I):(I=qh(C.type,C.key,C.props,null,_.mode,I),I.ref=xu(_,E,C),I.return=_,I)}function u(_,E,C,I){return E===null||E.tag!==4||E.stateNode.containerInfo!==C.containerInfo||E.stateNode.implementation!==C.implementation?(E=Tg(C,_.mode,I),E.return=_,E):(E=s(E,C.children||[]),E.return=_,E)}function h(_,E,C,I,x){return E===null||E.tag!==7?(E=ua(C,_.mode,I,x),E.return=_,E):(E=s(E,C),E.return=_,E)}function p(_,E,C){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Cg(""+E,_.mode,C),E.return=_,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case fh:return C=qh(E.type,E.key,E.props,null,_.mode,C),C.ref=xu(_,null,E),C.return=_,C;case Na:return E=Tg(E,_.mode,C),E.return=_,E;case qs:var I=E._init;return p(_,I(E._payload),C)}if(Fu(E)||Su(E))return E=ua(E,_.mode,C,null),E.return=_,E;Ch(_,E)}return null}function g(_,E,C,I){var x=E!==null?E.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return x!==null?null:a(_,E,""+C,I);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case fh:return C.key===x?l(_,E,C,I):null;case Na:return C.key===x?u(_,E,C,I):null;case qs:return x=C._init,g(_,E,x(C._payload),I)}if(Fu(C)||Su(C))return x!==null?null:h(_,E,C,I,null);Ch(_,C)}return null}function m(_,E,C,I,x){if(typeof I=="string"&&I!==""||typeof I=="number")return _=_.get(C)||null,a(E,_,""+I,x);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case fh:return _=_.get(I.key===null?C:I.key)||null,l(E,_,I,x);case Na:return _=_.get(I.key===null?C:I.key)||null,u(E,_,I,x);case qs:var R=I._init;return m(_,E,C,R(I._payload),x)}if(Fu(I)||Su(I))return _=_.get(C)||null,h(E,_,I,x,null);Ch(E,I)}return null}function y(_,E,C,I){for(var x=null,R=null,P=E,M=E=0,k=null;P!==null&&M<C.length;M++){P.index>M?(k=P,P=null):k=P.sibling;var N=g(_,P,C[M],I);if(N===null){P===null&&(P=k);break}n&&P&&N.alternate===null&&e(_,P),E=r(N,E,M),R===null?x=N:R.sibling=N,R=N,P=k}if(M===C.length)return t(_,P),be&&Yr(_,M),x;if(P===null){for(;M<C.length;M++)P=p(_,C[M],I),P!==null&&(E=r(P,E,M),R===null?x=P:R.sibling=P,R=P);return be&&Yr(_,M),x}for(P=i(_,P);M<C.length;M++)k=m(P,_,M,C[M],I),k!==null&&(n&&k.alternate!==null&&P.delete(k.key===null?M:k.key),E=r(k,E,M),R===null?x=k:R.sibling=k,R=k);return n&&P.forEach(function(L){return e(_,L)}),be&&Yr(_,M),x}function A(_,E,C,I){var x=Su(C);if(typeof x!="function")throw Error(b(150));if(C=x.call(C),C==null)throw Error(b(151));for(var R=x=null,P=E,M=E=0,k=null,N=C.next();P!==null&&!N.done;M++,N=C.next()){P.index>M?(k=P,P=null):k=P.sibling;var L=g(_,P,N.value,I);if(L===null){P===null&&(P=k);break}n&&P&&L.alternate===null&&e(_,P),E=r(L,E,M),R===null?x=L:R.sibling=L,R=L,P=k}if(N.done)return t(_,P),be&&Yr(_,M),x;if(P===null){for(;!N.done;M++,N=C.next())N=p(_,N.value,I),N!==null&&(E=r(N,E,M),R===null?x=N:R.sibling=N,R=N);return be&&Yr(_,M),x}for(P=i(_,P);!N.done;M++,N=C.next())N=m(P,_,M,N.value,I),N!==null&&(n&&N.alternate!==null&&P.delete(N.key===null?M:N.key),E=r(N,E,M),R===null?x=N:R.sibling=N,R=N);return n&&P.forEach(function(Y){return e(_,Y)}),be&&Yr(_,M),x}function T(_,E,C,I){if(typeof C=="object"&&C!==null&&C.type===ba&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case fh:e:{for(var x=C.key,R=E;R!==null;){if(R.key===x){if(x=C.type,x===ba){if(R.tag===7){t(_,R.sibling),E=s(R,C.props.children),E.return=_,_=E;break e}}else if(R.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===qs&&Z0(x)===R.type){t(_,R.sibling),E=s(R,C.props),E.ref=xu(_,R,C),E.return=_,_=E;break e}t(_,R);break}else e(_,R);R=R.sibling}C.type===ba?(E=ua(C.props.children,_.mode,I,C.key),E.return=_,_=E):(I=qh(C.type,C.key,C.props,null,_.mode,I),I.ref=xu(_,E,C),I.return=_,_=I)}return o(_);case Na:e:{for(R=C.key;E!==null;){if(E.key===R)if(E.tag===4&&E.stateNode.containerInfo===C.containerInfo&&E.stateNode.implementation===C.implementation){t(_,E.sibling),E=s(E,C.children||[]),E.return=_,_=E;break e}else{t(_,E);break}else e(_,E);E=E.sibling}E=Tg(C,_.mode,I),E.return=_,_=E}return o(_);case qs:return R=C._init,T(_,E,R(C._payload),I)}if(Fu(C))return y(_,E,C,I);if(Su(C))return A(_,E,C,I);Ch(_,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,E!==null&&E.tag===6?(t(_,E.sibling),E=s(E,C),E.return=_,_=E):(t(_,E),E=Cg(C,_.mode,I),E.return=_,_=E),o(_)):t(_,E)}return T}var hu=MS(!0),kS=MS(!1),Uf=zr(null),Hf=null,Ga=null,vv=null;function _v(){vv=Ga=Hf=null}function Av(n){var e=Uf.current;Pe(Uf),n._currentValue=e}function um(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function Qa(n,e){Hf=n,vv=Ga=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(on=!0),n.firstContext=null)}function Kn(n){var e=n._currentValue;if(vv!==n)if(n={context:n,memoizedValue:e,next:null},Ga===null){if(Hf===null)throw Error(b(308));Ga=n,Hf.dependencies={lanes:0,firstContext:n}}else Ga=Ga.next=n;return e}var to=null;function Ev(n){to===null?to=[n]:to.push(n)}function NS(n,e,t,i){var s=e.interleaved;return s===null?(t.next=t,Ev(e)):(t.next=s.next,s.next=t),e.interleaved=t,Ds(n,i)}function Ds(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var $s=!1;function Sv(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bS(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Rs(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Nr(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,de&2){var s=i.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),i.pending=e,Ds(n,t)}return s=i.interleaved,s===null?(e.next=e,Ev(i)):(e.next=s.next,s.next=e),i.interleaved=e,Ds(n,t)}function Hh(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,av(n,t)}}function j0(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var s=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?s=r=o:r=r.next=o,t=t.next}while(t!==null);r===null?s=r=e:r=r.next=e}else s=r=e;t={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Vf(n,e,t,i){var s=n.updateQueue;$s=!1;var r=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?r=u:o.next=u,o=l;var h=n.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=l))}if(r!==null){var p=s.baseState;o=0,h=u=l=null,a=r;do{var g=a.lane,m=a.eventTime;if((i&g)===g){h!==null&&(h=h.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=n,A=a;switch(g=e,m=t,A.tag){case 1:if(y=A.payload,typeof y=="function"){p=y.call(m,p,g);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=A.payload,g=typeof y=="function"?y.call(m,p,g):y,g==null)break e;p=Oe({},p,g);break e;case 2:$s=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,g=s.effects,g===null?s.effects=[a]:g.push(a))}else m={eventTime:m,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=m,l=p):h=h.next=m,o|=g;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;g=a,a=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(h===null&&(l=p),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else r===null&&(s.shared.lanes=0);fa|=o,n.lanes=o,n.memoizedState=p}}function e_(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],s=i.callback;if(s!==null){if(i.callback=null,i=t,typeof s!="function")throw Error(b(191,s));s.call(i)}}}var lh={},$i=zr(lh),Cc=zr(lh),Tc=zr(lh);function no(n){if(n===lh)throw Error(b(174));return n}function wv(n,e){switch(Ce(Tc,e),Ce(Cc,n),Ce($i,lh),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:zg(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=zg(e,n)}Pe($i),Ce($i,e)}function fu(){Pe($i),Pe(Cc),Pe(Tc)}function DS(n){no(Tc.current);var e=no($i.current),t=zg(e,n.type);e!==t&&(Ce(Cc,n),Ce($i,t))}function Cv(n){Cc.current===n&&(Pe($i),Pe(Cc))}var Ue=zr(0);function Of(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var vg=[];function Tv(){for(var n=0;n<vg.length;n++)vg[n]._workInProgressVersionPrimary=null;vg.length=0}var Vh=Vs.ReactCurrentDispatcher,_g=Vs.ReactCurrentBatchConfig,ha=0,Ve=null,it=null,ht=null,Gf=!1,oc=!1,Ic=0,jx=0;function wt(){throw Error(b(321))}function Iv(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!yi(n[t],e[t]))return!1;return!0}function xv(n,e,t,i,s,r){if(ha=r,Ve=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Vh.current=n===null||n.memoizedState===null?iP:sP,n=t(i,s),oc){r=0;do{if(oc=!1,Ic=0,25<=r)throw Error(b(301));r+=1,ht=it=null,e.updateQueue=null,Vh.current=rP,n=t(i,s)}while(oc)}if(Vh.current=Bf,e=it!==null&&it.next!==null,ha=0,ht=it=Ve=null,Gf=!1,e)throw Error(b(300));return n}function Pv(){var n=Ic!==0;return Ic=0,n}function Ti(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?Ve.memoizedState=ht=n:ht=ht.next=n,ht}function Jn(){if(it===null){var n=Ve.alternate;n=n!==null?n.memoizedState:null}else n=it.next;var e=ht===null?Ve.memoizedState:ht.next;if(e!==null)ht=e,it=n;else{if(n===null)throw Error(b(310));it=n,n={memoizedState:it.memoizedState,baseState:it.baseState,baseQueue:it.baseQueue,queue:it.queue,next:null},ht===null?Ve.memoizedState=ht=n:ht=ht.next=n}return ht}function xc(n,e){return typeof e=="function"?e(n):e}function Ag(n){var e=Jn(),t=e.queue;if(t===null)throw Error(b(311));t.lastRenderedReducer=n;var i=it,s=i.baseQueue,r=t.pending;if(r!==null){if(s!==null){var o=s.next;s.next=r.next,r.next=o}i.baseQueue=s=r,t.pending=null}if(s!==null){r=s.next,i=i.baseState;var a=o=null,l=null,u=r;do{var h=u.lane;if((ha&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:n(i,u.action);else{var p={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=i):l=l.next=p,Ve.lanes|=h,fa|=h}u=u.next}while(u!==null&&u!==r);l===null?o=i:l.next=a,yi(i,e.memoizedState)||(on=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,t.lastRenderedState=i}if(n=t.interleaved,n!==null){s=n;do r=s.lane,Ve.lanes|=r,fa|=r,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Eg(n){var e=Jn(),t=e.queue;if(t===null)throw Error(b(311));t.lastRenderedReducer=n;var i=t.dispatch,s=t.pending,r=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do r=n(r,o.action),o=o.next;while(o!==s);yi(r,e.memoizedState)||(on=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,i]}function LS(){}function FS(n,e){var t=Ve,i=Jn(),s=e(),r=!yi(i.memoizedState,s);if(r&&(i.memoizedState=s,on=!0),i=i.queue,Rv(VS.bind(null,t,i,n),[n]),i.getSnapshot!==e||r||ht!==null&&ht.memoizedState.tag&1){if(t.flags|=2048,Pc(9,HS.bind(null,t,i,s,e),void 0,null),ft===null)throw Error(b(349));ha&30||US(t,e,s)}return s}function US(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function HS(n,e,t,i){e.value=t,e.getSnapshot=i,OS(e)&&GS(n)}function VS(n,e,t){return t(function(){OS(e)&&GS(n)})}function OS(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!yi(n,t)}catch{return!0}}function GS(n){var e=Ds(n,1);e!==null&&mi(e,n,1,-1)}function t_(n){var e=Ti();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xc,lastRenderedState:n},e.queue=n,n=n.dispatch=nP.bind(null,Ve,n),[e.memoizedState,n]}function Pc(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function BS(){return Jn().memoizedState}function Oh(n,e,t,i){var s=Ti();Ve.flags|=n,s.memoizedState=Pc(1|e,t,void 0,i===void 0?null:i)}function Np(n,e,t,i){var s=Jn();i=i===void 0?null:i;var r=void 0;if(it!==null){var o=it.memoizedState;if(r=o.destroy,i!==null&&Iv(i,o.deps)){s.memoizedState=Pc(e,t,r,i);return}}Ve.flags|=n,s.memoizedState=Pc(1|e,t,r,i)}function n_(n,e){return Oh(8390656,8,n,e)}function Rv(n,e){return Np(2048,8,n,e)}function zS(n,e){return Np(4,2,n,e)}function qS(n,e){return Np(4,4,n,e)}function $S(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function WS(n,e,t){return t=t!=null?t.concat([n]):null,Np(4,4,$S.bind(null,e,n),t)}function Mv(){}function YS(n,e){var t=Jn();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Iv(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function KS(n,e){var t=Jn();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Iv(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function JS(n,e,t){return ha&21?(yi(t,e)||(t=eS(),Ve.lanes|=t,fa|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,on=!0),n.memoizedState=t)}function eP(n,e){var t=_e;_e=t!==0&&4>t?t:4,n(!0);var i=_g.transition;_g.transition={};try{n(!1),e()}finally{_e=t,_g.transition=i}}function XS(){return Jn().memoizedState}function tP(n,e,t){var i=Dr(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},QS(n))ZS(e,t);else if(t=NS(n,e,t,i),t!==null){var s=qt();mi(t,n,i,s),jS(t,e,i)}}function nP(n,e,t){var i=Dr(n),s={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(QS(n))ZS(e,s);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var o=e.lastRenderedState,a=r(o,t);if(s.hasEagerState=!0,s.eagerState=a,yi(a,o)){var l=e.interleaved;l===null?(s.next=s,Ev(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}t=NS(n,e,s,i),t!==null&&(s=qt(),mi(t,n,i,s),jS(t,e,i))}}function QS(n){var e=n.alternate;return n===Ve||e!==null&&e===Ve}function ZS(n,e){oc=Gf=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function jS(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,av(n,t)}}var Bf={readContext:Kn,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useInsertionEffect:wt,useLayoutEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useMutableSource:wt,useSyncExternalStore:wt,useId:wt,unstable_isNewReconciler:!1},iP={readContext:Kn,useCallback:function(n,e){return Ti().memoizedState=[n,e===void 0?null:e],n},useContext:Kn,useEffect:n_,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Oh(4194308,4,$S.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Oh(4194308,4,n,e)},useInsertionEffect:function(n,e){return Oh(4,2,n,e)},useMemo:function(n,e){var t=Ti();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=Ti();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=tP.bind(null,Ve,n),[i.memoizedState,n]},useRef:function(n){var e=Ti();return n={current:n},e.memoizedState=n},useState:t_,useDebugValue:Mv,useDeferredValue:function(n){return Ti().memoizedState=n},useTransition:function(){var n=t_(!1),e=n[0];return n=eP.bind(null,n[1]),Ti().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=Ve,s=Ti();if(be){if(t===void 0)throw Error(b(407));t=t()}else{if(t=e(),ft===null)throw Error(b(349));ha&30||US(i,e,t)}s.memoizedState=t;var r={value:t,getSnapshot:e};return s.queue=r,n_(VS.bind(null,i,r,n),[n]),i.flags|=2048,Pc(9,HS.bind(null,i,r,t,e),void 0,null),t},useId:function(){var n=Ti(),e=ft.identifierPrefix;if(be){var t=Ps,i=xs;t=(i&~(1<<32-gi(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=Ic++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=jx++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},sP={readContext:Kn,useCallback:YS,useContext:Kn,useEffect:Rv,useImperativeHandle:WS,useInsertionEffect:zS,useLayoutEffect:qS,useMemo:KS,useReducer:Ag,useRef:BS,useState:function(){return Ag(xc)},useDebugValue:Mv,useDeferredValue:function(n){var e=Jn();return JS(e,it.memoizedState,n)},useTransition:function(){var n=Ag(xc)[0],e=Jn().memoizedState;return[n,e]},useMutableSource:LS,useSyncExternalStore:FS,useId:XS,unstable_isNewReconciler:!1},rP={readContext:Kn,useCallback:YS,useContext:Kn,useEffect:Rv,useImperativeHandle:WS,useInsertionEffect:zS,useLayoutEffect:qS,useMemo:KS,useReducer:Eg,useRef:BS,useState:function(){return Eg(xc)},useDebugValue:Mv,useDeferredValue:function(n){var e=Jn();return it===null?e.memoizedState=n:JS(e,it.memoizedState,n)},useTransition:function(){var n=Eg(xc)[0],e=Jn().memoizedState;return[n,e]},useMutableSource:LS,useSyncExternalStore:FS,useId:XS,unstable_isNewReconciler:!1};function Zn(n,e){if(n&&n.defaultProps){e=Oe({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function cm(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:Oe({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var bp={isMounted:function(n){return(n=n._reactInternals)?Aa(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=qt(),s=Dr(n),r=Rs(i,s);r.payload=e,t!=null&&(r.callback=t),e=Nr(n,r,s),e!==null&&(mi(e,n,s,i),Hh(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=qt(),s=Dr(n),r=Rs(i,s);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=Nr(n,r,s),e!==null&&(mi(e,n,s,i),Hh(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=qt(),i=Dr(n),s=Rs(t,i);s.tag=2,e!=null&&(s.callback=e),e=Nr(n,s,i),e!==null&&(mi(e,n,i,t),Hh(e,n,i))}};function i_(n,e,t,i,s,r,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,r,o):e.prototype&&e.prototype.isPureReactComponent?!Ac(t,i)||!Ac(s,r):!0}function ew(n,e,t){var i=!1,s=Hr,r=e.contextType;return typeof r=="object"&&r!==null?r=Kn(r):(s=ln(e)?ca:Ft.current,i=e.contextTypes,r=(i=i!=null)?cu(n,s):Hr),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=bp,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=r),e}function s_(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&bp.enqueueReplaceState(e,e.state,null)}function dm(n,e,t,i){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},Sv(n);var r=e.contextType;typeof r=="object"&&r!==null?s.context=Kn(r):(r=ln(e)?ca:Ft.current,s.context=cu(n,r)),s.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(cm(n,e,r,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&bp.enqueueReplaceState(s,s.state,null),Vf(n,t,s,i),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function pu(n,e){try{var t="",i=e;do t+=bI(i),i=i.return;while(i);var s=t}catch(r){s=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:s,digest:null}}function Sg(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function hm(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var oP=typeof WeakMap=="function"?WeakMap:Map;function tw(n,e,t){t=Rs(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){qf||(qf=!0,Sm=i),hm(n,e)},t}function nw(n,e,t){t=Rs(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var s=e.value;t.payload=function(){return i(s)},t.callback=function(){hm(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){hm(n,e),typeof i!="function"&&(br===null?br=new Set([this]):br.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function r_(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new oP;var s=new Set;i.set(e,s)}else s=i.get(e),s===void 0&&(s=new Set,i.set(e,s));s.has(t)||(s.add(t),n=AP.bind(null,n,e,t),e.then(n,n))}function o_(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function a_(n,e,t,i,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Rs(-1,1),e.tag=2,Nr(t,e,1))),t.lanes|=1),n)}var aP=Vs.ReactCurrentOwner,on=!1;function zt(n,e,t,i){e.child=n===null?kS(e,null,t,i):hu(e,n.child,t,i)}function l_(n,e,t,i,s){t=t.render;var r=e.ref;return Qa(e,s),i=xv(n,e,t,i,r,s),t=Pv(),n!==null&&!on?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Ls(n,e,s)):(be&&t&&gv(e),e.flags|=1,zt(n,e,i,s),e.child)}function u_(n,e,t,i,s){if(n===null){var r=t.type;return typeof r=="function"&&!Hv(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,iw(n,e,r,i,s)):(n=qh(t.type,null,i,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&s)){var o=r.memoizedProps;if(t=t.compare,t=t!==null?t:Ac,t(o,i)&&n.ref===e.ref)return Ls(n,e,s)}return e.flags|=1,n=Lr(r,i),n.ref=e.ref,n.return=e,e.child=n}function iw(n,e,t,i,s){if(n!==null){var r=n.memoizedProps;if(Ac(r,i)&&n.ref===e.ref)if(on=!1,e.pendingProps=i=r,(n.lanes&s)!==0)n.flags&131072&&(on=!0);else return e.lanes=n.lanes,Ls(n,e,s)}return fm(n,e,t,i,s)}function sw(n,e,t){var i=e.pendingProps,s=i.children,r=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ce(za,wn),wn|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ce(za,wn),wn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=r!==null?r.baseLanes:t,Ce(za,wn),wn|=i}else r!==null?(i=r.baseLanes|t,e.memoizedState=null):i=t,Ce(za,wn),wn|=i;return zt(n,e,s,t),e.child}function rw(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function fm(n,e,t,i,s){var r=ln(t)?ca:Ft.current;return r=cu(e,r),Qa(e,s),t=xv(n,e,t,i,r,s),i=Pv(),n!==null&&!on?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Ls(n,e,s)):(be&&i&&gv(e),e.flags|=1,zt(n,e,t,s),e.child)}function c_(n,e,t,i,s){if(ln(t)){var r=!0;Df(e)}else r=!1;if(Qa(e,s),e.stateNode===null)Gh(n,e),ew(e,t,i),dm(e,t,i,s),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Kn(u):(u=ln(t)?ca:Ft.current,u=cu(e,u));var h=t.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&s_(e,o,i,u),$s=!1;var g=e.memoizedState;o.state=g,Vf(e,i,o,s),l=e.memoizedState,a!==i||g!==l||an.current||$s?(typeof h=="function"&&(cm(e,t,h,i),l=e.memoizedState),(a=$s||i_(e,t,a,i,g,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,bS(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:Zn(e.type,a),o.props=u,p=e.pendingProps,g=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Kn(l):(l=ln(t)?ca:Ft.current,l=cu(e,l));var m=t.getDerivedStateFromProps;(h=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||g!==l)&&s_(e,o,i,l),$s=!1,g=e.memoizedState,o.state=g,Vf(e,i,o,s);var y=e.memoizedState;a!==p||g!==y||an.current||$s?(typeof m=="function"&&(cm(e,t,m,i),y=e.memoizedState),(u=$s||i_(e,t,u,i,g,y,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,y,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&g===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&g===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=y),o.props=i,o.state=y,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&g===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&g===n.memoizedState||(e.flags|=1024),i=!1)}return pm(n,e,t,i,r,s)}function pm(n,e,t,i,s,r){rw(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return s&&J0(e,t,!1),Ls(n,e,r);i=e.stateNode,aP.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=hu(e,n.child,null,r),e.child=hu(e,null,a,r)):zt(n,e,a,r),e.memoizedState=i.state,s&&J0(e,t,!0),e.child}function ow(n){var e=n.stateNode;e.pendingContext?K0(n,e.pendingContext,e.pendingContext!==e.context):e.context&&K0(n,e.context,!1),wv(n,e.containerInfo)}function d_(n,e,t,i,s){return du(),yv(s),e.flags|=256,zt(n,e,t,i),e.child}var gm={dehydrated:null,treeContext:null,retryLane:0};function mm(n){return{baseLanes:n,cachePool:null,transitions:null}}function aw(n,e,t){var i=e.pendingProps,s=Ue.current,r=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),Ce(Ue,s&1),n===null)return lm(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,n=i.fallback,r?(i=e.mode,r=e.child,o={mode:"hidden",children:o},!(i&1)&&r!==null?(r.childLanes=0,r.pendingProps=o):r=Fp(o,i,0,null),n=ua(n,i,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=mm(t),e.memoizedState=gm,n):kv(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return lP(n,e,o,i,a,s,t);if(r){r=i.fallback,o=e.mode,s=n.child,a=s.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==s?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Lr(s,l),i.subtreeFlags=s.subtreeFlags&14680064),a!==null?r=Lr(a,r):(r=ua(r,o,t,null),r.flags|=2),r.return=e,i.return=e,i.sibling=r,e.child=i,i=r,r=e.child,o=n.child.memoizedState,o=o===null?mm(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},r.memoizedState=o,r.childLanes=n.childLanes&~t,e.memoizedState=gm,i}return r=n.child,n=r.sibling,i=Lr(r,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function kv(n,e){return e=Fp({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Th(n,e,t,i){return i!==null&&yv(i),hu(e,n.child,null,t),n=kv(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function lP(n,e,t,i,s,r,o){if(t)return e.flags&256?(e.flags&=-257,i=Sg(Error(b(422))),Th(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=i.fallback,s=e.mode,i=Fp({mode:"visible",children:i.children},s,0,null),r=ua(r,s,o,null),r.flags|=2,i.return=e,r.return=e,i.sibling=r,e.child=i,e.mode&1&&hu(e,n.child,null,o),e.child.memoizedState=mm(o),e.memoizedState=gm,r);if(!(e.mode&1))return Th(n,e,o,null);if(s.data==="$!"){if(i=s.nextSibling&&s.nextSibling.dataset,i)var a=i.dgst;return i=a,r=Error(b(419)),i=Sg(r,i,void 0),Th(n,e,o,i)}if(a=(o&n.childLanes)!==0,on||a){if(i=ft,i!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(i.suspendedLanes|o)?0:s,s!==0&&s!==r.retryLane&&(r.retryLane=s,Ds(n,s),mi(i,n,s,-1))}return Uv(),i=Sg(Error(b(421))),Th(n,e,o,i)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=EP.bind(null,n),s._reactRetry=e,null):(n=r.treeContext,In=kr(s.nextSibling),xn=e,be=!0,fi=null,n!==null&&(On[Gn++]=xs,On[Gn++]=Ps,On[Gn++]=da,xs=n.id,Ps=n.overflow,da=e),e=kv(e,i.children),e.flags|=4096,e)}function h_(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),um(n.return,e,t)}function wg(n,e,t,i,s){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:s}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=t,r.tailMode=s)}function lw(n,e,t){var i=e.pendingProps,s=i.revealOrder,r=i.tail;if(zt(n,e,i.children,t),i=Ue.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&h_(n,t,e);else if(n.tag===19)h_(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(Ce(Ue,i),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&Of(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),wg(e,!1,s,t,r);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&Of(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}wg(e,!0,t,null,r);break;case"together":wg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Gh(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Ls(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),fa|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(b(153));if(e.child!==null){for(n=e.child,t=Lr(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Lr(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function uP(n,e,t){switch(e.tag){case 3:ow(e),du();break;case 5:DS(e);break;case 1:ln(e.type)&&Df(e);break;case 4:wv(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,s=e.memoizedProps.value;Ce(Uf,i._currentValue),i._currentValue=s;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Ce(Ue,Ue.current&1),e.flags|=128,null):t&e.child.childLanes?aw(n,e,t):(Ce(Ue,Ue.current&1),n=Ls(n,e,t),n!==null?n.sibling:null);Ce(Ue,Ue.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return lw(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ce(Ue,Ue.current),i)break;return null;case 22:case 23:return e.lanes=0,sw(n,e,t)}return Ls(n,e,t)}var uw,ym,cw,dw;uw=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};ym=function(){};cw=function(n,e,t,i){var s=n.memoizedProps;if(s!==i){n=e.stateNode,no($i.current);var r=null;switch(t){case"input":s=Vg(n,s),i=Vg(n,i),r=[];break;case"select":s=Oe({},s,{value:void 0}),i=Oe({},i,{value:void 0}),r=[];break;case"textarea":s=Bg(n,s),i=Bg(n,i),r=[];break;default:typeof s.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=Nf)}qg(t,i);var o;t=null;for(u in s)if(!i.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(fc.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in i){var l=i[u];if(a=s!=null?s[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(r||(r=[]),r.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(r=r||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(r=r||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(fc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Te("scroll",n),r||a===l||(r=[])):(r=r||[]).push(u,l))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};dw=function(n,e,t,i){t!==i&&(e.flags|=4)};function Pu(n,e){if(!be)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function Ct(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags&14680064,i|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function cP(n,e,t){var i=e.pendingProps;switch(mv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ct(e),null;case 1:return ln(e.type)&&bf(),Ct(e),null;case 3:return i=e.stateNode,fu(),Pe(an),Pe(Ft),Tv(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(wh(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,fi!==null&&(Tm(fi),fi=null))),ym(n,e),Ct(e),null;case 5:Cv(e);var s=no(Tc.current);if(t=e.type,n!==null&&e.stateNode!=null)cw(n,e,t,i,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(b(166));return Ct(e),null}if(n=no($i.current),wh(e)){i=e.stateNode,t=e.type;var r=e.memoizedProps;switch(i[zi]=e,i[wc]=r,n=(e.mode&1)!==0,t){case"dialog":Te("cancel",i),Te("close",i);break;case"iframe":case"object":case"embed":Te("load",i);break;case"video":case"audio":for(s=0;s<Hu.length;s++)Te(Hu[s],i);break;case"source":Te("error",i);break;case"img":case"image":case"link":Te("error",i),Te("load",i);break;case"details":Te("toggle",i);break;case"input":E0(i,r),Te("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!r.multiple},Te("invalid",i);break;case"textarea":w0(i,r),Te("invalid",i)}qg(t,r),s=null;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];o==="children"?typeof a=="string"?i.textContent!==a&&(r.suppressHydrationWarning!==!0&&Sh(i.textContent,a,n),s=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(r.suppressHydrationWarning!==!0&&Sh(i.textContent,a,n),s=["children",""+a]):fc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Te("scroll",i)}switch(t){case"input":ph(i),S0(i,r,!0);break;case"textarea":ph(i),C0(i);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(i.onclick=Nf)}i=s,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=VE(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[zi]=e,n[wc]=i,uw(n,e,!1,!1),e.stateNode=n;e:{switch(o=$g(t,i),t){case"dialog":Te("cancel",n),Te("close",n),s=i;break;case"iframe":case"object":case"embed":Te("load",n),s=i;break;case"video":case"audio":for(s=0;s<Hu.length;s++)Te(Hu[s],n);s=i;break;case"source":Te("error",n),s=i;break;case"img":case"image":case"link":Te("error",n),Te("load",n),s=i;break;case"details":Te("toggle",n),s=i;break;case"input":E0(n,i),s=Vg(n,i),Te("invalid",n);break;case"option":s=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},s=Oe({},i,{value:void 0}),Te("invalid",n);break;case"textarea":w0(n,i),s=Bg(n,i),Te("invalid",n);break;default:s=i}qg(t,s),a=s;for(r in a)if(a.hasOwnProperty(r)){var l=a[r];r==="style"?BE(n,l):r==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&OE(n,l)):r==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&pc(n,l):typeof l=="number"&&pc(n,""+l):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(fc.hasOwnProperty(r)?l!=null&&r==="onScroll"&&Te("scroll",n):l!=null&&tv(n,r,l,o))}switch(t){case"input":ph(n),S0(n,i,!1);break;case"textarea":ph(n),C0(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Ur(i.value));break;case"select":n.multiple=!!i.multiple,r=i.value,r!=null?Ya(n,!!i.multiple,r,!1):i.defaultValue!=null&&Ya(n,!!i.multiple,i.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=Nf)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ct(e),null;case 6:if(n&&e.stateNode!=null)dw(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(b(166));if(t=no(Tc.current),no($i.current),wh(e)){if(i=e.stateNode,t=e.memoizedProps,i[zi]=e,(r=i.nodeValue!==t)&&(n=xn,n!==null))switch(n.tag){case 3:Sh(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Sh(i.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[zi]=e,e.stateNode=i}return Ct(e),null;case 13:if(Pe(Ue),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(be&&In!==null&&e.mode&1&&!(e.flags&128))RS(),du(),e.flags|=98560,r=!1;else if(r=wh(e),i!==null&&i.dehydrated!==null){if(n===null){if(!r)throw Error(b(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(b(317));r[zi]=e}else du(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ct(e),r=!1}else fi!==null&&(Tm(fi),fi=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||Ue.current&1?st===0&&(st=3):Uv())),e.updateQueue!==null&&(e.flags|=4),Ct(e),null);case 4:return fu(),ym(n,e),n===null&&Ec(e.stateNode.containerInfo),Ct(e),null;case 10:return Av(e.type._context),Ct(e),null;case 17:return ln(e.type)&&bf(),Ct(e),null;case 19:if(Pe(Ue),r=e.memoizedState,r===null)return Ct(e),null;if(i=(e.flags&128)!==0,o=r.rendering,o===null)if(i)Pu(r,!1);else{if(st!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Of(n),o!==null){for(e.flags|=128,Pu(r,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)r=t,n=i,r.flags&=14680066,o=r.alternate,o===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,n=o.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ce(Ue,Ue.current&1|2),e.child}n=n.sibling}r.tail!==null&&We()>gu&&(e.flags|=128,i=!0,Pu(r,!1),e.lanes=4194304)}else{if(!i)if(n=Of(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Pu(r,!0),r.tail===null&&r.tailMode==="hidden"&&!o.alternate&&!be)return Ct(e),null}else 2*We()-r.renderingStartTime>gu&&t!==1073741824&&(e.flags|=128,i=!0,Pu(r,!1),e.lanes=4194304);r.isBackwards?(o.sibling=e.child,e.child=o):(t=r.last,t!==null?t.sibling=o:e.child=o,r.last=o)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=We(),e.sibling=null,t=Ue.current,Ce(Ue,i?t&1|2:t&1),e):(Ct(e),null);case 22:case 23:return Fv(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?wn&1073741824&&(Ct(e),e.subtreeFlags&6&&(e.flags|=8192)):Ct(e),null;case 24:return null;case 25:return null}throw Error(b(156,e.tag))}function dP(n,e){switch(mv(e),e.tag){case 1:return ln(e.type)&&bf(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return fu(),Pe(an),Pe(Ft),Tv(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Cv(e),null;case 13:if(Pe(Ue),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(b(340));du()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Pe(Ue),null;case 4:return fu(),null;case 10:return Av(e.type._context),null;case 22:case 23:return Fv(),null;case 24:return null;default:return null}}var Ih=!1,bt=!1,hP=typeof WeakSet=="function"?WeakSet:Set,B=null;function Ba(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){ze(n,e,i)}else t.current=null}function vm(n,e,t){try{t()}catch(i){ze(n,e,i)}}var f_=!1;function fP(n,e){if(tm=Rf,n=mS(),pv(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var s=i.anchorOffset,r=i.focusNode;i=i.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,h=0,p=n,g=null;t:for(;;){for(var m;p!==t||s!==0&&p.nodeType!==3||(a=o+s),p!==r||i!==0&&p.nodeType!==3||(l=o+i),p.nodeType===3&&(o+=p.nodeValue.length),(m=p.firstChild)!==null;)g=p,p=m;for(;;){if(p===n)break t;if(g===t&&++u===s&&(a=o),g===r&&++h===i&&(l=o),(m=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=m}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(nm={focusedElem:n,selectionRange:t},Rf=!1,B=e;B!==null;)if(e=B,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,B=n;else for(;B!==null;){e=B;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var A=y.memoizedProps,T=y.memoizedState,_=e.stateNode,E=_.getSnapshotBeforeUpdate(e.elementType===e.type?A:Zn(e.type,A),T);_.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(b(163))}}catch(I){ze(e,e.return,I)}if(n=e.sibling,n!==null){n.return=e.return,B=n;break}B=e.return}return y=f_,f_=!1,y}function ac(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&n)===n){var r=s.destroy;s.destroy=void 0,r!==void 0&&vm(e,t,r)}s=s.next}while(s!==i)}}function Dp(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function _m(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function hw(n){var e=n.alternate;e!==null&&(n.alternate=null,hw(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[zi],delete e[wc],delete e[rm],delete e[Jx],delete e[Xx])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function fw(n){return n.tag===5||n.tag===3||n.tag===4}function p_(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||fw(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Am(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Nf));else if(i!==4&&(n=n.child,n!==null))for(Am(n,e,t),n=n.sibling;n!==null;)Am(n,e,t),n=n.sibling}function Em(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(Em(n,e,t),n=n.sibling;n!==null;)Em(n,e,t),n=n.sibling}var _t=null,hi=!1;function Bs(n,e,t){for(t=t.child;t!==null;)pw(n,e,t),t=t.sibling}function pw(n,e,t){if(qi&&typeof qi.onCommitFiberUnmount=="function")try{qi.onCommitFiberUnmount(Ip,t)}catch{}switch(t.tag){case 5:bt||Ba(t,e);case 6:var i=_t,s=hi;_t=null,Bs(n,e,t),_t=i,hi=s,_t!==null&&(hi?(n=_t,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):_t.removeChild(t.stateNode));break;case 18:_t!==null&&(hi?(n=_t,t=t.stateNode,n.nodeType===8?mg(n.parentNode,t):n.nodeType===1&&mg(n,t),vc(n)):mg(_t,t.stateNode));break;case 4:i=_t,s=hi,_t=t.stateNode.containerInfo,hi=!0,Bs(n,e,t),_t=i,hi=s;break;case 0:case 11:case 14:case 15:if(!bt&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){s=i=i.next;do{var r=s,o=r.destroy;r=r.tag,o!==void 0&&(r&2||r&4)&&vm(t,e,o),s=s.next}while(s!==i)}Bs(n,e,t);break;case 1:if(!bt&&(Ba(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){ze(t,e,a)}Bs(n,e,t);break;case 21:Bs(n,e,t);break;case 22:t.mode&1?(bt=(i=bt)||t.memoizedState!==null,Bs(n,e,t),bt=i):Bs(n,e,t);break;default:Bs(n,e,t)}}function g_(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new hP),e.forEach(function(i){var s=SP.bind(null,n,i);t.has(i)||(t.add(i),i.then(s,s))})}}function Xn(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var s=t[i];try{var r=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:_t=a.stateNode,hi=!1;break e;case 3:_t=a.stateNode.containerInfo,hi=!0;break e;case 4:_t=a.stateNode.containerInfo,hi=!0;break e}a=a.return}if(_t===null)throw Error(b(160));pw(r,o,s),_t=null,hi=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){ze(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)gw(e,n),e=e.sibling}function gw(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Xn(e,n),Ei(n),i&4){try{ac(3,n,n.return),Dp(3,n)}catch(A){ze(n,n.return,A)}try{ac(5,n,n.return)}catch(A){ze(n,n.return,A)}}break;case 1:Xn(e,n),Ei(n),i&512&&t!==null&&Ba(t,t.return);break;case 5:if(Xn(e,n),Ei(n),i&512&&t!==null&&Ba(t,t.return),n.flags&32){var s=n.stateNode;try{pc(s,"")}catch(A){ze(n,n.return,A)}}if(i&4&&(s=n.stateNode,s!=null)){var r=n.memoizedProps,o=t!==null?t.memoizedProps:r,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&r.type==="radio"&&r.name!=null&&UE(s,r),$g(a,o);var u=$g(a,r);for(o=0;o<l.length;o+=2){var h=l[o],p=l[o+1];h==="style"?BE(s,p):h==="dangerouslySetInnerHTML"?OE(s,p):h==="children"?pc(s,p):tv(s,h,p,u)}switch(a){case"input":Og(s,r);break;case"textarea":HE(s,r);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!r.multiple;var m=r.value;m!=null?Ya(s,!!r.multiple,m,!1):g!==!!r.multiple&&(r.defaultValue!=null?Ya(s,!!r.multiple,r.defaultValue,!0):Ya(s,!!r.multiple,r.multiple?[]:"",!1))}s[wc]=r}catch(A){ze(n,n.return,A)}}break;case 6:if(Xn(e,n),Ei(n),i&4){if(n.stateNode===null)throw Error(b(162));s=n.stateNode,r=n.memoizedProps;try{s.nodeValue=r}catch(A){ze(n,n.return,A)}}break;case 3:if(Xn(e,n),Ei(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{vc(e.containerInfo)}catch(A){ze(n,n.return,A)}break;case 4:Xn(e,n),Ei(n);break;case 13:Xn(e,n),Ei(n),s=n.child,s.flags&8192&&(r=s.memoizedState!==null,s.stateNode.isHidden=r,!r||s.alternate!==null&&s.alternate.memoizedState!==null||(Dv=We())),i&4&&g_(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(bt=(u=bt)||h,Xn(e,n),bt=u):Xn(e,n),Ei(n),i&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for(B=n,h=n.child;h!==null;){for(p=B=h;B!==null;){switch(g=B,m=g.child,g.tag){case 0:case 11:case 14:case 15:ac(4,g,g.return);break;case 1:Ba(g,g.return);var y=g.stateNode;if(typeof y.componentWillUnmount=="function"){i=g,t=g.return;try{e=i,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(A){ze(i,t,A)}}break;case 5:Ba(g,g.return);break;case 22:if(g.memoizedState!==null){y_(p);continue}}m!==null?(m.return=g,B=m):y_(p)}h=h.sibling}e:for(h=null,p=n;;){if(p.tag===5){if(h===null){h=p;try{s=p.stateNode,u?(r=s.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=GE("display",o))}catch(A){ze(n,n.return,A)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(A){ze(n,n.return,A)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===n)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===n)break e;for(;p.sibling===null;){if(p.return===null||p.return===n)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Xn(e,n),Ei(n),i&4&&g_(n);break;case 21:break;default:Xn(e,n),Ei(n)}}function Ei(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(fw(t)){var i=t;break e}t=t.return}throw Error(b(160))}switch(i.tag){case 5:var s=i.stateNode;i.flags&32&&(pc(s,""),i.flags&=-33);var r=p_(n);Em(n,r,s);break;case 3:case 4:var o=i.stateNode.containerInfo,a=p_(n);Am(n,a,o);break;default:throw Error(b(161))}}catch(l){ze(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function pP(n,e,t){B=n,mw(n)}function mw(n,e,t){for(var i=(n.mode&1)!==0;B!==null;){var s=B,r=s.child;if(s.tag===22&&i){var o=s.memoizedState!==null||Ih;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||bt;a=Ih;var u=bt;if(Ih=o,(bt=l)&&!u)for(B=s;B!==null;)o=B,l=o.child,o.tag===22&&o.memoizedState!==null?v_(s):l!==null?(l.return=o,B=l):v_(s);for(;r!==null;)B=r,mw(r),r=r.sibling;B=s,Ih=a,bt=u}m_(n)}else s.subtreeFlags&8772&&r!==null?(r.return=s,B=r):m_(n)}}function m_(n){for(;B!==null;){var e=B;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:bt||Dp(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!bt)if(t===null)i.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:Zn(e.type,t.memoizedProps);i.componentDidUpdate(s,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&e_(e,r,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}e_(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&vc(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(b(163))}bt||e.flags&512&&_m(e)}catch(g){ze(e,e.return,g)}}if(e===n){B=null;break}if(t=e.sibling,t!==null){t.return=e.return,B=t;break}B=e.return}}function y_(n){for(;B!==null;){var e=B;if(e===n){B=null;break}var t=e.sibling;if(t!==null){t.return=e.return,B=t;break}B=e.return}}function v_(n){for(;B!==null;){var e=B;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Dp(4,e)}catch(l){ze(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var s=e.return;try{i.componentDidMount()}catch(l){ze(e,s,l)}}var r=e.return;try{_m(e)}catch(l){ze(e,r,l)}break;case 5:var o=e.return;try{_m(e)}catch(l){ze(e,o,l)}}}catch(l){ze(e,e.return,l)}if(e===n){B=null;break}var a=e.sibling;if(a!==null){a.return=e.return,B=a;break}B=e.return}}var gP=Math.ceil,zf=Vs.ReactCurrentDispatcher,Nv=Vs.ReactCurrentOwner,$n=Vs.ReactCurrentBatchConfig,de=0,ft=null,Je=null,Et=0,wn=0,za=zr(0),st=0,Rc=null,fa=0,Lp=0,bv=0,lc=null,rn=null,Dv=0,gu=1/0,Qi=null,qf=!1,Sm=null,br=null,xh=!1,Ir=null,$f=0,uc=0,wm=null,Bh=-1,zh=0;function qt(){return de&6?We():Bh!==-1?Bh:Bh=We()}function Dr(n){return n.mode&1?de&2&&Et!==0?Et&-Et:Zx.transition!==null?(zh===0&&(zh=eS()),zh):(n=_e,n!==0||(n=window.event,n=n===void 0?16:aS(n.type)),n):1}function mi(n,e,t,i){if(50<uc)throw uc=0,wm=null,Error(b(185));rh(n,t,i),(!(de&2)||n!==ft)&&(n===ft&&(!(de&2)&&(Lp|=t),st===4&&Ys(n,Et)),un(n,i),t===1&&de===0&&!(e.mode&1)&&(gu=We()+500,kp&&qr()))}function un(n,e){var t=n.callbackNode;ZI(n,e);var i=Pf(n,n===ft?Et:0);if(i===0)t!==null&&x0(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&x0(t),e===1)n.tag===0?Qx(__.bind(null,n)):IS(__.bind(null,n)),Yx(function(){!(de&6)&&qr()}),t=null;else{switch(tS(i)){case 1:t=ov;break;case 4:t=ZE;break;case 16:t=xf;break;case 536870912:t=jE;break;default:t=xf}t=Cw(t,yw.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function yw(n,e){if(Bh=-1,zh=0,de&6)throw Error(b(327));var t=n.callbackNode;if(Za()&&n.callbackNode!==t)return null;var i=Pf(n,n===ft?Et:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=Wf(n,i);else{e=i;var s=de;de|=2;var r=_w();(ft!==n||Et!==e)&&(Qi=null,gu=We()+500,la(n,e));do try{vP();break}catch(a){vw(n,a)}while(!0);_v(),zf.current=r,de=s,Je!==null?e=0:(ft=null,Et=0,e=st)}if(e!==0){if(e===2&&(s=Xg(n),s!==0&&(i=s,e=Cm(n,s))),e===1)throw t=Rc,la(n,0),Ys(n,i),un(n,We()),t;if(e===6)Ys(n,i);else{if(s=n.current.alternate,!(i&30)&&!mP(s)&&(e=Wf(n,i),e===2&&(r=Xg(n),r!==0&&(i=r,e=Cm(n,r))),e===1))throw t=Rc,la(n,0),Ys(n,i),un(n,We()),t;switch(n.finishedWork=s,n.finishedLanes=i,e){case 0:case 1:throw Error(b(345));case 2:Kr(n,rn,Qi);break;case 3:if(Ys(n,i),(i&130023424)===i&&(e=Dv+500-We(),10<e)){if(Pf(n,0)!==0)break;if(s=n.suspendedLanes,(s&i)!==i){qt(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=sm(Kr.bind(null,n,rn,Qi),e);break}Kr(n,rn,Qi);break;case 4:if(Ys(n,i),(i&4194240)===i)break;for(e=n.eventTimes,s=-1;0<i;){var o=31-gi(i);r=1<<o,o=e[o],o>s&&(s=o),i&=~r}if(i=s,i=We()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*gP(i/1960))-i,10<i){n.timeoutHandle=sm(Kr.bind(null,n,rn,Qi),i);break}Kr(n,rn,Qi);break;case 5:Kr(n,rn,Qi);break;default:throw Error(b(329))}}}return un(n,We()),n.callbackNode===t?yw.bind(null,n):null}function Cm(n,e){var t=lc;return n.current.memoizedState.isDehydrated&&(la(n,e).flags|=256),n=Wf(n,e),n!==2&&(e=rn,rn=t,e!==null&&Tm(e)),n}function Tm(n){rn===null?rn=n:rn.push.apply(rn,n)}function mP(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var s=t[i],r=s.getSnapshot;s=s.value;try{if(!yi(r(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ys(n,e){for(e&=~bv,e&=~Lp,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-gi(e),i=1<<t;n[t]=-1,e&=~i}}function __(n){if(de&6)throw Error(b(327));Za();var e=Pf(n,0);if(!(e&1))return un(n,We()),null;var t=Wf(n,e);if(n.tag!==0&&t===2){var i=Xg(n);i!==0&&(e=i,t=Cm(n,i))}if(t===1)throw t=Rc,la(n,0),Ys(n,e),un(n,We()),t;if(t===6)throw Error(b(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Kr(n,rn,Qi),un(n,We()),null}function Lv(n,e){var t=de;de|=1;try{return n(e)}finally{de=t,de===0&&(gu=We()+500,kp&&qr())}}function pa(n){Ir!==null&&Ir.tag===0&&!(de&6)&&Za();var e=de;de|=1;var t=$n.transition,i=_e;try{if($n.transition=null,_e=1,n)return n()}finally{_e=i,$n.transition=t,de=e,!(de&6)&&qr()}}function Fv(){wn=za.current,Pe(za)}function la(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Wx(t)),Je!==null)for(t=Je.return;t!==null;){var i=t;switch(mv(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&bf();break;case 3:fu(),Pe(an),Pe(Ft),Tv();break;case 5:Cv(i);break;case 4:fu();break;case 13:Pe(Ue);break;case 19:Pe(Ue);break;case 10:Av(i.type._context);break;case 22:case 23:Fv()}t=t.return}if(ft=n,Je=n=Lr(n.current,null),Et=wn=e,st=0,Rc=null,bv=Lp=fa=0,rn=lc=null,to!==null){for(e=0;e<to.length;e++)if(t=to[e],i=t.interleaved,i!==null){t.interleaved=null;var s=i.next,r=t.pending;if(r!==null){var o=r.next;r.next=s,i.next=o}t.pending=i}to=null}return n}function vw(n,e){do{var t=Je;try{if(_v(),Vh.current=Bf,Gf){for(var i=Ve.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Gf=!1}if(ha=0,ht=it=Ve=null,oc=!1,Ic=0,Nv.current=null,t===null||t.return===null){st=1,Rc=e,Je=null;break}e:{var r=n,o=t.return,a=t,l=e;if(e=Et,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=a,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=o_(o);if(m!==null){m.flags&=-257,a_(m,o,a,r,e),m.mode&1&&r_(r,u,e),e=m,l=u;var y=e.updateQueue;if(y===null){var A=new Set;A.add(l),e.updateQueue=A}else y.add(l);break e}else{if(!(e&1)){r_(r,u,e),Uv();break e}l=Error(b(426))}}else if(be&&a.mode&1){var T=o_(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),a_(T,o,a,r,e),yv(pu(l,a));break e}}r=l=pu(l,a),st!==4&&(st=2),lc===null?lc=[r]:lc.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var _=tw(r,l,e);j0(r,_);break e;case 1:a=l;var E=r.type,C=r.stateNode;if(!(r.flags&128)&&(typeof E.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(br===null||!br.has(C)))){r.flags|=65536,e&=-e,r.lanes|=e;var I=nw(r,a,e);j0(r,I);break e}}r=r.return}while(r!==null)}Ew(t)}catch(x){e=x,Je===t&&t!==null&&(Je=t=t.return);continue}break}while(!0)}function _w(){var n=zf.current;return zf.current=Bf,n===null?Bf:n}function Uv(){(st===0||st===3||st===2)&&(st=4),ft===null||!(fa&268435455)&&!(Lp&268435455)||Ys(ft,Et)}function Wf(n,e){var t=de;de|=2;var i=_w();(ft!==n||Et!==e)&&(Qi=null,la(n,e));do try{yP();break}catch(s){vw(n,s)}while(!0);if(_v(),de=t,zf.current=i,Je!==null)throw Error(b(261));return ft=null,Et=0,st}function yP(){for(;Je!==null;)Aw(Je)}function vP(){for(;Je!==null&&!zI();)Aw(Je)}function Aw(n){var e=ww(n.alternate,n,wn);n.memoizedProps=n.pendingProps,e===null?Ew(n):Je=e,Nv.current=null}function Ew(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=dP(t,e),t!==null){t.flags&=32767,Je=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{st=6,Je=null;return}}else if(t=cP(t,e,wn),t!==null){Je=t;return}if(e=e.sibling,e!==null){Je=e;return}Je=e=n}while(e!==null);st===0&&(st=5)}function Kr(n,e,t){var i=_e,s=$n.transition;try{$n.transition=null,_e=1,_P(n,e,t,i)}finally{$n.transition=s,_e=i}return null}function _P(n,e,t,i){do Za();while(Ir!==null);if(de&6)throw Error(b(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(b(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(jI(n,r),n===ft&&(Je=ft=null,Et=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||xh||(xh=!0,Cw(xf,function(){return Za(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=$n.transition,$n.transition=null;var o=_e;_e=1;var a=de;de|=4,Nv.current=null,fP(n,t),gw(t,n),Vx(nm),Rf=!!tm,nm=tm=null,n.current=t,pP(t),qI(),de=a,_e=o,$n.transition=r}else n.current=t;if(xh&&(xh=!1,Ir=n,$f=s),r=n.pendingLanes,r===0&&(br=null),YI(t.stateNode),un(n,We()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],i(s.value,{componentStack:s.stack,digest:s.digest});if(qf)throw qf=!1,n=Sm,Sm=null,n;return $f&1&&n.tag!==0&&Za(),r=n.pendingLanes,r&1?n===wm?uc++:(uc=0,wm=n):uc=0,qr(),null}function Za(){if(Ir!==null){var n=tS($f),e=$n.transition,t=_e;try{if($n.transition=null,_e=16>n?16:n,Ir===null)var i=!1;else{if(n=Ir,Ir=null,$f=0,de&6)throw Error(b(331));var s=de;for(de|=4,B=n.current;B!==null;){var r=B,o=r.child;if(B.flags&16){var a=r.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(B=u;B!==null;){var h=B;switch(h.tag){case 0:case 11:case 15:ac(8,h,r)}var p=h.child;if(p!==null)p.return=h,B=p;else for(;B!==null;){h=B;var g=h.sibling,m=h.return;if(hw(h),h===u){B=null;break}if(g!==null){g.return=m,B=g;break}B=m}}}var y=r.alternate;if(y!==null){var A=y.child;if(A!==null){y.child=null;do{var T=A.sibling;A.sibling=null,A=T}while(A!==null)}}B=r}}if(r.subtreeFlags&2064&&o!==null)o.return=r,B=o;else e:for(;B!==null;){if(r=B,r.flags&2048)switch(r.tag){case 0:case 11:case 15:ac(9,r,r.return)}var _=r.sibling;if(_!==null){_.return=r.return,B=_;break e}B=r.return}}var E=n.current;for(B=E;B!==null;){o=B;var C=o.child;if(o.subtreeFlags&2064&&C!==null)C.return=o,B=C;else e:for(o=E;B!==null;){if(a=B,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Dp(9,a)}}catch(x){ze(a,a.return,x)}if(a===o){B=null;break e}var I=a.sibling;if(I!==null){I.return=a.return,B=I;break e}B=a.return}}if(de=s,qr(),qi&&typeof qi.onPostCommitFiberRoot=="function")try{qi.onPostCommitFiberRoot(Ip,n)}catch{}i=!0}return i}finally{_e=t,$n.transition=e}}return!1}function A_(n,e,t){e=pu(t,e),e=tw(n,e,1),n=Nr(n,e,1),e=qt(),n!==null&&(rh(n,1,e),un(n,e))}function ze(n,e,t){if(n.tag===3)A_(n,n,t);else for(;e!==null;){if(e.tag===3){A_(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(br===null||!br.has(i))){n=pu(t,n),n=nw(e,n,1),e=Nr(e,n,1),n=qt(),e!==null&&(rh(e,1,n),un(e,n));break}}e=e.return}}function AP(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=qt(),n.pingedLanes|=n.suspendedLanes&t,ft===n&&(Et&t)===t&&(st===4||st===3&&(Et&130023424)===Et&&500>We()-Dv?la(n,0):bv|=t),un(n,e)}function Sw(n,e){e===0&&(n.mode&1?(e=yh,yh<<=1,!(yh&130023424)&&(yh=4194304)):e=1);var t=qt();n=Ds(n,e),n!==null&&(rh(n,e,t),un(n,t))}function EP(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),Sw(n,t)}function SP(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(b(314))}i!==null&&i.delete(e),Sw(n,t)}var ww;ww=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||an.current)on=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return on=!1,uP(n,e,t);on=!!(n.flags&131072)}else on=!1,be&&e.flags&1048576&&xS(e,Ff,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Gh(n,e),n=e.pendingProps;var s=cu(e,Ft.current);Qa(e,t),s=xv(null,e,i,n,s,t);var r=Pv();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ln(i)?(r=!0,Df(e)):r=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Sv(e),s.updater=bp,e.stateNode=s,s._reactInternals=e,dm(e,i,n,t),e=pm(null,e,i,!0,r,t)):(e.tag=0,be&&r&&gv(e),zt(null,e,s,t),e=e.child),e;case 16:i=e.elementType;e:{switch(Gh(n,e),n=e.pendingProps,s=i._init,i=s(i._payload),e.type=i,s=e.tag=CP(i),n=Zn(i,n),s){case 0:e=fm(null,e,i,n,t);break e;case 1:e=c_(null,e,i,n,t);break e;case 11:e=l_(null,e,i,n,t);break e;case 14:e=u_(null,e,i,Zn(i.type,n),t);break e}throw Error(b(306,i,""))}return e;case 0:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Zn(i,s),fm(n,e,i,s,t);case 1:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Zn(i,s),c_(n,e,i,s,t);case 3:e:{if(ow(e),n===null)throw Error(b(387));i=e.pendingProps,r=e.memoizedState,s=r.element,bS(n,e),Vf(e,i,null,t);var o=e.memoizedState;if(i=o.element,r.isDehydrated)if(r={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){s=pu(Error(b(423)),e),e=d_(n,e,i,t,s);break e}else if(i!==s){s=pu(Error(b(424)),e),e=d_(n,e,i,t,s);break e}else for(In=kr(e.stateNode.containerInfo.firstChild),xn=e,be=!0,fi=null,t=kS(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(du(),i===s){e=Ls(n,e,t);break e}zt(n,e,i,t)}e=e.child}return e;case 5:return DS(e),n===null&&lm(e),i=e.type,s=e.pendingProps,r=n!==null?n.memoizedProps:null,o=s.children,im(i,s)?o=null:r!==null&&im(i,r)&&(e.flags|=32),rw(n,e),zt(n,e,o,t),e.child;case 6:return n===null&&lm(e),null;case 13:return aw(n,e,t);case 4:return wv(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=hu(e,null,i,t):zt(n,e,i,t),e.child;case 11:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Zn(i,s),l_(n,e,i,s,t);case 7:return zt(n,e,e.pendingProps,t),e.child;case 8:return zt(n,e,e.pendingProps.children,t),e.child;case 12:return zt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,s=e.pendingProps,r=e.memoizedProps,o=s.value,Ce(Uf,i._currentValue),i._currentValue=o,r!==null)if(yi(r.value,o)){if(r.children===s.children&&!an.current){e=Ls(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var a=r.dependencies;if(a!==null){o=r.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(r.tag===1){l=Rs(-1,t&-t),l.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}r.lanes|=t,l=r.alternate,l!==null&&(l.lanes|=t),um(r.return,t,e),a.lanes|=t;break}l=l.next}}else if(r.tag===10)o=r.type===e.type?null:r.child;else if(r.tag===18){if(o=r.return,o===null)throw Error(b(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),um(o,t,e),o=r.sibling}else o=r.child;if(o!==null)o.return=r;else for(o=r;o!==null;){if(o===e){o=null;break}if(r=o.sibling,r!==null){r.return=o.return,o=r;break}o=o.return}r=o}zt(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,i=e.pendingProps.children,Qa(e,t),s=Kn(s),i=i(s),e.flags|=1,zt(n,e,i,t),e.child;case 14:return i=e.type,s=Zn(i,e.pendingProps),s=Zn(i.type,s),u_(n,e,i,s,t);case 15:return iw(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Zn(i,s),Gh(n,e),e.tag=1,ln(i)?(n=!0,Df(e)):n=!1,Qa(e,t),ew(e,i,s),dm(e,i,s,t),pm(null,e,i,!0,n,t);case 19:return lw(n,e,t);case 22:return sw(n,e,t)}throw Error(b(156,e.tag))};function Cw(n,e){return QE(n,e)}function wP(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qn(n,e,t,i){return new wP(n,e,t,i)}function Hv(n){return n=n.prototype,!(!n||!n.isReactComponent)}function CP(n){if(typeof n=="function")return Hv(n)?1:0;if(n!=null){if(n=n.$$typeof,n===iv)return 11;if(n===sv)return 14}return 2}function Lr(n,e){var t=n.alternate;return t===null?(t=qn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function qh(n,e,t,i,s,r){var o=2;if(i=n,typeof n=="function")Hv(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case ba:return ua(t.children,s,r,e);case nv:o=8,s|=8;break;case Lg:return n=qn(12,t,e,s|2),n.elementType=Lg,n.lanes=r,n;case Fg:return n=qn(13,t,e,s),n.elementType=Fg,n.lanes=r,n;case Ug:return n=qn(19,t,e,s),n.elementType=Ug,n.lanes=r,n;case DE:return Fp(t,s,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case NE:o=10;break e;case bE:o=9;break e;case iv:o=11;break e;case sv:o=14;break e;case qs:o=16,i=null;break e}throw Error(b(130,n==null?n:typeof n,""))}return e=qn(o,t,e,s),e.elementType=n,e.type=i,e.lanes=r,e}function ua(n,e,t,i){return n=qn(7,n,i,e),n.lanes=t,n}function Fp(n,e,t,i){return n=qn(22,n,i,e),n.elementType=DE,n.lanes=t,n.stateNode={isHidden:!1},n}function Cg(n,e,t){return n=qn(6,n,null,e),n.lanes=t,n}function Tg(n,e,t){return e=qn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function TP(n,e,t,i,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rg(0),this.expirationTimes=rg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rg(0),this.identifierPrefix=i,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Vv(n,e,t,i,s,r,o,a,l){return n=new TP(n,e,t,a,l),e===1?(e=1,r===!0&&(e|=8)):e=0,r=qn(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Sv(r),n}function IP(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Na,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function Tw(n){if(!n)return Hr;n=n._reactInternals;e:{if(Aa(n)!==n||n.tag!==1)throw Error(b(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ln(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(b(171))}if(n.tag===1){var t=n.type;if(ln(t))return TS(n,t,e)}return e}function Iw(n,e,t,i,s,r,o,a,l){return n=Vv(t,i,!0,n,s,r,o,a,l),n.context=Tw(null),t=n.current,i=qt(),s=Dr(t),r=Rs(i,s),r.callback=e??null,Nr(t,r,s),n.current.lanes=s,rh(n,s,i),un(n,i),n}function Up(n,e,t,i){var s=e.current,r=qt(),o=Dr(s);return t=Tw(t),e.context===null?e.context=t:e.pendingContext=t,e=Rs(r,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=Nr(s,e,o),n!==null&&(mi(n,s,o,r),Hh(n,s,o)),o}function Yf(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function E_(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Ov(n,e){E_(n,e),(n=n.alternate)&&E_(n,e)}function xP(){return null}var xw=typeof reportError=="function"?reportError:function(n){console.error(n)};function Gv(n){this._internalRoot=n}Hp.prototype.render=Gv.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(b(409));Up(n,e,null,null)};Hp.prototype.unmount=Gv.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;pa(function(){Up(null,n,null,null)}),e[bs]=null}};function Hp(n){this._internalRoot=n}Hp.prototype.unstable_scheduleHydration=function(n){if(n){var e=sS();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Ws.length&&e!==0&&e<Ws[t].priority;t++);Ws.splice(t,0,n),t===0&&oS(n)}};function Bv(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Vp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function S_(){}function PP(n,e,t,i,s){if(s){if(typeof i=="function"){var r=i;i=function(){var u=Yf(o);r.call(u)}}var o=Iw(e,i,n,0,null,!1,!1,"",S_);return n._reactRootContainer=o,n[bs]=o.current,Ec(n.nodeType===8?n.parentNode:n),pa(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof i=="function"){var a=i;i=function(){var u=Yf(l);a.call(u)}}var l=Vv(n,0,!1,null,null,!1,!1,"",S_);return n._reactRootContainer=l,n[bs]=l.current,Ec(n.nodeType===8?n.parentNode:n),pa(function(){Up(e,l,t,i)}),l}function Op(n,e,t,i,s){var r=t._reactRootContainer;if(r){var o=r;if(typeof s=="function"){var a=s;s=function(){var l=Yf(o);a.call(l)}}Up(e,o,n,s)}else o=PP(t,e,n,s,i);return Yf(o)}nS=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Uu(e.pendingLanes);t!==0&&(av(e,t|1),un(e,We()),!(de&6)&&(gu=We()+500,qr()))}break;case 13:pa(function(){var i=Ds(n,1);if(i!==null){var s=qt();mi(i,n,1,s)}}),Ov(n,1)}};lv=function(n){if(n.tag===13){var e=Ds(n,134217728);if(e!==null){var t=qt();mi(e,n,134217728,t)}Ov(n,134217728)}};iS=function(n){if(n.tag===13){var e=Dr(n),t=Ds(n,e);if(t!==null){var i=qt();mi(t,n,e,i)}Ov(n,e)}};sS=function(){return _e};rS=function(n,e){var t=_e;try{return _e=n,e()}finally{_e=t}};Yg=function(n,e,t){switch(e){case"input":if(Og(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var s=Mp(i);if(!s)throw Error(b(90));FE(i),Og(i,s)}}}break;case"textarea":HE(n,t);break;case"select":e=t.value,e!=null&&Ya(n,!!t.multiple,e,!1)}};$E=Lv;WE=pa;var RP={usingClientEntryPoint:!1,Events:[ah,Ua,Mp,zE,qE,Lv]},Ru={findFiberByHostInstance:eo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},MP={bundleType:Ru.bundleType,version:Ru.version,rendererPackageName:Ru.rendererPackageName,rendererConfig:Ru.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vs.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=JE(n),n===null?null:n.stateNode},findFiberByHostInstance:Ru.findFiberByHostInstance||xP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ph=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ph.isDisabled&&Ph.supportsFiber)try{Ip=Ph.inject(MP),qi=Ph}catch{}}Mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RP;Mn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bv(e))throw Error(b(200));return IP(n,e,null,t)};Mn.createRoot=function(n,e){if(!Bv(n))throw Error(b(299));var t=!1,i="",s=xw;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Vv(n,1,!1,null,null,t,!1,i,s),n[bs]=e.current,Ec(n.nodeType===8?n.parentNode:n),new Gv(e)};Mn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(b(188)):(n=Object.keys(n).join(","),Error(b(268,n)));return n=JE(e),n=n===null?null:n.stateNode,n};Mn.flushSync=function(n){return pa(n)};Mn.hydrate=function(n,e,t){if(!Vp(e))throw Error(b(200));return Op(null,n,e,!0,t)};Mn.hydrateRoot=function(n,e,t){if(!Bv(n))throw Error(b(405));var i=t!=null&&t.hydratedSources||null,s=!1,r="",o=xw;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=Iw(e,null,n,1,t??null,s,!1,r,o),n[bs]=e.current,Ec(n),i)for(n=0;n<i.length;n++)t=i[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new Hp(e)};Mn.render=function(n,e,t){if(!Vp(e))throw Error(b(200));return Op(null,n,e,!1,t)};Mn.unmountComponentAtNode=function(n){if(!Vp(n))throw Error(b(40));return n._reactRootContainer?(pa(function(){Op(null,null,n,!1,function(){n._reactRootContainer=null,n[bs]=null})}),!0):!1};Mn.unstable_batchedUpdates=Lv;Mn.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!Vp(t))throw Error(b(200));if(n==null||n._reactInternals===void 0)throw Error(b(38));return Op(n,e,t,!1,i)};Mn.version="18.3.1-next-f1338f8080-20240426";function Pw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Pw)}catch(n){console.error(n)}}Pw(),PE.exports=Mn;var kP=PE.exports,w_=kP;bg.createRoot=w_.createRoot,bg.hydrateRoot=w_.hydrateRoot;const NP=({onDescriptionChange:n,description:e})=>D.jsxs("div",{className:"flex flex-col h-full",children:[D.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-700",children:"1. Installation beschreiben"}),D.jsx("textarea",{value:e,onChange:t=>n(t.target.value),placeholder:"Beschreiben Sie die Elektroinstallation hier. Nennen Sie Details wie verwendete Komponenten, Verlegeart, Umgebung etc.",className:"w-full flex-grow bg-gray-50 rounded-lg p-4 text-gray-800 border border-gray-300 focus:ring-2 focus:ring-[#88bd24] focus:border-[#88bd24] transition-colors",rows:10,"aria-label":"Beschreibung der Elektroinstallation"})]}),bP=n=>D.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:D.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),DP=n=>D.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:D.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})}),LP=({files:n,onFilesChange:e,isParsing:t})=>{const i=r=>{if(r.target.files){const o=Array.from(r.target.files),l=[...n,...o].filter((u,h,p)=>h===p.findIndex(g=>g.name===u.name&&g.size===u.size));e(l),r.target.value=""}},s=r=>{e(n.filter(o=>o!==r))};return D.jsxs("div",{children:[D.jsx("h2",{className:"text-xl font-semibold my-4 text-gray-700",children:"2. Wissensbasis hinzufgen (Optional)"}),D.jsxs("div",{className:"flex flex-col gap-4",children:[D.jsxs("label",{htmlFor:"pdf-upload",className:"relative cursor-pointer w-full flex items-center justify-center gap-3 px-6 py-3 rounded-lg font-semibold text-white transition-all duration-300 ease-in-out bg-[#88bd24] hover:bg-[#79a820]",children:[D.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:D.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 16.5V9.75m0 0l-3.75 3.75M12 9.75l3.75 3.75M3 17.25V21h18v-3.75"})}),D.jsx("span",{children:"PDF-Dateien auswhlen"})]}),D.jsx("input",{id:"pdf-upload",type:"file",multiple:!0,accept:".pdf",onChange:i,className:"hidden",disabled:t}),t&&D.jsx("div",{className:"text-center text-gray-500",children:D.jsx("p",{children:"Verarbeite PDFs..."})}),n.length>0&&D.jsxs("div",{className:"flex flex-col gap-2",children:[D.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Hochgeladene Dokumente:"}),D.jsx("ul",{className:"space-y-2",children:n.map((r,o)=>D.jsxs("li",{className:"flex items-center justify-between bg-white p-2 rounded-md border border-gray-200",children:[D.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[D.jsx(DP,{className:"w-5 h-5 text-[#88bd24] flex-shrink-0"}),D.jsx("span",{className:"truncate text-sm text-gray-800",title:r.name,children:r.name})]}),D.jsx("button",{onClick:()=>s(r),className:"p-1 text-gray-400 hover:text-red-600 transition-colors rounded-full","aria-label":`Remove ${r.name}`,children:D.jsx(bP,{className:"w-5 h-5"})})]},`${r.name}-${o}`))})]})]})]})},FP=()=>{const[n,e]=nt.useState(!1),t=nt.useCallback(async i=>{if(!(navigator!=null&&navigator.clipboard))return console.warn("Clipboard not supported"),!1;try{return await navigator.clipboard.writeText(i),e(!0),!0}catch(s){return console.warn("Copy failed",s),e(!1),!1}},[]);return nt.useEffect(()=>{if(n){const i=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(i)}},[n]),[n,t]},UP=({result:n,isLoading:e})=>{const[t,i]=FP(),s=()=>{n&&i(n)},r=()=>{if(e)return D.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[D.jsxs("svg",{className:"animate-spin h-8 w-8 text-[#88bd24] mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[D.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),D.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),D.jsx("p",{className:"font-semibold text-gray-700",children:"Analysiere Beschreibung..."}),D.jsx("p",{className:"text-sm",children:"Dies kann einen Moment dauern."})]});if(!n)return D.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:D.jsx("p",{children:"Das Analyseergebnis wird hier angezeigt."})});const o=n.split("**").map((a,l)=>l%2===1?D.jsx("strong",{className:"font-semibold text-[#88bd24]",children:a},l):a);return D.jsx("div",{className:"whitespace-pre-wrap prose prose-sm max-w-none text-gray-800",children:o})};return D.jsxs("div",{className:"relative flex-grow flex flex-col bg-gray-50 rounded-lg p-4 h-96 overflow-y-auto",children:[n&&!e&&D.jsx("div",{className:"absolute top-3 right-3",children:D.jsx("button",{onClick:s,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md bg-gray-200 hover:bg-gray-300 text-gray-700 transition-colors",children:t?"Kopiert!":"Kopieren"})}),D.jsx("div",{className:"flex-grow",children:r()})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let HP,VP;function OP(){return{geminiUrl:HP,vertexUrl:VP}}function GP(n,e,t,i){var s,r;if(!(n!=null&&n.baseUrl)){const o=OP();return e?(s=o.vertexUrl)!==null&&s!==void 0?s:t:(r=o.geminiUrl)!==null&&r!==void 0?r:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Os{}function V(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const r=e[s];return r!=null?String(r):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function f(n,e,t){for(let r=0;r<e.length-1;r++){const o=e[r];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in n))if(Array.isArray(t))n[a]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[a])){const l=n[a];if(Array.isArray(t))for(let u=0;u<l.length;u++){const h=l[u];f(h,e.slice(r+1),t[u])}else for(const u of l)f(u,e.slice(r+1),t)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in n||(n[a]=[{}]);const l=n[a];f(l[0],e.slice(r+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const i=e[e.length-1],s=n[i];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function d(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const s=e[i];if(s.endsWith("[]")){const r=s.slice(0,-2);if(r in n){const o=n[r];return Array.isArray(o)?o.map(a=>d(a,e.slice(i+1),t)):t}else return t}else n=n[s]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function BP(n,e){for(const[t,i]of Object.entries(e)){const s=t.split("."),r=i.split("."),o=new Set;let a=-1;for(let l=0;l<s.length;l++)if(s[l]==="*"){a=l;break}if(a!==-1&&r.length>a)for(let l=a;l<r.length;l++){const u=r[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}Im(n,s,r,0,o)}}function Im(n,e,t,i,s){if(i>=e.length||typeof n!="object"||n===null)return;const r=e[i];if(r.endsWith("[]")){const o=r.slice(0,-2),a=n;if(o in a&&Array.isArray(a[o]))for(const l of a[o])Im(l,e,t,i+1,s)}else if(r==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const o=n,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!s.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,h]of Object.entries(l)){const p=[];for(const g of t.slice(i))g==="*"?p.push(u):p.push(g);f(o,p,h)}for(const u of a)delete o[u]}}else{const o=n;r in o&&Im(o[r],e,t,i+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zv(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zP(n){const e={},t=d(n,["operationName"]);t!=null&&f(e,["operationName"],t);const i=d(n,["resourceName"]);return i!=null&&f(e,["_url","resourceName"],i),e}function qP(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response","generateVideoResponse"]);return o!=null&&f(e,["response"],WP(o)),e}function $P(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response"]);return o!=null&&f(e,["response"],YP(o)),e}function WP(n){const e={},t=d(n,["generatedSamples"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>KP(o))),f(e,["generatedVideos"],r)}const i=d(n,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const s=d(n,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function YP(n){const e={},t=d(n,["videos"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>JP(o))),f(e,["generatedVideos"],r)}const i=d(n,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const s=d(n,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function KP(n){const e={},t=d(n,["video"]);return t!=null&&f(e,["video"],tR(t)),e}function JP(n){const e={},t=d(n,["_self"]);return t!=null&&f(e,["video"],nR(t)),e}function XP(n){const e={},t=d(n,["operationName"]);return t!=null&&f(e,["_url","operationName"],t),e}function QP(n){const e={},t=d(n,["operationName"]);return t!=null&&f(e,["_url","operationName"],t),e}function ZP(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response"]);return o!=null&&f(e,["response"],jP(o)),e}function jP(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["parent"]);i!=null&&f(e,["parent"],i);const s=d(n,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function Rw(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response"]);return o!=null&&f(e,["response"],eR(o)),e}function eR(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["parent"]);i!=null&&f(e,["parent"],i);const s=d(n,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function tR(n){const e={},t=d(n,["uri"]);t!=null&&f(e,["uri"],t);const i=d(n,["encodedVideo"]);i!=null&&f(e,["videoBytes"],zv(i));const s=d(n,["encoding"]);return s!=null&&f(e,["mimeType"],s),e}function nR(n){const e={},t=d(n,["gcsUri"]);t!=null&&f(e,["uri"],t);const i=d(n,["bytesBase64Encoded"]);i!=null&&f(e,["videoBytes"],zv(i));const s=d(n,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var C_;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(C_||(C_={}));var T_;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(T_||(T_={}));var I_;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(I_||(I_={}));var xr;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(xr||(xr={}));var x_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(x_||(x_={}));var P_;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(P_||(P_={}));var R_;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(R_||(R_={}));var M_;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(M_||(M_={}));var k_;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(k_||(k_={}));var N_;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(N_||(N_={}));var b_;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(b_||(b_={}));var D_;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(D_||(D_={}));var L_;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(L_||(L_={}));var F_;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(F_||(F_={}));var U_;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(U_||(U_={}));var H_;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(H_||(H_={}));var V_;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(V_||(V_={}));var O_;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(O_||(O_={}));var G_;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(G_||(G_={}));var Kf;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Kf||(Kf={}));var B_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(B_||(B_={}));var z_;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(z_||(z_={}));var q_;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(q_||(q_={}));var xm;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(xm||(xm={}));var $_;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})($_||($_={}));var W_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(W_||(W_={}));var Y_;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(Y_||(Y_={}));var K_;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(K_||(K_={}));var J_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(J_||(J_={}));var X_;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(X_||(X_={}));var Q_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(Q_||(Q_={}));var Z_;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Z_||(Z_={}));var j_;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(j_||(j_={}));var eA;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(eA||(eA={}));var tA;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(tA||(tA={}));var nA;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(nA||(nA={}));var iA;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(iA||(iA={}));var sA;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(sA||(sA={}));var rA;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(rA||(rA={}));var oA;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(oA||(oA={}));var aA;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(aA||(aA={}));var lA;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(lA||(lA={}));var uA;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(uA||(uA={}));var cA;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(cA||(cA={}));var dA;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(dA||(dA={}));var hA;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(hA||(hA={}));var fA;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(fA||(fA={}));var pA;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(pA||(pA={}));var gA;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(gA||(gA={}));var mA;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(mA||(mA={}));var yA;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(yA||(yA={}));var vA;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(vA||(vA={}));var _A;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(_A||(_A={}));var AA;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(AA||(AA={}));var qa;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(qa||(qa={}));class Pm{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Mu{get text(){var e,t,i,s,r,o,a,l;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",h=!1;const p=[];for(const g of(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[m,y]of Object.entries(g))m!=="text"&&m!=="thought"&&m!=="thoughtSignature"&&(y!==null||y!==void 0)&&p.push(m);if(typeof g.text=="string"){if(typeof g.thought=="boolean"&&g.thought)continue;h=!0,u+=g.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?u:void 0}get data(){var e,t,i,s,r,o,a,l;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const h=[];for(const p of(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,m]of Object.entries(p))g!=="inlineData"&&(m!==null||m!==void 0)&&h.push(g);p.inlineData&&typeof p.inlineData.data=="string"&&(u+=atob(p.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,t,i,s,r,o,a,l;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,t,i,s,r,o,a,l,u;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,t,i,s,r,o,a,l,u;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.output}}class EA{}class SA{}class iR{}class sR{}class rR{}class oR{}class wA{}class CA{}class TA{}class aR{}class Jf{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Jf;let s;const r=e;return t?s=$P(r):s=qP(r),Object.assign(i,s),i}}class IA{}class xA{}class PA{}class lR{}class uR{}class cR{}class qv{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new qv,r=ZP(e);return Object.assign(i,r),i}}class dR{}class hR{}class fR{}class RA{}class pR{get text(){var e,t,i;let s="",r=!1;const o=[];for(const a of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;r=!0,s+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?s:void 0}get data(){var e,t,i;let s="";const r=[];for(const o of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&r.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class gR{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class $v{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new $v,r=Rw(e);return Object.assign(i,r),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pe(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Mw(n,e){const t=pe(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function kw(n){return Array.isArray(n)?n.map(e=>Xf(e)):[Xf(n)]}function Xf(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function Nw(n){const e=Xf(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function bw(n){const e=Xf(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function MA(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function Dw(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>MA(e)):[MA(n)]}function Rm(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function kA(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function NA(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Lt(n){if(n==null)throw new Error("ContentUnion is required");return Rm(n)?n:{role:"user",parts:Dw(n)}}function Wv(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=Lt(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=Lt(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Lt(t)):[Lt(e)]}function Wn(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(kA(n)||NA(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Lt(n)]}const e=[],t=[],i=Rm(n[0]);for(const s of n){const r=Rm(s);if(r!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(r)e.push(s);else{if(kA(s)||NA(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return i||e.push({role:"user",parts:Dw(t)}),e}function mR(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(xr).includes(t[0].toUpperCase())?t[0].toUpperCase():xr.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(xr).includes(i.toUpperCase())?i.toUpperCase():xr.TYPE_UNSPECIFIED})}}function ja(n){const e={},t=["items"],i=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=n.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(e.nullable=!0,n=r[1]):r[1].type==="null"&&(e.nullable=!0,n=r[0])),n.type instanceof Array&&mR(n.type,e);for(const[o,a]of Object.entries(n))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(xr).includes(a.toUpperCase())?a.toUpperCase():xr.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=ja(a);else if(i.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(ja(u))}e[o]=l}else if(s.includes(o)){const l={};for(const[u,h]of Object.entries(a))l[u]=ja(h);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function Yv(n){return ja(n)}function Kv(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Jv(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function _u(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=ja(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=ja(e.response));return n}function Au(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function yR(n,e,t,i=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Gs(n,e){if(typeof e!="string")throw new Error("name must be a string");return yR(n,e,"cachedContents")}function Lw(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function $r(n){return zv(n)}function vR(n){return n!=null&&typeof n=="object"&&"name"in n}function _R(n){return n!=null&&typeof n=="object"&&"video"in n}function AR(n){return n!=null&&typeof n=="object"&&"uri"in n}function Fw(n){var e;let t;if(vR(n)&&(t=n.name),!(AR(n)&&(t=n.uri,t===void 0))&&!(_R(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function Uw(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function Hw(n){for(const e of["models","tunedModels","publisherModels"])if(ER(n,e))return n[e];return[]}function ER(n,e){return n!==null&&typeof n=="object"&&e in n}function SR(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function wR(n,e={}){const t=[],i=new Set;for(const s of n){const r=s.name;if(i.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);i.add(r);const o=SR(s,e);o.functionDeclarations&&t.push(...o.functionDeclarations)}return{functionDeclarations:t}}function Vw(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,s=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(s>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function CR(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Ow(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const s=t.inlinedResponses;if(!Array.isArray(s)||s.length===0)return n;let r=!1;for(const o of s){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){r=!0;break}}return r&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Eu(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function Gw(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TR(n){const e={},t=d(n,["responsesFile"]);t!=null&&f(e,["fileName"],t);const i=d(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>rM(o))),f(e,["inlinedResponses"],r)}const s=d(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["inlinedEmbedContentResponses"],r)}return e}function IR(n){const e={},t=d(n,["predictionsFormat"]);t!=null&&f(e,["format"],t);const i=d(n,["gcsDestination","outputUriPrefix"]);i!=null&&f(e,["gcsUri"],i);const s=d(n,["bigqueryDestination","outputUri"]);return s!=null&&f(e,["bigqueryUri"],s),e}function xR(n){const e={},t=d(n,["format"]);t!=null&&f(e,["predictionsFormat"],t);const i=d(n,["gcsUri"]);i!=null&&f(e,["gcsDestination","outputUriPrefix"],i);const s=d(n,["bigqueryUri"]);if(s!=null&&f(e,["bigqueryDestination","outputUri"],s),d(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(d(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function $h(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata","displayName"]);i!=null&&f(e,["displayName"],i);const s=d(n,["metadata","state"]);s!=null&&f(e,["state"],Gw(s));const r=d(n,["metadata","createTime"]);r!=null&&f(e,["createTime"],r);const o=d(n,["metadata","endTime"]);o!=null&&f(e,["endTime"],o);const a=d(n,["metadata","updateTime"]);a!=null&&f(e,["updateTime"],a);const l=d(n,["metadata","model"]);l!=null&&f(e,["model"],l);const u=d(n,["metadata","output"]);return u!=null&&f(e,["dest"],TR(Ow(u))),e}function Mm(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["displayName"]);i!=null&&f(e,["displayName"],i);const s=d(n,["state"]);s!=null&&f(e,["state"],Gw(s));const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["createTime"]);o!=null&&f(e,["createTime"],o);const a=d(n,["startTime"]);a!=null&&f(e,["startTime"],a);const l=d(n,["endTime"]);l!=null&&f(e,["endTime"],l);const u=d(n,["updateTime"]);u!=null&&f(e,["updateTime"],u);const h=d(n,["model"]);h!=null&&f(e,["model"],h);const p=d(n,["inputConfig"]);p!=null&&f(e,["src"],PR(p));const g=d(n,["outputConfig"]);g!=null&&f(e,["dest"],IR(Ow(g)));const m=d(n,["completionStats"]);return m!=null&&f(e,["completionStats"],m),e}function PR(n){const e={},t=d(n,["instancesFormat"]);t!=null&&f(e,["format"],t);const i=d(n,["gcsSource","uris"]);i!=null&&f(e,["gcsUri"],i);const s=d(n,["bigquerySource","inputUri"]);return s!=null&&f(e,["bigqueryUri"],s),e}function RR(n,e){const t={};if(d(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=d(e,["fileName"]);i!=null&&f(t,["fileName"],i);const s=d(e,["inlinedRequests"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>sM(n,o))),f(t,["requests","requests"],r)}return t}function MR(n){const e={},t=d(n,["format"]);t!=null&&f(e,["instancesFormat"],t);const i=d(n,["gcsUri"]);i!=null&&f(e,["gcsSource","uris"],i);const s=d(n,["bigqueryUri"]);if(s!=null&&f(e,["bigquerySource","inputUri"],s),d(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function kR(n){const e={},t=d(n,["data"]);if(t!=null&&f(e,["data"],t),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function NR(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Eu(n,i)),t}function bR(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Eu(n,i)),t}function DR(n){const e={},t=d(n,["content"]);t!=null&&f(e,["content"],t);const i=d(n,["citationMetadata"]);i!=null&&f(e,["citationMetadata"],LR(i));const s=d(n,["tokenCount"]);s!=null&&f(e,["tokenCount"],s);const r=d(n,["finishReason"]);r!=null&&f(e,["finishReason"],r);const o=d(n,["avgLogprobs"]);o!=null&&f(e,["avgLogprobs"],o);const a=d(n,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const l=d(n,["index"]);l!=null&&f(e,["index"],l);const u=d(n,["logprobsResult"]);u!=null&&f(e,["logprobsResult"],u);const h=d(n,["safetyRatings"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(m=>m)),f(e,["safetyRatings"],g)}const p=d(n,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],p),e}function LR(n){const e={},t=d(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),f(e,["citations"],i)}return e}function Bw(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>hM(r))),f(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&f(e,["role"],i),e}function FR(n,e){const t={},i=d(n,["displayName"]);if(e!==void 0&&i!=null&&f(e,["batch","displayName"],i),d(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function UR(n,e){const t={},i=d(n,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const s=d(n,["dest"]);return e!==void 0&&s!=null&&f(e,["outputConfig"],xR(CR(s))),t}function bA(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["src"]);s!=null&&f(t,["batch","inputConfig"],RR(n,Vw(n,s)));const r=d(e,["config"]);return r!=null&&FR(r,t),t}function HR(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["model"],pe(n,i));const s=d(e,["src"]);s!=null&&f(t,["inputConfig"],MR(Vw(n,s)));const r=d(e,["config"]);return r!=null&&UR(r,t),t}function VR(n,e){const t={},i=d(n,["displayName"]);return e!==void 0&&i!=null&&f(e,["batch","displayName"],i),t}function OR(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["src"]);s!=null&&f(t,["batch","inputConfig"],YR(n,s));const r=d(e,["config"]);return r!=null&&VR(r,t),t}function GR(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Eu(n,i)),t}function BR(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Eu(n,i)),t}function zR(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["name"]);i!=null&&f(e,["name"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);return r!=null&&f(e,["error"],r),e}function qR(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["name"]);i!=null&&f(e,["name"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);return r!=null&&f(e,["error"],r),e}function $R(n,e){const t={},i=d(e,["contents"]);if(i!=null){let r=Wv(n,i);Array.isArray(r)&&(r=r.map(o=>o)),f(t,["requests[]","request","content"],r)}const s=d(e,["config"]);return s!=null&&(f(t,["_self"],WR(s,t)),BP(t,{"requests[].*":"requests[].request.*"})),t}function WR(n,e){const t={},i=d(n,["taskType"]);e!==void 0&&i!=null&&f(e,["requests[]","taskType"],i);const s=d(n,["title"]);e!==void 0&&s!=null&&f(e,["requests[]","title"],s);const r=d(n,["outputDimensionality"]);if(e!==void 0&&r!=null&&f(e,["requests[]","outputDimensionality"],r),d(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function YR(n,e){const t={},i=d(e,["fileName"]);i!=null&&f(t,["file_name"],i);const s=d(e,["inlinedRequests"]);return s!=null&&f(t,["requests"],$R(n,s)),t}function KR(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function JR(n){const e={},t=d(n,["id"]);t!=null&&f(e,["id"],t);const i=d(n,["args"]);i!=null&&f(e,["args"],i);const s=d(n,["name"]);if(s!=null&&f(e,["name"],s),d(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function XR(n){const e={},t=d(n,["mode"]);t!=null&&f(e,["mode"],t);const i=d(n,["allowedFunctionNames"]);if(i!=null&&f(e,["allowedFunctionNames"],i),d(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function QR(n,e,t){const i={},s=d(e,["systemInstruction"]);t!==void 0&&s!=null&&f(t,["systemInstruction"],Bw(Lt(s)));const r=d(e,["temperature"]);r!=null&&f(i,["temperature"],r);const o=d(e,["topP"]);o!=null&&f(i,["topP"],o);const a=d(e,["topK"]);a!=null&&f(i,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&f(i,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&f(i,["maxOutputTokens"],u);const h=d(e,["stopSequences"]);h!=null&&f(i,["stopSequences"],h);const p=d(e,["responseLogprobs"]);p!=null&&f(i,["responseLogprobs"],p);const g=d(e,["logprobs"]);g!=null&&f(i,["logprobs"],g);const m=d(e,["presencePenalty"]);m!=null&&f(i,["presencePenalty"],m);const y=d(e,["frequencyPenalty"]);y!=null&&f(i,["frequencyPenalty"],y);const A=d(e,["seed"]);A!=null&&f(i,["seed"],A);const T=d(e,["responseMimeType"]);T!=null&&f(i,["responseMimeType"],T);const _=d(e,["responseSchema"]);_!=null&&f(i,["responseSchema"],Yv(_));const E=d(e,["responseJsonSchema"]);if(E!=null&&f(i,["responseJsonSchema"],E),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=d(e,["safetySettings"]);if(t!==void 0&&C!=null){let Y=C;Array.isArray(Y)&&(Y=Y.map(ie=>fM(ie))),f(t,["safetySettings"],Y)}const I=d(e,["tools"]);if(t!==void 0&&I!=null){let Y=Au(I);Array.isArray(Y)&&(Y=Y.map(ie=>gM(_u(ie)))),f(t,["tools"],Y)}const x=d(e,["toolConfig"]);if(t!==void 0&&x!=null&&f(t,["toolConfig"],pM(x)),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=d(e,["cachedContent"]);t!==void 0&&R!=null&&f(t,["cachedContent"],Gs(n,R));const P=d(e,["responseModalities"]);P!=null&&f(i,["responseModalities"],P);const M=d(e,["mediaResolution"]);M!=null&&f(i,["mediaResolution"],M);const k=d(e,["speechConfig"]);if(k!=null&&f(i,["speechConfig"],Kv(k)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=d(e,["thinkingConfig"]);N!=null&&f(i,["thinkingConfig"],N);const L=d(e,["imageConfig"]);return L!=null&&f(i,["imageConfig"],iM(L)),i}function ZR(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["candidates"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>DR(u))),f(e,["candidates"],l)}const s=d(n,["modelVersion"]);s!=null&&f(e,["modelVersion"],s);const r=d(n,["promptFeedback"]);r!=null&&f(e,["promptFeedback"],r);const o=d(n,["responseId"]);o!=null&&f(e,["responseId"],o);const a=d(n,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function jR(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Eu(n,i)),t}function eM(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Eu(n,i)),t}function tM(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=d(n,["enableWidget"]);return t!=null&&f(e,["enableWidget"],t),e}function nM(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=d(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],t),e}function iM(n){const e={},t=d(n,["aspectRatio"]);t!=null&&f(e,["aspectRatio"],t);const i=d(n,["imageSize"]);if(i!=null&&f(e,["imageSize"],i),d(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function sM(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["request","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let a=Wn(s);Array.isArray(a)&&(a=a.map(l=>Bw(l))),f(t,["request","contents"],a)}const r=d(e,["metadata"]);r!=null&&f(t,["metadata"],r);const o=d(e,["config"]);return o!=null&&f(t,["request","generationConfig"],QR(n,o,d(t,["request"],{}))),t}function rM(n){const e={},t=d(n,["response"]);t!=null&&f(e,["response"],ZR(t));const i=d(n,["error"]);return i!=null&&f(e,["error"],i),e}function oM(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);if(e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),d(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function aM(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);e!==void 0&&s!=null&&f(e,["_query","pageToken"],s);const r=d(n,["filter"]);return e!==void 0&&r!=null&&f(e,["_query","filter"],r),t}function lM(n){const e={},t=d(n,["config"]);return t!=null&&oM(t,e),e}function uM(n){const e={},t=d(n,["config"]);return t!=null&&aM(t,e),e}function cM(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["operations"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>$h(o))),f(e,["batchJobs"],r)}return e}function dM(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["batchPredictionJobs"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>Mm(o))),f(e,["batchJobs"],r)}return e}function hM(n){const e={},t=d(n,["mediaResolution"]);t!=null&&f(e,["mediaResolution"],t);const i=d(n,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const s=d(n,["executableCode"]);s!=null&&f(e,["executableCode"],s);const r=d(n,["fileData"]);r!=null&&f(e,["fileData"],KR(r));const o=d(n,["functionCall"]);o!=null&&f(e,["functionCall"],JR(o));const a=d(n,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(n,["inlineData"]);l!=null&&f(e,["inlineData"],kR(l));const u=d(n,["text"]);u!=null&&f(e,["text"],u);const h=d(n,["thought"]);h!=null&&f(e,["thought"],h);const p=d(n,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const g=d(n,["videoMetadata"]);return g!=null&&f(e,["videoMetadata"],g),e}function fM(n){const e={},t=d(n,["category"]);if(t!=null&&f(e,["category"],t),d(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=d(n,["threshold"]);return i!=null&&f(e,["threshold"],i),e}function pM(n){const e={},t=d(n,["functionCallingConfig"]);t!=null&&f(e,["functionCallingConfig"],XR(t));const i=d(n,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],i),e}function gM(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=d(n,["computerUse"]);s!=null&&f(e,["computerUse"],s);const r=d(n,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(n,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(n,["googleMaps"]);a!=null&&f(e,["googleMaps"],tM(a));const l=d(n,["googleSearch"]);l!=null&&f(e,["googleSearch"],nM(l));const u=d(n,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Fs;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(Fs||(Fs={}));class Ea{constructor(e,t,i,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,s)}init(e,t,i){var s,r;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!i||Object.keys(i).length===0?o={config:{}}:typeof i=="object"?o=Object.assign({},i):o=i,o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(r=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mM extends Os{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)},this.list=async(t={})=>new Ea(Fs.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=bA(this.apiClient,e),i=t._url,s=V("{model}:batchGenerateContent",i),a=t.batch.inputConfig.requests,l=a.requests,u=[];for(const h of l){const p=Object.assign({},h);if(p.systemInstruction){const g=p.systemInstruction;delete p.systemInstruction;const m=p.request;m.systemInstruction=g,p.request=m}u.push(p)}return a.requests=u,delete t.config,delete t._url,delete t._query,{path:s,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},s=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${s}`),i.dest===void 0){const r=this.getGcsUri(e),o=this.getBigqueryUri(e);if(r)r.endsWith(".jsonl")?i.dest=`${r.slice(0,-6)}/dest`:i.dest=`${r}_dest_${s}`;else if(o)i.dest=`${o}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=HR(this.apiClient,e);return a=V("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>Mm(h))}else{const u=bA(this.apiClient,e);return a=V("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>$h(h))}}async createEmbeddingsInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=OR(this.apiClient,e);return r=V("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>$h(l))}}async get(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=eM(this.apiClient,e);return a=V("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>Mm(h))}else{const u=jR(this.apiClient,e);return a=V("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>$h(h))}}async cancel(e){var t,i,s,r;let o="",a={};if(this.apiClient.isVertexAI()){const l=bR(this.apiClient,e);o=V("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const l=NR(this.apiClient,e);o=V("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=uM(e);return a=V("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=dM(h),g=new RA;return Object.assign(g,p),g})}else{const u=lM(e);return a=V("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=cM(h),g=new RA;return Object.assign(g,p),g})}}async delete(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=BR(this.apiClient,e);return a=V("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>qR(h))}else{const u=GR(this.apiClient,e);return a=V("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>zR(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yM(n){const e={},t=d(n,["data"]);if(t!=null&&f(e,["data"],t),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function DA(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>OM(r))),f(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&f(e,["role"],i),e}function vM(n,e){const t={},i=d(n,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const s=d(n,["expireTime"]);e!==void 0&&s!=null&&f(e,["expireTime"],s);const r=d(n,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const o=d(n,["contents"]);if(e!==void 0&&o!=null){let h=Wn(o);Array.isArray(h)&&(h=h.map(p=>DA(p))),f(e,["contents"],h)}const a=d(n,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],DA(Lt(a)));const l=d(n,["tools"]);if(e!==void 0&&l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>BM(p))),f(e,["tools"],h)}const u=d(n,["toolConfig"]);if(e!==void 0&&u!=null&&f(e,["toolConfig"],GM(u)),d(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function _M(n,e){const t={},i=d(n,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const s=d(n,["expireTime"]);e!==void 0&&s!=null&&f(e,["expireTime"],s);const r=d(n,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const o=d(n,["contents"]);if(e!==void 0&&o!=null){let p=Wn(o);Array.isArray(p)&&(p=p.map(g=>g)),f(e,["contents"],p)}const a=d(n,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],Lt(a));const l=d(n,["tools"]);if(e!==void 0&&l!=null){let p=l;Array.isArray(p)&&(p=p.map(g=>zM(g))),f(e,["tools"],p)}const u=d(n,["toolConfig"]);e!==void 0&&u!=null&&f(e,["toolConfig"],u);const h=d(n,["kmsKeyName"]);return e!==void 0&&h!=null&&f(e,["encryption_spec","kmsKeyName"],h),t}function AM(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["model"],Mw(n,i));const s=d(e,["config"]);return s!=null&&vM(s,t),t}function EM(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["model"],Mw(n,i));const s=d(e,["config"]);return s!=null&&_M(s,t),t}function SM(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Gs(n,i)),t}function wM(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Gs(n,i)),t}function CM(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}function TM(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}function IM(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function xM(n){const e={},t=d(n,["id"]);t!=null&&f(e,["id"],t);const i=d(n,["args"]);i!=null&&f(e,["args"],i);const s=d(n,["name"]);if(s!=null&&f(e,["name"],s),d(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function PM(n){const e={},t=d(n,["mode"]);t!=null&&f(e,["mode"],t);const i=d(n,["allowedFunctionNames"]);if(i!=null&&f(e,["allowedFunctionNames"],i),d(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function RM(n){const e={};if(d(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=d(n,["description"]);t!=null&&f(e,["description"],t);const i=d(n,["name"]);i!=null&&f(e,["name"],i);const s=d(n,["parameters"]);s!=null&&f(e,["parameters"],s);const r=d(n,["parametersJsonSchema"]);r!=null&&f(e,["parametersJsonSchema"],r);const o=d(n,["response"]);o!=null&&f(e,["response"],o);const a=d(n,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function MM(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Gs(n,i)),t}function kM(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Gs(n,i)),t}function NM(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=d(n,["enableWidget"]);return t!=null&&f(e,["enableWidget"],t),e}function bM(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=d(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],t),e}function DM(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),t}function LM(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),t}function FM(n){const e={},t=d(n,["config"]);return t!=null&&DM(t,e),e}function UM(n){const e={},t=d(n,["config"]);return t!=null&&LM(t,e),e}function HM(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["cachedContents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["cachedContents"],r)}return e}function VM(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["cachedContents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["cachedContents"],r)}return e}function OM(n){const e={},t=d(n,["mediaResolution"]);t!=null&&f(e,["mediaResolution"],t);const i=d(n,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const s=d(n,["executableCode"]);s!=null&&f(e,["executableCode"],s);const r=d(n,["fileData"]);r!=null&&f(e,["fileData"],IM(r));const o=d(n,["functionCall"]);o!=null&&f(e,["functionCall"],xM(o));const a=d(n,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(n,["inlineData"]);l!=null&&f(e,["inlineData"],yM(l));const u=d(n,["text"]);u!=null&&f(e,["text"],u);const h=d(n,["thought"]);h!=null&&f(e,["thought"],h);const p=d(n,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const g=d(n,["videoMetadata"]);return g!=null&&f(e,["videoMetadata"],g),e}function GM(n){const e={},t=d(n,["functionCallingConfig"]);t!=null&&f(e,["functionCallingConfig"],PM(t));const i=d(n,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],i),e}function BM(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=d(n,["computerUse"]);s!=null&&f(e,["computerUse"],s);const r=d(n,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(n,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(n,["googleMaps"]);a!=null&&f(e,["googleMaps"],NM(a));const l=d(n,["googleSearch"]);l!=null&&f(e,["googleSearch"],bM(l));const u=d(n,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function zM(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(g=>RM(g))),f(e,["functionDeclarations"],p)}const i=d(n,["retrieval"]);i!=null&&f(e,["retrieval"],i);const s=d(n,["googleSearchRetrieval"]);s!=null&&f(e,["googleSearchRetrieval"],s);const r=d(n,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),d(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=d(n,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const a=d(n,["enterpriseWebSearch"]);a!=null&&f(e,["enterpriseWebSearch"],a);const l=d(n,["googleMaps"]);l!=null&&f(e,["googleMaps"],l);const u=d(n,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const h=d(n,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function qM(n,e){const t={},i=d(n,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const s=d(n,["expireTime"]);return e!==void 0&&s!=null&&f(e,["expireTime"],s),t}function $M(n,e){const t={},i=d(n,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const s=d(n,["expireTime"]);return e!==void 0&&s!=null&&f(e,["expireTime"],s),t}function WM(n,e){const t={},i=d(e,["name"]);i!=null&&f(t,["_url","name"],Gs(n,i));const s=d(e,["config"]);return s!=null&&qM(s,t),t}function YM(n,e){const t={},i=d(e,["name"]);i!=null&&f(t,["_url","name"],Gs(n,i));const s=d(e,["config"]);return s!=null&&$M(s,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class KM extends Os{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ea(Fs.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=EM(this.apiClient,e);return a=V("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>h)}else{const u=AM(this.apiClient,e);return a=V("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>h)}}async get(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=kM(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>h)}else{const u=MM(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>h)}}async delete(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=wM(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=TM(h),g=new xA;return Object.assign(g,p),g})}else{const u=SM(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=CM(h),g=new xA;return Object.assign(g,p),g})}}async update(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=YM(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>h)}else{const u=WM(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>h)}}async listInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=UM(e);return a=V("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=VM(h),g=new PA;return Object.assign(g,p),g})}else{const u=FM(e);return a=V("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=HM(h),g=new PA;return Object.assign(g,p),g})}}}function LA(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xe(n){return this instanceof xe?(this.v=n,this):new xe(n)}function el(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),s,r=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(y){return Promise.resolve(y).then(m,p)}}function a(m,y){i[m]&&(s[m]=function(A){return new Promise(function(T,_){r.push([m,A,T,_])>1||l(m,A)})},y&&(s[m]=y(s[m])))}function l(m,y){try{u(i[m](y))}catch(A){g(r[0][3],A)}}function u(m){m.value instanceof xe?Promise.resolve(m.value.v).then(h,p):g(r[0][2],m)}function h(m){l("next",m)}function p(m){l("throw",m)}function g(m,y){m(y),r.shift(),r.length&&l(r[0][0],r[0][1])}}function cc(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof LA=="function"?LA(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=n[r]&&function(o){return new Promise(function(a,l){o=n[r](o),s(a,l,o.done,o.value)})}}function s(r,o,a,l){Promise.resolve(l).then(function(u){r({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JM(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:zw(t)}function zw(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function XM(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function FA(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const s=[];let r=!0;for(;i<t&&n[i].role==="model";)s.push(n[i]),r&&!zw(n[i])&&(r=!1),i++;r?e.push(...s):e.pop()}return e}class QM{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new ZM(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class ZM{constructor(e,t,i,s={},r=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=s,this.history=r,this.sendPromise=Promise.resolve(),XM(r)}async sendMessage(e){var t;await this.sendPromise;const i=Lt(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var r,o,a;const l=await s,u=(o=(r=l.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content,h=l.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let g=[];h!=null&&(g=(a=h.slice(p))!==null&&a!==void 0?a:[]);const m=u?[u]:[];this.recordHistory(i,m,g)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const i=Lt(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const r=await s;return this.processStreamResponse(r,i)}getHistory(e=!1){const t=e?FA(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,s;return el(this,arguments,function*(){var o,a,l,u;const h=[];try{for(var p=!0,g=cc(e),m;m=yield xe(g.next()),o=m.done,!o;p=!0){u=m.value,p=!1;const y=u;if(JM(y)){const A=(s=(i=y.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content;A!==void 0&&h.push(A)}yield yield xe(y)}}catch(y){a={error:y}}finally{try{!p&&!o&&(l=g.return)&&(yield xe(l.call(g)))}finally{if(a)throw a.error}}this.recordHistory(t,h)})}recordHistory(e,t,i){let s=[];t.length>0&&t.every(r=>r.role!==void 0)?s=t:s.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...FA(i)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gp extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Gp.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jM(n){const e={},t=d(n,["file"]);return t!=null&&f(e,["file"],t),e}function e1(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}function t1(n){const e={},t=d(n,["name"]);return t!=null&&f(e,["_url","file"],Fw(t)),e}function n1(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}function i1(n){const e={},t=d(n,["name"]);return t!=null&&f(e,["_url","file"],Fw(t)),e}function s1(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),t}function r1(n){const e={},t=d(n,["config"]);return t!=null&&s1(t,e),e}function o1(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["files"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["files"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class a1 extends Os{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ea(Fs.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=r1(e);return r=V("files",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>{const u=o1(l),h=new dR;return Object.assign(h,u),h})}}async createInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=jM(e);return r=V("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=e1(l),h=new hR;return Object.assign(h,u),h})}}async get(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=i1(e);return r=V("files/{file}",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>l)}}async delete(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=t1(e);return r=V("files/{file}",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>{const u=n1(l),h=new fR;return Object.assign(h,u),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wh(n){const e={},t=d(n,["data"]);if(t!=null&&f(e,["data"],t),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function l1(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>C1(r))),f(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&f(e,["role"],i),e}function u1(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function c1(n){const e={},t=d(n,["id"]);t!=null&&f(e,["id"],t);const i=d(n,["args"]);i!=null&&f(e,["args"],i);const s=d(n,["name"]);if(s!=null&&f(e,["name"],s),d(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function d1(n){const e={};if(d(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=d(n,["description"]);t!=null&&f(e,["description"],t);const i=d(n,["name"]);i!=null&&f(e,["name"],i);const s=d(n,["parameters"]);s!=null&&f(e,["parameters"],s);const r=d(n,["parametersJsonSchema"]);r!=null&&f(e,["parametersJsonSchema"],r);const o=d(n,["response"]);o!=null&&f(e,["response"],o);const a=d(n,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function h1(n){const e={},t=d(n,["modelSelectionConfig"]);t!=null&&f(e,["modelConfig"],t);const i=d(n,["responseJsonSchema"]);i!=null&&f(e,["responseJsonSchema"],i);const s=d(n,["audioTimestamp"]);s!=null&&f(e,["audioTimestamp"],s);const r=d(n,["candidateCount"]);r!=null&&f(e,["candidateCount"],r);const o=d(n,["enableAffectiveDialog"]);o!=null&&f(e,["enableAffectiveDialog"],o);const a=d(n,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const l=d(n,["logprobs"]);l!=null&&f(e,["logprobs"],l);const u=d(n,["maxOutputTokens"]);u!=null&&f(e,["maxOutputTokens"],u);const h=d(n,["mediaResolution"]);h!=null&&f(e,["mediaResolution"],h);const p=d(n,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const g=d(n,["responseLogprobs"]);g!=null&&f(e,["responseLogprobs"],g);const m=d(n,["responseMimeType"]);m!=null&&f(e,["responseMimeType"],m);const y=d(n,["responseModalities"]);y!=null&&f(e,["responseModalities"],y);const A=d(n,["responseSchema"]);A!=null&&f(e,["responseSchema"],A);const T=d(n,["routingConfig"]);T!=null&&f(e,["routingConfig"],T);const _=d(n,["seed"]);_!=null&&f(e,["seed"],_);const E=d(n,["speechConfig"]);E!=null&&f(e,["speechConfig"],qw(E));const C=d(n,["stopSequences"]);C!=null&&f(e,["stopSequences"],C);const I=d(n,["temperature"]);I!=null&&f(e,["temperature"],I);const x=d(n,["thinkingConfig"]);x!=null&&f(e,["thinkingConfig"],x);const R=d(n,["topK"]);R!=null&&f(e,["topK"],R);const P=d(n,["topP"]);if(P!=null&&f(e,["topP"],P),d(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function f1(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=d(n,["enableWidget"]);return t!=null&&f(e,["enableWidget"],t),e}function p1(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=d(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],t),e}function g1(n,e){const t={},i=d(n,["generationConfig"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig"],i);const s=d(n,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const r=d(n,["temperature"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig","temperature"],r);const o=d(n,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=d(n,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(n,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(n,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const h=d(n,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=d(n,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],Jv(p));const g=d(n,["thinkingConfig"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","thinkingConfig"],g);const m=d(n,["enableAffectiveDialog"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],m);const y=d(n,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],l1(Lt(y)));const A=d(n,["tools"]);if(e!==void 0&&A!=null){let R=Au(A);Array.isArray(R)&&(R=R.map(P=>I1(_u(P)))),f(e,["setup","tools"],R)}const T=d(n,["sessionResumption"]);e!==void 0&&T!=null&&f(e,["setup","sessionResumption"],T1(T));const _=d(n,["inputAudioTranscription"]);e!==void 0&&_!=null&&f(e,["setup","inputAudioTranscription"],_);const E=d(n,["outputAudioTranscription"]);e!==void 0&&E!=null&&f(e,["setup","outputAudioTranscription"],E);const C=d(n,["realtimeInputConfig"]);e!==void 0&&C!=null&&f(e,["setup","realtimeInputConfig"],C);const I=d(n,["contextWindowCompression"]);e!==void 0&&I!=null&&f(e,["setup","contextWindowCompression"],I);const x=d(n,["proactivity"]);return e!==void 0&&x!=null&&f(e,["setup","proactivity"],x),t}function m1(n,e){const t={},i=d(n,["generationConfig"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig"],h1(i));const s=d(n,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const r=d(n,["temperature"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig","temperature"],r);const o=d(n,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=d(n,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(n,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(n,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const h=d(n,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=d(n,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],qw(Jv(p)));const g=d(n,["thinkingConfig"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","thinkingConfig"],g);const m=d(n,["enableAffectiveDialog"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],m);const y=d(n,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],Lt(y));const A=d(n,["tools"]);if(e!==void 0&&A!=null){let R=Au(A);Array.isArray(R)&&(R=R.map(P=>x1(_u(P)))),f(e,["setup","tools"],R)}const T=d(n,["sessionResumption"]);e!==void 0&&T!=null&&f(e,["setup","sessionResumption"],T);const _=d(n,["inputAudioTranscription"]);e!==void 0&&_!=null&&f(e,["setup","inputAudioTranscription"],_);const E=d(n,["outputAudioTranscription"]);e!==void 0&&E!=null&&f(e,["setup","outputAudioTranscription"],E);const C=d(n,["realtimeInputConfig"]);e!==void 0&&C!=null&&f(e,["setup","realtimeInputConfig"],C);const I=d(n,["contextWindowCompression"]);e!==void 0&&I!=null&&f(e,["setup","contextWindowCompression"],I);const x=d(n,["proactivity"]);return e!==void 0&&x!=null&&f(e,["setup","proactivity"],x),t}function y1(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["setup","model"],pe(n,i));const s=d(e,["config"]);return s!=null&&f(t,["config"],g1(s,t)),t}function v1(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["setup","model"],pe(n,i));const s=d(e,["config"]);return s!=null&&f(t,["config"],m1(s,t)),t}function _1(n){const e={},t=d(n,["musicGenerationConfig"]);return t!=null&&f(e,["musicGenerationConfig"],t),e}function A1(n){const e={},t=d(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),f(e,["weightedPrompts"],i)}return e}function E1(n){const e={},t=d(n,["media"]);if(t!=null){let u=kw(t);Array.isArray(u)&&(u=u.map(h=>Wh(h))),f(e,["mediaChunks"],u)}const i=d(n,["audio"]);i!=null&&f(e,["audio"],Wh(bw(i)));const s=d(n,["audioStreamEnd"]);s!=null&&f(e,["audioStreamEnd"],s);const r=d(n,["video"]);r!=null&&f(e,["video"],Wh(Nw(r)));const o=d(n,["text"]);o!=null&&f(e,["text"],o);const a=d(n,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=d(n,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function S1(n){const e={},t=d(n,["media"]);if(t!=null){let u=kw(t);Array.isArray(u)&&(u=u.map(h=>h)),f(e,["mediaChunks"],u)}const i=d(n,["audio"]);i!=null&&f(e,["audio"],bw(i));const s=d(n,["audioStreamEnd"]);s!=null&&f(e,["audioStreamEnd"],s);const r=d(n,["video"]);r!=null&&f(e,["video"],Nw(r));const o=d(n,["text"]);o!=null&&f(e,["text"],o);const a=d(n,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=d(n,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function w1(n){const e={},t=d(n,["setupComplete"]);t!=null&&f(e,["setupComplete"],t);const i=d(n,["serverContent"]);i!=null&&f(e,["serverContent"],i);const s=d(n,["toolCall"]);s!=null&&f(e,["toolCall"],s);const r=d(n,["toolCallCancellation"]);r!=null&&f(e,["toolCallCancellation"],r);const o=d(n,["usageMetadata"]);o!=null&&f(e,["usageMetadata"],P1(o));const a=d(n,["goAway"]);a!=null&&f(e,["goAway"],a);const l=d(n,["sessionResumptionUpdate"]);return l!=null&&f(e,["sessionResumptionUpdate"],l),e}function C1(n){const e={},t=d(n,["mediaResolution"]);t!=null&&f(e,["mediaResolution"],t);const i=d(n,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const s=d(n,["executableCode"]);s!=null&&f(e,["executableCode"],s);const r=d(n,["fileData"]);r!=null&&f(e,["fileData"],u1(r));const o=d(n,["functionCall"]);o!=null&&f(e,["functionCall"],c1(o));const a=d(n,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(n,["inlineData"]);l!=null&&f(e,["inlineData"],Wh(l));const u=d(n,["text"]);u!=null&&f(e,["text"],u);const h=d(n,["thought"]);h!=null&&f(e,["thought"],h);const p=d(n,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const g=d(n,["videoMetadata"]);return g!=null&&f(e,["videoMetadata"],g),e}function T1(n){const e={},t=d(n,["handle"]);if(t!=null&&f(e,["handle"],t),d(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function qw(n){const e={},t=d(n,["languageCode"]);t!=null&&f(e,["languageCode"],t);const i=d(n,["voiceConfig"]);if(i!=null&&f(e,["voiceConfig"],i),d(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function I1(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=d(n,["computerUse"]);s!=null&&f(e,["computerUse"],s);const r=d(n,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(n,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(n,["googleMaps"]);a!=null&&f(e,["googleMaps"],f1(a));const l=d(n,["googleSearch"]);l!=null&&f(e,["googleSearch"],p1(l));const u=d(n,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function x1(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(g=>d1(g))),f(e,["functionDeclarations"],p)}const i=d(n,["retrieval"]);i!=null&&f(e,["retrieval"],i);const s=d(n,["googleSearchRetrieval"]);s!=null&&f(e,["googleSearchRetrieval"],s);const r=d(n,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),d(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=d(n,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const a=d(n,["enterpriseWebSearch"]);a!=null&&f(e,["enterpriseWebSearch"],a);const l=d(n,["googleMaps"]);l!=null&&f(e,["googleMaps"],l);const u=d(n,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const h=d(n,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function P1(n){const e={},t=d(n,["promptTokenCount"]);t!=null&&f(e,["promptTokenCount"],t);const i=d(n,["cachedContentTokenCount"]);i!=null&&f(e,["cachedContentTokenCount"],i);const s=d(n,["candidatesTokenCount"]);s!=null&&f(e,["responseTokenCount"],s);const r=d(n,["toolUsePromptTokenCount"]);r!=null&&f(e,["toolUsePromptTokenCount"],r);const o=d(n,["thoughtsTokenCount"]);o!=null&&f(e,["thoughtsTokenCount"],o);const a=d(n,["totalTokenCount"]);a!=null&&f(e,["totalTokenCount"],a);const l=d(n,["promptTokensDetails"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(y=>y)),f(e,["promptTokensDetails"],m)}const u=d(n,["cacheTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(y=>y)),f(e,["cacheTokensDetails"],m)}const h=d(n,["candidatesTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(y=>y)),f(e,["responseTokensDetails"],m)}const p=d(n,["toolUsePromptTokensDetails"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(y=>y)),f(e,["toolUsePromptTokensDetails"],m)}const g=d(n,["trafficType"]);return g!=null&&f(e,["trafficType"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function R1(n){const e={},t=d(n,["data"]);if(t!=null&&f(e,["data"],t),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function M1(n){const e={},t=d(n,["content"]);t!=null&&f(e,["content"],t);const i=d(n,["citationMetadata"]);i!=null&&f(e,["citationMetadata"],k1(i));const s=d(n,["tokenCount"]);s!=null&&f(e,["tokenCount"],s);const r=d(n,["finishReason"]);r!=null&&f(e,["finishReason"],r);const o=d(n,["avgLogprobs"]);o!=null&&f(e,["avgLogprobs"],o);const a=d(n,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const l=d(n,["index"]);l!=null&&f(e,["index"],l);const u=d(n,["logprobsResult"]);u!=null&&f(e,["logprobsResult"],u);const h=d(n,["safetyRatings"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(m=>m)),f(e,["safetyRatings"],g)}const p=d(n,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],p),e}function k1(n){const e={},t=d(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),f(e,["citations"],i)}return e}function N1(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let r=Wn(s);Array.isArray(r)&&(r=r.map(o=>o)),f(t,["contents"],r)}return t}function b1(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["tokensInfo"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>r)),f(e,["tokensInfo"],s)}return e}function D1(n){const e={},t=d(n,["values"]);t!=null&&f(e,["values"],t);const i=d(n,["statistics"]);return i!=null&&f(e,["statistics"],L1(i)),e}function L1(n){const e={},t=d(n,["truncated"]);t!=null&&f(e,["truncated"],t);const i=d(n,["token_count"]);return i!=null&&f(e,["tokenCount"],i),e}function Bp(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>qk(r))),f(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&f(e,["role"],i),e}function F1(n){const e={},t=d(n,["controlType"]);t!=null&&f(e,["controlType"],t);const i=d(n,["enableControlImageComputation"]);return i!=null&&f(e,["computeControl"],i),e}function U1(n){const e={};if(d(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function H1(n,e){const t={},i=d(n,["systemInstruction"]);e!==void 0&&i!=null&&f(e,["systemInstruction"],Lt(i));const s=d(n,["tools"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Jw(a))),f(e,["tools"],o)}const r=d(n,["generationConfig"]);return e!==void 0&&r!=null&&f(e,["generationConfig"],Rk(r)),t}function V1(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let o=Wn(s);Array.isArray(o)&&(o=o.map(a=>Bp(a))),f(t,["contents"],o)}const r=d(e,["config"]);return r!=null&&U1(r),t}function O1(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let o=Wn(s);Array.isArray(o)&&(o=o.map(a=>a)),f(t,["contents"],o)}const r=d(e,["config"]);return r!=null&&H1(r,t),t}function G1(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["totalTokens"]);i!=null&&f(e,["totalTokens"],i);const s=d(n,["cachedContentTokenCount"]);return s!=null&&f(e,["cachedContentTokenCount"],s),e}function B1(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["totalTokens"]);return i!=null&&f(e,["totalTokens"],i),e}function z1(n,e){const t={},i=d(e,["model"]);return i!=null&&f(t,["_url","name"],pe(n,i)),t}function q1(n,e){const t={},i=d(e,["model"]);return i!=null&&f(t,["_url","name"],pe(n,i)),t}function $1(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}function W1(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}function Y1(n,e){const t={},i=d(n,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const s=d(n,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const r=d(n,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const o=d(n,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const a=d(n,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const l=d(n,["seed"]);e!==void 0&&l!=null&&f(e,["parameters","seed"],l);const u=d(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const h=d(n,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=d(n,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const g=d(n,["includeRaiReason"]);e!==void 0&&g!=null&&f(e,["parameters","includeRaiReason"],g);const m=d(n,["language"]);e!==void 0&&m!=null&&f(e,["parameters","language"],m);const y=d(n,["outputMimeType"]);e!==void 0&&y!=null&&f(e,["parameters","outputOptions","mimeType"],y);const A=d(n,["outputCompressionQuality"]);e!==void 0&&A!=null&&f(e,["parameters","outputOptions","compressionQuality"],A);const T=d(n,["addWatermark"]);e!==void 0&&T!=null&&f(e,["parameters","addWatermark"],T);const _=d(n,["labels"]);e!==void 0&&_!=null&&f(e,["labels"],_);const E=d(n,["editMode"]);e!==void 0&&E!=null&&f(e,["parameters","editMode"],E);const C=d(n,["baseSteps"]);return e!==void 0&&C!=null&&f(e,["parameters","editConfig","baseSteps"],C),t}function K1(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["prompt"]);s!=null&&f(t,["instances[0]","prompt"],s);const r=d(e,["referenceImages"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>Xk(l))),f(t,["instances[0]","referenceImages"],a)}const o=d(e,["config"]);return o!=null&&Y1(o,t),t}function J1(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>zp(r))),f(e,["generatedImages"],s)}return e}function X1(n,e){const t={},i=d(n,["taskType"]);e!==void 0&&i!=null&&f(e,["requests[]","taskType"],i);const s=d(n,["title"]);e!==void 0&&s!=null&&f(e,["requests[]","title"],s);const r=d(n,["outputDimensionality"]);if(e!==void 0&&r!=null&&f(e,["requests[]","outputDimensionality"],r),d(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function Q1(n,e){const t={},i=d(n,["taskType"]);e!==void 0&&i!=null&&f(e,["instances[]","task_type"],i);const s=d(n,["title"]);e!==void 0&&s!=null&&f(e,["instances[]","title"],s);const r=d(n,["outputDimensionality"]);e!==void 0&&r!=null&&f(e,["parameters","outputDimensionality"],r);const o=d(n,["mimeType"]);e!==void 0&&o!=null&&f(e,["instances[]","mimeType"],o);const a=d(n,["autoTruncate"]);return e!==void 0&&a!=null&&f(e,["parameters","autoTruncate"],a),t}function Z1(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let a=Wv(n,s);Array.isArray(a)&&(a=a.map(l=>l)),f(t,["requests[]","content"],a)}const r=d(e,["config"]);r!=null&&X1(r,t);const o=d(e,["model"]);return o!==void 0&&f(t,["requests[]","model"],pe(n,o)),t}function j1(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let o=Wv(n,s);Array.isArray(o)&&(o=o.map(a=>a)),f(t,["instances[]","content"],o)}const r=d(e,["config"]);return r!=null&&Q1(r,t),t}function ek(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["embeddings"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["embeddings"],r)}const s=d(n,["metadata"]);return s!=null&&f(e,["metadata"],s),e}function tk(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["predictions[]","embeddings"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>D1(o))),f(e,["embeddings"],r)}const s=d(n,["metadata"]);return s!=null&&f(e,["metadata"],s),e}function nk(n){const e={},t=d(n,["endpoint"]);t!=null&&f(e,["name"],t);const i=d(n,["deployedModelId"]);return i!=null&&f(e,["deployedModelId"],i),e}function ik(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function sk(n){const e={},t=d(n,["id"]);t!=null&&f(e,["id"],t);const i=d(n,["args"]);i!=null&&f(e,["args"],i);const s=d(n,["name"]);if(s!=null&&f(e,["name"],s),d(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function rk(n){const e={},t=d(n,["mode"]);t!=null&&f(e,["mode"],t);const i=d(n,["allowedFunctionNames"]);if(i!=null&&f(e,["allowedFunctionNames"],i),d(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function ok(n){const e={};if(d(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=d(n,["description"]);t!=null&&f(e,["description"],t);const i=d(n,["name"]);i!=null&&f(e,["name"],i);const s=d(n,["parameters"]);s!=null&&f(e,["parameters"],s);const r=d(n,["parametersJsonSchema"]);r!=null&&f(e,["parametersJsonSchema"],r);const o=d(n,["response"]);o!=null&&f(e,["response"],o);const a=d(n,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function ak(n,e,t){const i={},s=d(e,["systemInstruction"]);t!==void 0&&s!=null&&f(t,["systemInstruction"],Bp(Lt(s)));const r=d(e,["temperature"]);r!=null&&f(i,["temperature"],r);const o=d(e,["topP"]);o!=null&&f(i,["topP"],o);const a=d(e,["topK"]);a!=null&&f(i,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&f(i,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&f(i,["maxOutputTokens"],u);const h=d(e,["stopSequences"]);h!=null&&f(i,["stopSequences"],h);const p=d(e,["responseLogprobs"]);p!=null&&f(i,["responseLogprobs"],p);const g=d(e,["logprobs"]);g!=null&&f(i,["logprobs"],g);const m=d(e,["presencePenalty"]);m!=null&&f(i,["presencePenalty"],m);const y=d(e,["frequencyPenalty"]);y!=null&&f(i,["frequencyPenalty"],y);const A=d(e,["seed"]);A!=null&&f(i,["seed"],A);const T=d(e,["responseMimeType"]);T!=null&&f(i,["responseMimeType"],T);const _=d(e,["responseSchema"]);_!=null&&f(i,["responseSchema"],Yv(_));const E=d(e,["responseJsonSchema"]);if(E!=null&&f(i,["responseJsonSchema"],E),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=d(e,["safetySettings"]);if(t!==void 0&&C!=null){let Y=C;Array.isArray(Y)&&(Y=Y.map(ie=>Qk(ie))),f(t,["safetySettings"],Y)}const I=d(e,["tools"]);if(t!==void 0&&I!=null){let Y=Au(I);Array.isArray(Y)&&(Y=Y.map(ie=>sN(_u(ie)))),f(t,["tools"],Y)}const x=d(e,["toolConfig"]);if(t!==void 0&&x!=null&&f(t,["toolConfig"],iN(x)),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=d(e,["cachedContent"]);t!==void 0&&R!=null&&f(t,["cachedContent"],Gs(n,R));const P=d(e,["responseModalities"]);P!=null&&f(i,["responseModalities"],P);const M=d(e,["mediaResolution"]);M!=null&&f(i,["mediaResolution"],M);const k=d(e,["speechConfig"]);if(k!=null&&f(i,["speechConfig"],Kv(k)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=d(e,["thinkingConfig"]);N!=null&&f(i,["thinkingConfig"],N);const L=d(e,["imageConfig"]);return L!=null&&f(i,["imageConfig"],Dk(L)),i}function lk(n,e,t){const i={},s=d(e,["systemInstruction"]);t!==void 0&&s!=null&&f(t,["systemInstruction"],Lt(s));const r=d(e,["temperature"]);r!=null&&f(i,["temperature"],r);const o=d(e,["topP"]);o!=null&&f(i,["topP"],o);const a=d(e,["topK"]);a!=null&&f(i,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&f(i,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&f(i,["maxOutputTokens"],u);const h=d(e,["stopSequences"]);h!=null&&f(i,["stopSequences"],h);const p=d(e,["responseLogprobs"]);p!=null&&f(i,["responseLogprobs"],p);const g=d(e,["logprobs"]);g!=null&&f(i,["logprobs"],g);const m=d(e,["presencePenalty"]);m!=null&&f(i,["presencePenalty"],m);const y=d(e,["frequencyPenalty"]);y!=null&&f(i,["frequencyPenalty"],y);const A=d(e,["seed"]);A!=null&&f(i,["seed"],A);const T=d(e,["responseMimeType"]);T!=null&&f(i,["responseMimeType"],T);const _=d(e,["responseSchema"]);_!=null&&f(i,["responseSchema"],Yv(_));const E=d(e,["responseJsonSchema"]);E!=null&&f(i,["responseJsonSchema"],E);const C=d(e,["routingConfig"]);C!=null&&f(i,["routingConfig"],C);const I=d(e,["modelSelectionConfig"]);I!=null&&f(i,["modelConfig"],I);const x=d(e,["safetySettings"]);if(t!==void 0&&x!=null){let F=x;Array.isArray(F)&&(F=F.map($=>$)),f(t,["safetySettings"],F)}const R=d(e,["tools"]);if(t!==void 0&&R!=null){let F=Au(R);Array.isArray(F)&&(F=F.map($=>Jw(_u($)))),f(t,["tools"],F)}const P=d(e,["toolConfig"]);t!==void 0&&P!=null&&f(t,["toolConfig"],P);const M=d(e,["labels"]);t!==void 0&&M!=null&&f(t,["labels"],M);const k=d(e,["cachedContent"]);t!==void 0&&k!=null&&f(t,["cachedContent"],Gs(n,k));const N=d(e,["responseModalities"]);N!=null&&f(i,["responseModalities"],N);const L=d(e,["mediaResolution"]);L!=null&&f(i,["mediaResolution"],L);const Y=d(e,["speechConfig"]);Y!=null&&f(i,["speechConfig"],Kw(Kv(Y)));const ie=d(e,["audioTimestamp"]);ie!=null&&f(i,["audioTimestamp"],ie);const se=d(e,["thinkingConfig"]);se!=null&&f(i,["thinkingConfig"],se);const De=d(e,["imageConfig"]);return De!=null&&f(i,["imageConfig"],Lk(De)),i}function UA(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let o=Wn(s);Array.isArray(o)&&(o=o.map(a=>Bp(a))),f(t,["contents"],o)}const r=d(e,["config"]);return r!=null&&f(t,["generationConfig"],ak(n,r,t)),t}function HA(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let o=Wn(s);Array.isArray(o)&&(o=o.map(a=>a)),f(t,["contents"],o)}const r=d(e,["config"]);return r!=null&&f(t,["generationConfig"],lk(n,r,t)),t}function VA(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["candidates"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>M1(u))),f(e,["candidates"],l)}const s=d(n,["modelVersion"]);s!=null&&f(e,["modelVersion"],s);const r=d(n,["promptFeedback"]);r!=null&&f(e,["promptFeedback"],r);const o=d(n,["responseId"]);o!=null&&f(e,["responseId"],o);const a=d(n,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function OA(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["candidates"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(h=>h)),f(e,["candidates"],u)}const s=d(n,["createTime"]);s!=null&&f(e,["createTime"],s);const r=d(n,["modelVersion"]);r!=null&&f(e,["modelVersion"],r);const o=d(n,["promptFeedback"]);o!=null&&f(e,["promptFeedback"],o);const a=d(n,["responseId"]);a!=null&&f(e,["responseId"],a);const l=d(n,["usageMetadata"]);return l!=null&&f(e,["usageMetadata"],l),e}function uk(n,e){const t={};if(d(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=d(n,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const s=d(n,["aspectRatio"]);e!==void 0&&s!=null&&f(e,["parameters","aspectRatio"],s);const r=d(n,["guidanceScale"]);if(e!==void 0&&r!=null&&f(e,["parameters","guidanceScale"],r),d(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=d(n,["safetyFilterLevel"]);e!==void 0&&o!=null&&f(e,["parameters","safetySetting"],o);const a=d(n,["personGeneration"]);e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a);const l=d(n,["includeSafetyAttributes"]);e!==void 0&&l!=null&&f(e,["parameters","includeSafetyAttributes"],l);const u=d(n,["includeRaiReason"]);e!==void 0&&u!=null&&f(e,["parameters","includeRaiReason"],u);const h=d(n,["language"]);e!==void 0&&h!=null&&f(e,["parameters","language"],h);const p=d(n,["outputMimeType"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","mimeType"],p);const g=d(n,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&f(e,["parameters","outputOptions","compressionQuality"],g),d(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const m=d(n,["imageSize"]);if(e!==void 0&&m!=null&&f(e,["parameters","sampleImageSize"],m),d(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function ck(n,e){const t={},i=d(n,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const s=d(n,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const r=d(n,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const o=d(n,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const a=d(n,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const l=d(n,["seed"]);e!==void 0&&l!=null&&f(e,["parameters","seed"],l);const u=d(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const h=d(n,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=d(n,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const g=d(n,["includeRaiReason"]);e!==void 0&&g!=null&&f(e,["parameters","includeRaiReason"],g);const m=d(n,["language"]);e!==void 0&&m!=null&&f(e,["parameters","language"],m);const y=d(n,["outputMimeType"]);e!==void 0&&y!=null&&f(e,["parameters","outputOptions","mimeType"],y);const A=d(n,["outputCompressionQuality"]);e!==void 0&&A!=null&&f(e,["parameters","outputOptions","compressionQuality"],A);const T=d(n,["addWatermark"]);e!==void 0&&T!=null&&f(e,["parameters","addWatermark"],T);const _=d(n,["labels"]);e!==void 0&&_!=null&&f(e,["labels"],_);const E=d(n,["imageSize"]);e!==void 0&&E!=null&&f(e,["parameters","sampleImageSize"],E);const C=d(n,["enhancePrompt"]);return e!==void 0&&C!=null&&f(e,["parameters","enhancePrompt"],C),t}function dk(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["prompt"]);s!=null&&f(t,["instances[0]","prompt"],s);const r=d(e,["config"]);return r!=null&&uk(r,t),t}function hk(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["prompt"]);s!=null&&f(t,["instances[0]","prompt"],s);const r=d(e,["config"]);return r!=null&&ck(r,t),t}function fk(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>Tk(o))),f(e,["generatedImages"],r)}const s=d(n,["positivePromptSafetyAttributes"]);return s!=null&&f(e,["positivePromptSafetyAttributes"],Ww(s)),e}function pk(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>zp(o))),f(e,["generatedImages"],r)}const s=d(n,["positivePromptSafetyAttributes"]);return s!=null&&f(e,["positivePromptSafetyAttributes"],Yw(s)),e}function gk(n,e){const t={},i=d(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i),d(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=d(n,["durationSeconds"]);if(e!==void 0&&s!=null&&f(e,["parameters","durationSeconds"],s),d(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const r=d(n,["aspectRatio"]);e!==void 0&&r!=null&&f(e,["parameters","aspectRatio"],r);const o=d(n,["resolution"]);e!==void 0&&o!=null&&f(e,["parameters","resolution"],o);const a=d(n,["personGeneration"]);if(e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a),d(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=d(n,["negativePrompt"]);e!==void 0&&l!=null&&f(e,["parameters","negativePrompt"],l);const u=d(n,["enhancePrompt"]);if(e!==void 0&&u!=null&&f(e,["parameters","enhancePrompt"],u),d(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const h=d(n,["lastFrame"]);e!==void 0&&h!=null&&f(e,["instances[0]","lastFrame"],qp(h));const p=d(n,["referenceImages"]);if(e!==void 0&&p!=null){let g=p;Array.isArray(g)&&(g=g.map(m=>yN(m))),f(e,["instances[0]","referenceImages"],g)}if(d(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(d(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function mk(n,e){const t={},i=d(n,["numberOfVideos"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const s=d(n,["outputGcsUri"]);e!==void 0&&s!=null&&f(e,["parameters","storageUri"],s);const r=d(n,["fps"]);e!==void 0&&r!=null&&f(e,["parameters","fps"],r);const o=d(n,["durationSeconds"]);e!==void 0&&o!=null&&f(e,["parameters","durationSeconds"],o);const a=d(n,["seed"]);e!==void 0&&a!=null&&f(e,["parameters","seed"],a);const l=d(n,["aspectRatio"]);e!==void 0&&l!=null&&f(e,["parameters","aspectRatio"],l);const u=d(n,["resolution"]);e!==void 0&&u!=null&&f(e,["parameters","resolution"],u);const h=d(n,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=d(n,["pubsubTopic"]);e!==void 0&&p!=null&&f(e,["parameters","pubsubTopic"],p);const g=d(n,["negativePrompt"]);e!==void 0&&g!=null&&f(e,["parameters","negativePrompt"],g);const m=d(n,["enhancePrompt"]);e!==void 0&&m!=null&&f(e,["parameters","enhancePrompt"],m);const y=d(n,["generateAudio"]);e!==void 0&&y!=null&&f(e,["parameters","generateAudio"],y);const A=d(n,["lastFrame"]);e!==void 0&&A!=null&&f(e,["instances[0]","lastFrame"],Ai(A));const T=d(n,["referenceImages"]);if(e!==void 0&&T!=null){let C=T;Array.isArray(C)&&(C=C.map(I=>vN(I))),f(e,["instances[0]","referenceImages"],C)}const _=d(n,["mask"]);e!==void 0&&_!=null&&f(e,["instances[0]","mask"],mN(_));const E=d(n,["compressionQuality"]);return e!==void 0&&E!=null&&f(e,["parameters","compressionQuality"],E),t}function yk(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response","generateVideoResponse"]);return o!=null&&f(e,["response"],Ek(o)),e}function vk(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response"]);return o!=null&&f(e,["response"],Sk(o)),e}function _k(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["prompt"]);s!=null&&f(t,["instances[0]","prompt"],s);const r=d(e,["image"]);r!=null&&f(t,["instances[0]","image"],qp(r));const o=d(e,["video"]);o!=null&&f(t,["instances[0]","video"],Xw(o));const a=d(e,["source"]);a!=null&&wk(a,t);const l=d(e,["config"]);return l!=null&&gk(l,t),t}function Ak(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["prompt"]);s!=null&&f(t,["instances[0]","prompt"],s);const r=d(e,["image"]);r!=null&&f(t,["instances[0]","image"],Ai(r));const o=d(e,["video"]);o!=null&&f(t,["instances[0]","video"],Qw(o));const a=d(e,["source"]);a!=null&&Ck(a,t);const l=d(e,["config"]);return l!=null&&mk(l,t),t}function Ek(n){const e={},t=d(n,["generatedSamples"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>xk(o))),f(e,["generatedVideos"],r)}const i=d(n,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const s=d(n,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function Sk(n){const e={},t=d(n,["videos"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>Pk(o))),f(e,["generatedVideos"],r)}const i=d(n,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const s=d(n,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function wk(n,e){const t={},i=d(n,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const s=d(n,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],qp(s));const r=d(n,["video"]);return e!==void 0&&r!=null&&f(e,["instances[0]","video"],Xw(r)),t}function Ck(n,e){const t={},i=d(n,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const s=d(n,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],Ai(s));const r=d(n,["video"]);return e!==void 0&&r!=null&&f(e,["instances[0]","video"],Qw(r)),t}function Tk(n){const e={},t=d(n,["_self"]);t!=null&&f(e,["image"],Fk(t));const i=d(n,["raiFilteredReason"]);i!=null&&f(e,["raiFilteredReason"],i);const s=d(n,["_self"]);return s!=null&&f(e,["safetyAttributes"],Ww(s)),e}function zp(n){const e={},t=d(n,["_self"]);t!=null&&f(e,["image"],$w(t));const i=d(n,["raiFilteredReason"]);i!=null&&f(e,["raiFilteredReason"],i);const s=d(n,["_self"]);s!=null&&f(e,["safetyAttributes"],Yw(s));const r=d(n,["prompt"]);return r!=null&&f(e,["enhancedPrompt"],r),e}function Ik(n){const e={},t=d(n,["_self"]);t!=null&&f(e,["mask"],$w(t));const i=d(n,["labels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>r)),f(e,["labels"],s)}return e}function xk(n){const e={},t=d(n,["video"]);return t!=null&&f(e,["video"],pN(t)),e}function Pk(n){const e={},t=d(n,["_self"]);return t!=null&&f(e,["video"],gN(t)),e}function Rk(n){const e={},t=d(n,["modelSelectionConfig"]);t!=null&&f(e,["modelConfig"],t);const i=d(n,["responseJsonSchema"]);i!=null&&f(e,["responseJsonSchema"],i);const s=d(n,["audioTimestamp"]);s!=null&&f(e,["audioTimestamp"],s);const r=d(n,["candidateCount"]);r!=null&&f(e,["candidateCount"],r);const o=d(n,["enableAffectiveDialog"]);o!=null&&f(e,["enableAffectiveDialog"],o);const a=d(n,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const l=d(n,["logprobs"]);l!=null&&f(e,["logprobs"],l);const u=d(n,["maxOutputTokens"]);u!=null&&f(e,["maxOutputTokens"],u);const h=d(n,["mediaResolution"]);h!=null&&f(e,["mediaResolution"],h);const p=d(n,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const g=d(n,["responseLogprobs"]);g!=null&&f(e,["responseLogprobs"],g);const m=d(n,["responseMimeType"]);m!=null&&f(e,["responseMimeType"],m);const y=d(n,["responseModalities"]);y!=null&&f(e,["responseModalities"],y);const A=d(n,["responseSchema"]);A!=null&&f(e,["responseSchema"],A);const T=d(n,["routingConfig"]);T!=null&&f(e,["routingConfig"],T);const _=d(n,["seed"]);_!=null&&f(e,["seed"],_);const E=d(n,["speechConfig"]);E!=null&&f(e,["speechConfig"],Kw(E));const C=d(n,["stopSequences"]);C!=null&&f(e,["stopSequences"],C);const I=d(n,["temperature"]);I!=null&&f(e,["temperature"],I);const x=d(n,["thinkingConfig"]);x!=null&&f(e,["thinkingConfig"],x);const R=d(n,["topK"]);R!=null&&f(e,["topK"],R);const P=d(n,["topP"]);if(P!=null&&f(e,["topP"],P),d(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Mk(n,e){const t={},i=d(e,["model"]);return i!=null&&f(t,["_url","name"],pe(n,i)),t}function kk(n,e){const t={},i=d(e,["model"]);return i!=null&&f(t,["_url","name"],pe(n,i)),t}function Nk(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=d(n,["enableWidget"]);return t!=null&&f(e,["enableWidget"],t),e}function bk(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=d(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],t),e}function Dk(n){const e={},t=d(n,["aspectRatio"]);t!=null&&f(e,["aspectRatio"],t);const i=d(n,["imageSize"]);if(i!=null&&f(e,["imageSize"],i),d(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function Lk(n){const e={},t=d(n,["aspectRatio"]);t!=null&&f(e,["aspectRatio"],t);const i=d(n,["imageSize"]);i!=null&&f(e,["imageSize"],i);const s=d(n,["outputMimeType"]);s!=null&&f(e,["imageOutputOptions","mimeType"],s);const r=d(n,["outputCompressionQuality"]);return r!=null&&f(e,["imageOutputOptions","compressionQuality"],r),e}function Fk(n){const e={},t=d(n,["bytesBase64Encoded"]);t!=null&&f(e,["imageBytes"],$r(t));const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function $w(n){const e={},t=d(n,["gcsUri"]);t!=null&&f(e,["gcsUri"],t);const i=d(n,["bytesBase64Encoded"]);i!=null&&f(e,["imageBytes"],$r(i));const s=d(n,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function qp(n){const e={};if(d(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=d(n,["imageBytes"]);t!=null&&f(e,["bytesBase64Encoded"],$r(t));const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function Ai(n){const e={},t=d(n,["gcsUri"]);t!=null&&f(e,["gcsUri"],t);const i=d(n,["imageBytes"]);i!=null&&f(e,["bytesBase64Encoded"],$r(i));const s=d(n,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function Uk(n,e,t){const i={},s=d(e,["pageSize"]);t!==void 0&&s!=null&&f(t,["_query","pageSize"],s);const r=d(e,["pageToken"]);t!==void 0&&r!=null&&f(t,["_query","pageToken"],r);const o=d(e,["filter"]);t!==void 0&&o!=null&&f(t,["_query","filter"],o);const a=d(e,["queryBase"]);return t!==void 0&&a!=null&&f(t,["_url","models_url"],Uw(n,a)),i}function Hk(n,e,t){const i={},s=d(e,["pageSize"]);t!==void 0&&s!=null&&f(t,["_query","pageSize"],s);const r=d(e,["pageToken"]);t!==void 0&&r!=null&&f(t,["_query","pageToken"],r);const o=d(e,["filter"]);t!==void 0&&o!=null&&f(t,["_query","filter"],o);const a=d(e,["queryBase"]);return t!==void 0&&a!=null&&f(t,["_url","models_url"],Uw(n,a)),i}function Vk(n,e){const t={},i=d(e,["config"]);return i!=null&&Uk(n,i,t),t}function Ok(n,e){const t={},i=d(e,["config"]);return i!=null&&Hk(n,i,t),t}function Gk(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["_self"]);if(s!=null){let r=Hw(s);Array.isArray(r)&&(r=r.map(o=>km(o))),f(e,["models"],r)}return e}function Bk(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["_self"]);if(s!=null){let r=Hw(s);Array.isArray(r)&&(r=r.map(o=>Nm(o))),f(e,["models"],r)}return e}function zk(n){const e={},t=d(n,["maskMode"]);t!=null&&f(e,["maskMode"],t);const i=d(n,["segmentationClasses"]);i!=null&&f(e,["maskClasses"],i);const s=d(n,["maskDilation"]);return s!=null&&f(e,["dilation"],s),e}function km(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["displayName"]);i!=null&&f(e,["displayName"],i);const s=d(n,["description"]);s!=null&&f(e,["description"],s);const r=d(n,["version"]);r!=null&&f(e,["version"],r);const o=d(n,["_self"]);o!=null&&f(e,["tunedModelInfo"],rN(o));const a=d(n,["inputTokenLimit"]);a!=null&&f(e,["inputTokenLimit"],a);const l=d(n,["outputTokenLimit"]);l!=null&&f(e,["outputTokenLimit"],l);const u=d(n,["supportedGenerationMethods"]);u!=null&&f(e,["supportedActions"],u);const h=d(n,["temperature"]);h!=null&&f(e,["temperature"],h);const p=d(n,["maxTemperature"]);p!=null&&f(e,["maxTemperature"],p);const g=d(n,["topP"]);g!=null&&f(e,["topP"],g);const m=d(n,["topK"]);m!=null&&f(e,["topK"],m);const y=d(n,["thinking"]);return y!=null&&f(e,["thinking"],y),e}function Nm(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["displayName"]);i!=null&&f(e,["displayName"],i);const s=d(n,["description"]);s!=null&&f(e,["description"],s);const r=d(n,["versionId"]);r!=null&&f(e,["version"],r);const o=d(n,["deployedModels"]);if(o!=null){let p=o;Array.isArray(p)&&(p=p.map(g=>nk(g))),f(e,["endpoints"],p)}const a=d(n,["labels"]);a!=null&&f(e,["labels"],a);const l=d(n,["_self"]);l!=null&&f(e,["tunedModelInfo"],oN(l));const u=d(n,["defaultCheckpointId"]);u!=null&&f(e,["defaultCheckpointId"],u);const h=d(n,["checkpoints"]);if(h!=null){let p=h;Array.isArray(p)&&(p=p.map(g=>g)),f(e,["checkpoints"],p)}return e}function qk(n){const e={},t=d(n,["mediaResolution"]);t!=null&&f(e,["mediaResolution"],t);const i=d(n,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const s=d(n,["executableCode"]);s!=null&&f(e,["executableCode"],s);const r=d(n,["fileData"]);r!=null&&f(e,["fileData"],ik(r));const o=d(n,["functionCall"]);o!=null&&f(e,["functionCall"],sk(o));const a=d(n,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(n,["inlineData"]);l!=null&&f(e,["inlineData"],R1(l));const u=d(n,["text"]);u!=null&&f(e,["text"],u);const h=d(n,["thought"]);h!=null&&f(e,["thought"],h);const p=d(n,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const g=d(n,["videoMetadata"]);return g!=null&&f(e,["videoMetadata"],g),e}function $k(n){const e={},t=d(n,["productImage"]);return t!=null&&f(e,["image"],Ai(t)),e}function Wk(n,e){const t={},i=d(n,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const s=d(n,["baseSteps"]);e!==void 0&&s!=null&&f(e,["parameters","baseSteps"],s);const r=d(n,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const o=d(n,["seed"]);e!==void 0&&o!=null&&f(e,["parameters","seed"],o);const a=d(n,["safetyFilterLevel"]);e!==void 0&&a!=null&&f(e,["parameters","safetySetting"],a);const l=d(n,["personGeneration"]);e!==void 0&&l!=null&&f(e,["parameters","personGeneration"],l);const u=d(n,["addWatermark"]);e!==void 0&&u!=null&&f(e,["parameters","addWatermark"],u);const h=d(n,["outputMimeType"]);e!==void 0&&h!=null&&f(e,["parameters","outputOptions","mimeType"],h);const p=d(n,["outputCompressionQuality"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","compressionQuality"],p);const g=d(n,["enhancePrompt"]);e!==void 0&&g!=null&&f(e,["parameters","enhancePrompt"],g);const m=d(n,["labels"]);return e!==void 0&&m!=null&&f(e,["labels"],m),t}function Yk(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["source"]);s!=null&&Jk(s,t);const r=d(e,["config"]);return r!=null&&Wk(r,t),t}function Kk(n){const e={},t=d(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>zp(s))),f(e,["generatedImages"],i)}return e}function Jk(n,e){const t={},i=d(n,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const s=d(n,["personImage"]);e!==void 0&&s!=null&&f(e,["instances[0]","personImage","image"],Ai(s));const r=d(n,["productImages"]);if(e!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>$k(a))),f(e,["instances[0]","productImages"],o)}return t}function Xk(n){const e={},t=d(n,["referenceImage"]);t!=null&&f(e,["referenceImage"],Ai(t));const i=d(n,["referenceId"]);i!=null&&f(e,["referenceId"],i);const s=d(n,["referenceType"]);s!=null&&f(e,["referenceType"],s);const r=d(n,["maskImageConfig"]);r!=null&&f(e,["maskImageConfig"],zk(r));const o=d(n,["controlImageConfig"]);o!=null&&f(e,["controlImageConfig"],F1(o));const a=d(n,["styleImageConfig"]);a!=null&&f(e,["styleImageConfig"],a);const l=d(n,["subjectImageConfig"]);return l!=null&&f(e,["subjectImageConfig"],l),e}function Ww(n){const e={},t=d(n,["safetyAttributes","categories"]);t!=null&&f(e,["categories"],t);const i=d(n,["safetyAttributes","scores"]);i!=null&&f(e,["scores"],i);const s=d(n,["contentType"]);return s!=null&&f(e,["contentType"],s),e}function Yw(n){const e={},t=d(n,["safetyAttributes","categories"]);t!=null&&f(e,["categories"],t);const i=d(n,["safetyAttributes","scores"]);i!=null&&f(e,["scores"],i);const s=d(n,["contentType"]);return s!=null&&f(e,["contentType"],s),e}function Qk(n){const e={},t=d(n,["category"]);if(t!=null&&f(e,["category"],t),d(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=d(n,["threshold"]);return i!=null&&f(e,["threshold"],i),e}function Zk(n){const e={},t=d(n,["image"]);return t!=null&&f(e,["image"],Ai(t)),e}function jk(n,e){const t={},i=d(n,["mode"]);e!==void 0&&i!=null&&f(e,["parameters","mode"],i);const s=d(n,["maxPredictions"]);e!==void 0&&s!=null&&f(e,["parameters","maxPredictions"],s);const r=d(n,["confidenceThreshold"]);e!==void 0&&r!=null&&f(e,["parameters","confidenceThreshold"],r);const o=d(n,["maskDilation"]);e!==void 0&&o!=null&&f(e,["parameters","maskDilation"],o);const a=d(n,["binaryColorThreshold"]);e!==void 0&&a!=null&&f(e,["parameters","binaryColorThreshold"],a);const l=d(n,["labels"]);return e!==void 0&&l!=null&&f(e,["labels"],l),t}function eN(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["source"]);s!=null&&nN(s,t);const r=d(e,["config"]);return r!=null&&jk(r,t),t}function tN(n){const e={},t=d(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>Ik(s))),f(e,["generatedMasks"],i)}return e}function nN(n,e){const t={},i=d(n,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const s=d(n,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],Ai(s));const r=d(n,["scribbleImage"]);return e!==void 0&&r!=null&&f(e,["instances[0]","scribble"],Zk(r)),t}function Kw(n){const e={},t=d(n,["languageCode"]);t!=null&&f(e,["languageCode"],t);const i=d(n,["voiceConfig"]);if(i!=null&&f(e,["voiceConfig"],i),d(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function iN(n){const e={},t=d(n,["functionCallingConfig"]);t!=null&&f(e,["functionCallingConfig"],rk(t));const i=d(n,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],i),e}function sN(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=d(n,["computerUse"]);s!=null&&f(e,["computerUse"],s);const r=d(n,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(n,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(n,["googleMaps"]);a!=null&&f(e,["googleMaps"],Nk(a));const l=d(n,["googleSearch"]);l!=null&&f(e,["googleSearch"],bk(l));const u=d(n,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function Jw(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(g=>ok(g))),f(e,["functionDeclarations"],p)}const i=d(n,["retrieval"]);i!=null&&f(e,["retrieval"],i);const s=d(n,["googleSearchRetrieval"]);s!=null&&f(e,["googleSearchRetrieval"],s);const r=d(n,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),d(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=d(n,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const a=d(n,["enterpriseWebSearch"]);a!=null&&f(e,["enterpriseWebSearch"],a);const l=d(n,["googleMaps"]);l!=null&&f(e,["googleMaps"],l);const u=d(n,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const h=d(n,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function rN(n){const e={},t=d(n,["baseModel"]);t!=null&&f(e,["baseModel"],t);const i=d(n,["createTime"]);i!=null&&f(e,["createTime"],i);const s=d(n,["updateTime"]);return s!=null&&f(e,["updateTime"],s),e}function oN(n){const e={},t=d(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&f(e,["baseModel"],t);const i=d(n,["createTime"]);i!=null&&f(e,["createTime"],i);const s=d(n,["updateTime"]);return s!=null&&f(e,["updateTime"],s),e}function aN(n,e){const t={},i=d(n,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const s=d(n,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const r=d(n,["defaultCheckpointId"]);return e!==void 0&&r!=null&&f(e,["defaultCheckpointId"],r),t}function lN(n,e){const t={},i=d(n,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const s=d(n,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const r=d(n,["defaultCheckpointId"]);return e!==void 0&&r!=null&&f(e,["defaultCheckpointId"],r),t}function uN(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","name"],pe(n,i));const s=d(e,["config"]);return s!=null&&aN(s,t),t}function cN(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["config"]);return s!=null&&lN(s,t),t}function dN(n,e){const t={},i=d(n,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const s=d(n,["safetyFilterLevel"]);e!==void 0&&s!=null&&f(e,["parameters","safetySetting"],s);const r=d(n,["personGeneration"]);e!==void 0&&r!=null&&f(e,["parameters","personGeneration"],r);const o=d(n,["includeRaiReason"]);e!==void 0&&o!=null&&f(e,["parameters","includeRaiReason"],o);const a=d(n,["outputMimeType"]);e!==void 0&&a!=null&&f(e,["parameters","outputOptions","mimeType"],a);const l=d(n,["outputCompressionQuality"]);e!==void 0&&l!=null&&f(e,["parameters","outputOptions","compressionQuality"],l);const u=d(n,["enhanceInputImage"]);e!==void 0&&u!=null&&f(e,["parameters","upscaleConfig","enhanceInputImage"],u);const h=d(n,["imagePreservationFactor"]);e!==void 0&&h!=null&&f(e,["parameters","upscaleConfig","imagePreservationFactor"],h);const p=d(n,["labels"]);e!==void 0&&p!=null&&f(e,["labels"],p);const g=d(n,["numberOfImages"]);e!==void 0&&g!=null&&f(e,["parameters","sampleCount"],g);const m=d(n,["mode"]);return e!==void 0&&m!=null&&f(e,["parameters","mode"],m),t}function hN(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["image"]);s!=null&&f(t,["instances[0]","image"],Ai(s));const r=d(e,["upscaleFactor"]);r!=null&&f(t,["parameters","upscaleConfig","upscaleFactor"],r);const o=d(e,["config"]);return o!=null&&dN(o,t),t}function fN(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>zp(r))),f(e,["generatedImages"],s)}return e}function pN(n){const e={},t=d(n,["uri"]);t!=null&&f(e,["uri"],t);const i=d(n,["encodedVideo"]);i!=null&&f(e,["videoBytes"],$r(i));const s=d(n,["encoding"]);return s!=null&&f(e,["mimeType"],s),e}function gN(n){const e={},t=d(n,["gcsUri"]);t!=null&&f(e,["uri"],t);const i=d(n,["bytesBase64Encoded"]);i!=null&&f(e,["videoBytes"],$r(i));const s=d(n,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function mN(n){const e={},t=d(n,["image"]);t!=null&&f(e,["_self"],Ai(t));const i=d(n,["maskMode"]);return i!=null&&f(e,["maskMode"],i),e}function yN(n){const e={},t=d(n,["image"]);t!=null&&f(e,["image"],qp(t));const i=d(n,["referenceType"]);return i!=null&&f(e,["referenceType"],i),e}function vN(n){const e={},t=d(n,["image"]);t!=null&&f(e,["image"],Ai(t));const i=d(n,["referenceType"]);return i!=null&&f(e,["referenceType"],i),e}function Xw(n){const e={},t=d(n,["uri"]);t!=null&&f(e,["uri"],t);const i=d(n,["videoBytes"]);i!=null&&f(e,["encodedVideo"],$r(i));const s=d(n,["mimeType"]);return s!=null&&f(e,["encoding"],s),e}function Qw(n){const e={},t=d(n,["uri"]);t!=null&&f(e,["gcsUri"],t);const i=d(n,["videoBytes"]);i!=null&&f(e,["bytesBase64Encoded"],$r(i));const s=d(n,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _N="Content-Type",AN="X-Server-Timeout",EN="User-Agent",bm="x-goog-api-client",SN="1.30.0",wN=`google-genai-sdk/${SN}`,CN="v1beta1",TN="v1beta",GA=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class IN{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:CN,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:TN,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const s=[this.getRequestUrlInternal(t)];return i&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))s.searchParams.append(o,String(a));let r={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,t,s.toString(),e.abortSignal),this.unaryApiCall(s,r,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[s,r]of Object.entries(t))typeof r=="object"?i[s]=Object.assign(Object.assign({},i[s]),r):r!==void 0&&(i[s]=r);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,t,s.toString(),e.abortSignal),this.streamApiCall(s,r,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,s){if(t&&t.timeout||s){const r=new AbortController,o=r.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const a=setTimeout(()=>r.abort(),t.timeout);a&&typeof a.unref=="function"&&a.unref()}s&&s.addEventListener("abort",()=>{r.abort()}),e.signal=o}return t&&t.extraBody!==null&&xN(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await BA(s),new Pm(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await BA(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var t;return el(this,arguments,function*(){const s=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),r=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield xe(s.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=r.decode(l,{stream:!0});try{const p=JSON.parse(u);if("error"in p){const g=JSON.parse(JSON.stringify(p.error)),m=g.status,y=g.code,A=`got status: ${m}. ${JSON.stringify(p)}`;if(y>=400&&y<600)throw new Gp({message:A,status:y})}}catch(p){if(p.name==="ApiError")throw p}o+=u;let h=o.match(GA);for(;h;){const p=h[1];try{const g=new Response(p,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield xe(new Pm(g)),o=o.slice(h[0].length),h=o.match(GA)}catch(g){throw new Error(`exception parsing stream chunk ${p}. ${g}`)}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=wN+" "+this.clientOptions.userAgentExtra;return e[EN]=t,e[bm]=t,e[_N]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[s,r]of Object.entries(e.headers))i.append(s,r);e.timeout&&e.timeout>0&&i.append(AN,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const r=this.clientOptions.uploader,o=await r.stat(e);s.sizeBytes=String(o.size);const a=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=a;const l={file:s},u=this.getFileName(e),h=V("upload/v1beta/files",l._url),p=await this.fetchUploadUrl(h,s.sizeBytes,s.mimeType,u,l,t==null?void 0:t.httpOptions);return r.upload(e,p,this)}async uploadFileToFileSearchStore(e,t,i){var s;const r=this.clientOptions.uploader,o=await r.stat(t),a=String(o.size),l=(s=i==null?void 0:i.mimeType)!==null&&s!==void 0?s:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const u=`upload/v1beta/${e}:uploadToFileSearchStore`,h=this.getFileName(t),p={};i!=null&&i.customMetadata&&(p.customMetadata=i.customMetadata),i!=null&&i.chunkingConfig&&(p.chunkingConfig=i.chunkingConfig);const g=await this.fetchUploadUrl(u,a,l,h,p,i==null?void 0:i.httpOptions);return r.uploadToFileSearchStore(t,g,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,s,r,o){var a;let l={};o?l=o:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},s?{"X-Goog-Upload-File-Name":s}:{})};const u=await this.request({path:e,body:JSON.stringify(r),httpMethod:"POST",httpOptions:l});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const h=(a=u==null?void 0:u.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(h===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return h}}async function BA(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const s=JSON.stringify(i);throw t>=400&&t<600?new Gp({message:s,status:t}):new Error(s)}}function xN(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const r=JSON.parse(n.body);if(typeof r=="object"&&r!==null&&!Array.isArray(r))t=r;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(r,o){const a=Object.assign({},r);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],h=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&h&&typeof h=="object"&&!Array.isArray(h)?a[l]=i(h,u):(h&&u&&typeof h!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof h}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const s=i(t,e);n.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const PN="mcp_used/unknown";let RN=!1;function Zw(n){for(const e of n)if(MN(e)||typeof e=="object"&&"inputSchema"in e)return!0;return RN}function jw(n){var e;const t=(e=n[bm])!==null&&e!==void 0?e:"";n[bm]=(t+` ${PN}`).trimStart()}function MN(n){return n!==null&&typeof n=="object"&&n instanceof Xv}function kN(n,e=100){return el(this,arguments,function*(){let i,s=0;for(;s<e;){const r=yield xe(n.listTools({cursor:i}));for(const o of r.tools)yield yield xe(o),s++;if(!r.nextCursor)break;i=r.nextCursor}})}class Xv{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Xv(e,t)}async initialize(){var e,t,i,s;if(this.mcpTools.length>0)return;const r={},o=[];for(const h of this.mcpClients)try{for(var a=!0,l=(t=void 0,cc(kN(h))),u;u=await l.next(),e=u.done,!e;a=!0){s=u.value,a=!1;const p=s;o.push(p);const g=p.name;if(r[g])throw new Error(`Duplicate function name ${g} found in MCP tools. Please ensure function names are unique.`);r[g]=h}}catch(p){t={error:p}}finally{try{!a&&!e&&(i=l.return)&&await i.call(l)}finally{if(t)throw t.error}}this.mcpTools=o,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),wR(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[i.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const o=await s.callTool({name:i.name,arguments:i.args},void 0,r);t.push({functionResponse:{name:i.name,response:o.isError?{error:o}:o}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function NN(n,e,t){const i=new gR;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),Object.assign(i,s),e(i)}class bN{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),o=FN(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${s}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const h=new Promise(C=>{u=C}),p=e.callbacks,g=function(){u({})},m=this.apiClient,y={onopen:g,onmessage:C=>{NN(m,p.onmessage,C)},onerror:(t=p==null?void 0:p.onerror)!==null&&t!==void 0?t:function(C){},onclose:(i=p==null?void 0:p.onclose)!==null&&i!==void 0?i:function(C){}},A=this.webSocketFactory.create(l,LN(o),y);A.connect(),await h;const E={setup:{model:pe(this.apiClient,e.model)}};return A.send(JSON.stringify(E)),new DN(A,this.apiClient)}}class DN{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=A1(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=_1(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(qa.PLAY)}pause(){this.sendPlaybackControl(qa.PAUSE)}stop(){this.sendPlaybackControl(qa.STOP)}resetContext(){this.sendPlaybackControl(qa.RESET_CONTEXT)}close(){this.conn.close()}}function LN(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function FN(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const UN="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function HN(n,e,t){const i=new pR;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const r=JSON.parse(s);if(n.isVertexAI()){const o=w1(r);Object.assign(i,o)}else Object.assign(i,r);e(i)}class VN{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new bN(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,s,r,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let h;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&Zw(e.config.tools)&&jw(p);const g=zN(p);if(this.apiClient.isVertexAI())h=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(g,h);else{const k=this.apiClient.getApiKey();let N="BidiGenerateContent",L="key";k!=null&&k.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),N="BidiGenerateContentConstrained",L="access_token"),h=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${N}?${L}=${k}`}let m=()=>{};const y=new Promise(k=>{m=k}),A=e.callbacks,T=function(){var k;(k=A==null?void 0:A.onopen)===null||k===void 0||k.call(A),m({})},_=this.apiClient,E={onopen:T,onmessage:k=>{HN(_,A.onmessage,k)},onerror:(t=A==null?void 0:A.onerror)!==null&&t!==void 0?t:function(k){},onclose:(i=A==null?void 0:A.onclose)!==null&&i!==void 0?i:function(k){}},C=this.webSocketFactory.create(h,BN(g),E);C.connect(),await y;let I=pe(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&I.startsWith("publishers/")){const k=this.apiClient.getProject(),N=this.apiClient.getLocation();I=`projects/${k}/locations/${N}/`+I}let x={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Kf.AUDIO]}:e.config.responseModalities=[Kf.AUDIO]),!((r=e.config)===null||r===void 0)&&r.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const R=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],P=[];for(const k of R)if(this.isCallableTool(k)){const N=k;P.push(await N.tool())}else P.push(k);P.length>0&&(e.config.tools=P);const M={model:I,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?x=v1(this.apiClient,M):x=y1(this.apiClient,M),delete x.config,C.send(JSON.stringify(x)),new GN(C,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const ON={turnComplete:!0};class GN{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Wn(t.turns),e.isVertexAI()||(i=i.map(s=>Bp(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const r of i){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error(UN)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},ON),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:S1(e)}:t={realtimeInput:E1(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function BN(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function zN(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zA=10;function qA(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const o of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(tl(o)){s=!0;break}if(!s)return!0;const r=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return r&&(r<0||!Number.isInteger(r))||r==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0):!1}function tl(n){return"callTool"in n&&typeof n.callTool=="function"}function qN(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>tl(s)))!==null&&i!==void 0?i:!1}function $A(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,s)=>{if(tl(i))return;const r=i;r.functionDeclarations&&r.functionDeclarations.length>0&&t.push(s)}),t}function WA(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $N extends Os{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,s,r,o,a;const l=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!qN(t)||qA(t.config))return await this.generateContentInternal(l);const u=$A(t);if(u.length>0){const A=u.map(T=>`tools[${T}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${A}.`)}let h,p;const g=Wn(l.contents),m=(r=(s=(i=l.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&r!==void 0?r:zA;let y=0;for(;y<m&&(h=await this.generateContentInternal(l),!(!h.functionCalls||h.functionCalls.length===0));){const A=h.candidates[0].content,T=[];for(const _ of(a=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(tl(_)){const C=await _.callTool(h.functionCalls);T.push(...C)}y++,p={role:"user",parts:T},l.contents=Wn(l.contents),l.contents.push(A),l.contents.push(p),WA(l.config)&&(g.push(A),g.push(p))}return WA(l.config)&&(h.automaticFunctionCallingHistory=g),h},this.generateContentStream=async t=>{var i,s,r,o,a;if(this.maybeMoveToResponseJsonSchem(t),qA(t.config)){const p=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(p)}const l=$A(t);if(l.length>0){const p=l.map(g=>`tools[${g}]`).join(", ");throw new Error(`Incompatible tools found at ${p}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const u=(r=(s=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||r===void 0?void 0:r.streamFunctionCallArguments,h=(a=(o=t==null?void 0:t.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(u&&!h)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var s;let r;const o=[];if(i!=null&&i.generatedImages)for(const l of i.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((s=l==null?void 0:l.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?r=l==null?void 0:l.safetyAttributes:o.push(l);let a;return r?a={generatedImages:o,positivePromptSafetyAttributes:r,sdkHttpResponse:i.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:i.sdkHttpResponse},a}),this.list=async t=>{var i;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((i=o.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Ea(Fs.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>{var i,s,r,o,a,l;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((s=t.video)===null||s===void 0)&&s.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((o=(r=t.source)===null||r===void 0?void 0:r.video)===null||o===void 0)&&o.uri&&(!((l=(a=t.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,s;const r=(t=e.config)===null||t===void 0?void 0:t.tools;if(!r)return e;const o=await Promise.all(r.map(async l=>tl(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&Zw(e.config.tools)){const l=(s=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&s!==void 0?s:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),jw(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var t,i,s;const r=new Map;for(const o of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(tl(o)){const a=o,l=await a.tool();for(const u of(s=l.functionDeclarations)!==null&&s!==void 0?s:[]){if(!u.name)throw new Error("Function declaration name is required.");if(r.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);r.set(u.name,a)}}return r}async processAfcStream(e){var t,i,s;const r=(s=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:zA;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,h,p){var g,m;return el(this,arguments,function*(){for(var y,A,T,_;a<r;){o&&(a++,o=!1);const x=yield xe(u.processParamsMaybeAddMcpUsage(p)),R=yield xe(u.generateContentStreamInternal(x)),P=[],M=[];try{for(var E=!0,C=(A=void 0,cc(R)),I;I=yield xe(C.next()),y=I.done,!y;E=!0){_=I.value,E=!1;const k=_;if(yield yield xe(k),k.candidates&&(!((g=k.candidates[0])===null||g===void 0)&&g.content)){M.push(k.candidates[0].content);for(const N of(m=k.candidates[0].content.parts)!==null&&m!==void 0?m:[])if(a<r&&N.functionCall){if(!N.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(N.functionCall.name)){const L=yield xe(h.get(N.functionCall.name).callTool([N.functionCall]));P.push(...L)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${N.functionCall.name}`)}}}}catch(k){A={error:k}}finally{try{!E&&!y&&(T=C.return)&&(yield xe(T.call(C)))}finally{if(A)throw A.error}}if(P.length>0){o=!0;const k=new Mu;k.candidates=[{content:{role:"user",parts:P}}],yield yield xe(k);const N=[];N.push(...M),N.push({role:"user",parts:P});const L=Wn(p.contents).concat(N);p.contents=L}else break}})}(this,l,e)}async generateContentInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=HA(this.apiClient,e);return a=V("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=OA(h),g=new Mu;return Object.assign(g,p),g})}else{const u=UA(this.apiClient,e);return a=V("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=VA(h),g=new Mu;return Object.assign(g,p),g})}}async generateContentStreamInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=HA(this.apiClient,e);return a=V("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(p){return el(this,arguments,function*(){var g,m,y,A;try{for(var T=!0,_=cc(p),E;E=yield xe(_.next()),g=E.done,!g;T=!0){A=E.value,T=!1;const C=A,I=OA(yield xe(C.json()));I.sdkHttpResponse={headers:C.headers};const x=new Mu;Object.assign(x,I),yield yield xe(x)}}catch(C){m={error:C}}finally{try{!T&&!g&&(y=_.return)&&(yield xe(y.call(_)))}finally{if(m)throw m.error}}})})}else{const u=UA(this.apiClient,e);return a=V("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return el(this,arguments,function*(){var g,m,y,A;try{for(var T=!0,_=cc(p),E;E=yield xe(_.next()),g=E.done,!g;T=!0){A=E.value,T=!1;const C=A,I=VA(yield xe(C.json()));I.sdkHttpResponse={headers:C.headers};const x=new Mu;Object.assign(x,I),yield yield xe(x)}}catch(C){m={error:C}}finally{try{!T&&!g&&(y=_.return)&&(yield xe(y.call(_)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=j1(this.apiClient,e);return a=V("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=tk(h),g=new EA;return Object.assign(g,p),g})}else{const u=Z1(this.apiClient,e);return a=V("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=ek(h),g=new EA;return Object.assign(g,p),g})}}async generateImagesInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=hk(this.apiClient,e);return a=V("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=pk(h),g=new SA;return Object.assign(g,p),g})}else{const u=dk(this.apiClient,e);return a=V("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=fk(h),g=new SA;return Object.assign(g,p),g})}}async editImageInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=K1(this.apiClient,e);return r=V("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>{const u=J1(l),h=new iR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=hN(this.apiClient,e);return r=V("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>{const u=fN(l),h=new sR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=Yk(this.apiClient,e);return r=V("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=Kk(l),h=new rR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=eN(this.apiClient,e);return r=V("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=tN(l),h=new oR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=kk(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>Nm(h))}else{const u=Mk(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>km(h))}}async listInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Ok(this.apiClient,e);return a=V("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=Bk(h),g=new wA;return Object.assign(g,p),g})}else{const u=Vk(this.apiClient,e);return a=V("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=Gk(h),g=new wA;return Object.assign(g,p),g})}}async update(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=cN(this.apiClient,e);return a=V("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>Nm(h))}else{const u=uN(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>km(h))}}async delete(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=q1(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=W1(h),g=new CA;return Object.assign(g,p),g})}else{const u=z1(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=$1(h),g=new CA;return Object.assign(g,p),g})}}async countTokens(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=O1(this.apiClient,e);return a=V("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=B1(h),g=new TA;return Object.assign(g,p),g})}else{const u=V1(this.apiClient,e);return a=V("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=G1(h),g=new TA;return Object.assign(g,p),g})}}async computeTokens(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=N1(this.apiClient,e);return r=V("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>{const u=b1(l),h=new aR;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Ak(this.apiClient,e);return a=V("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>{const p=vk(h),g=new Jf;return Object.assign(g,p),g})}else{const u=_k(this.apiClient,e);return a=V("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=yk(h),g=new Jf;return Object.assign(g,p),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class WN extends Os{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let r;i&&"httpOptions"in i&&(r=i.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let r;i&&"httpOptions"in i&&(r=i.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=QP(e);return a=V("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o}else{const u=XP(e);return a=V("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o}}async fetchPredictVideosOperationInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=zP(e);return r=V("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YN(n){const e={},t=d(n,["data"]);if(t!=null&&f(e,["data"],t),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function KN(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>ib(r))),f(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&f(e,["role"],i),e}function JN(n,e,t){const i={},s=d(e,["expireTime"]);t!==void 0&&s!=null&&f(t,["expireTime"],s);const r=d(e,["newSessionExpireTime"]);t!==void 0&&r!=null&&f(t,["newSessionExpireTime"],r);const o=d(e,["uses"]);t!==void 0&&o!=null&&f(t,["uses"],o);const a=d(e,["liveConnectConstraints"]);t!==void 0&&a!=null&&f(t,["bidiGenerateContentSetup"],nb(n,a));const l=d(e,["lockAdditionalFields"]);return t!==void 0&&l!=null&&f(t,["fieldMask"],l),i}function XN(n,e){const t={},i=d(e,["config"]);return i!=null&&f(t,["config"],JN(n,i,t)),t}function QN(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function ZN(n){const e={},t=d(n,["id"]);t!=null&&f(e,["id"],t);const i=d(n,["args"]);i!=null&&f(e,["args"],i);const s=d(n,["name"]);if(s!=null&&f(e,["name"],s),d(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function jN(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=d(n,["enableWidget"]);return t!=null&&f(e,["enableWidget"],t),e}function eb(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=d(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],t),e}function tb(n,e){const t={},i=d(n,["generationConfig"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig"],i);const s=d(n,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const r=d(n,["temperature"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig","temperature"],r);const o=d(n,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=d(n,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(n,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(n,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const h=d(n,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=d(n,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],Jv(p));const g=d(n,["thinkingConfig"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","thinkingConfig"],g);const m=d(n,["enableAffectiveDialog"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],m);const y=d(n,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],KN(Lt(y)));const A=d(n,["tools"]);if(e!==void 0&&A!=null){let R=Au(A);Array.isArray(R)&&(R=R.map(P=>rb(_u(P)))),f(e,["setup","tools"],R)}const T=d(n,["sessionResumption"]);e!==void 0&&T!=null&&f(e,["setup","sessionResumption"],sb(T));const _=d(n,["inputAudioTranscription"]);e!==void 0&&_!=null&&f(e,["setup","inputAudioTranscription"],_);const E=d(n,["outputAudioTranscription"]);e!==void 0&&E!=null&&f(e,["setup","outputAudioTranscription"],E);const C=d(n,["realtimeInputConfig"]);e!==void 0&&C!=null&&f(e,["setup","realtimeInputConfig"],C);const I=d(n,["contextWindowCompression"]);e!==void 0&&I!=null&&f(e,["setup","contextWindowCompression"],I);const x=d(n,["proactivity"]);return e!==void 0&&x!=null&&f(e,["setup","proactivity"],x),t}function nb(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["setup","model"],pe(n,i));const s=d(e,["config"]);return s!=null&&f(t,["config"],tb(s,t)),t}function ib(n){const e={},t=d(n,["mediaResolution"]);t!=null&&f(e,["mediaResolution"],t);const i=d(n,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const s=d(n,["executableCode"]);s!=null&&f(e,["executableCode"],s);const r=d(n,["fileData"]);r!=null&&f(e,["fileData"],QN(r));const o=d(n,["functionCall"]);o!=null&&f(e,["functionCall"],ZN(o));const a=d(n,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(n,["inlineData"]);l!=null&&f(e,["inlineData"],YN(l));const u=d(n,["text"]);u!=null&&f(e,["text"],u);const h=d(n,["thought"]);h!=null&&f(e,["thought"],h);const p=d(n,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const g=d(n,["videoMetadata"]);return g!=null&&f(e,["videoMetadata"],g),e}function sb(n){const e={},t=d(n,["handle"]);if(t!=null&&f(e,["handle"],t),d(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function rb(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=d(n,["computerUse"]);s!=null&&f(e,["computerUse"],s);const r=d(n,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(n,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(n,["googleMaps"]);a!=null&&f(e,["googleMaps"],jN(a));const l=d(n,["googleSearch"]);l!=null&&f(e,["googleSearch"],eb(l));const u=d(n,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ob(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const s=Object.keys(i).map(r=>`${t}.${r}`);e.push(...s)}else e.push(t)}return e.join(",")}function ab(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const r=i.setup;typeof r=="object"&&r!==null?(n.bidiGenerateContentSetup=r,t=r):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const s=n.fieldMask;if(t){const r=ob(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)r?n.fieldMask=r:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];s.length>0&&(a=s.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];r&&l.push(r),a.length>0&&l.push(...a),l.length>0?n.fieldMask=l.join(","):delete n.fieldMask}else delete n.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?n.fieldMask=s.join(","):delete n.fieldMask;return n}class lb extends Os{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=XN(this.apiClient,e);r=V("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=ab(a,e.config);return s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),s.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ub(n,e){const t={},i=d(n,["displayName"]);return e!==void 0&&i!=null&&f(e,["displayName"],i),t}function cb(n){const e={},t=d(n,["config"]);return t!=null&&ub(t,e),e}function db(n,e){const t={},i=d(n,["force"]);return e!==void 0&&i!=null&&f(e,["_query","force"],i),t}function hb(n){const e={},t=d(n,["name"]);t!=null&&f(e,["_url","name"],t);const i=d(n,["config"]);return i!=null&&db(i,e),e}function fb(n){const e={},t=d(n,["name"]);return t!=null&&f(e,["_url","name"],t),e}function pb(n,e){const t={},i=d(n,["customMetadata"]);if(e!==void 0&&i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["customMetadata"],r)}const s=d(n,["chunkingConfig"]);return e!==void 0&&s!=null&&f(e,["chunkingConfig"],s),t}function gb(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response"]);return o!=null&&f(e,["response"],yb(o)),e}function mb(n){const e={},t=d(n,["fileSearchStoreName"]);t!=null&&f(e,["_url","file_search_store_name"],t);const i=d(n,["fileName"]);i!=null&&f(e,["fileName"],i);const s=d(n,["config"]);return s!=null&&pb(s,e),e}function yb(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["parent"]);i!=null&&f(e,["parent"],i);const s=d(n,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function vb(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),t}function _b(n){const e={},t=d(n,["config"]);return t!=null&&vb(t,e),e}function Ab(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["fileSearchStores"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["fileSearchStores"],r)}return e}function Eb(n,e){const t={},i=d(n,["mimeType"]);e!==void 0&&i!=null&&f(e,["mimeType"],i);const s=d(n,["displayName"]);e!==void 0&&s!=null&&f(e,["displayName"],s);const r=d(n,["customMetadata"]);if(e!==void 0&&r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>l)),f(e,["customMetadata"],a)}const o=d(n,["chunkingConfig"]);return e!==void 0&&o!=null&&f(e,["chunkingConfig"],o),t}function Sb(n){const e={},t=d(n,["fileSearchStoreName"]);t!=null&&f(e,["_url","file_search_store_name"],t);const i=d(n,["config"]);return i!=null&&Eb(i,e),e}function wb(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Cb(n,e){const t={},i=d(n,["force"]);return e!==void 0&&i!=null&&f(e,["_query","force"],i),t}function Tb(n){const e={},t=d(n,["name"]);t!=null&&f(e,["_url","name"],t);const i=d(n,["config"]);return i!=null&&Cb(i,e),e}function Ib(n){const e={},t=d(n,["name"]);return t!=null&&f(e,["_url","name"],t),e}function xb(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),t}function Pb(n){const e={},t=d(n,["parent"]);t!=null&&f(e,["_url","parent"],t);const i=d(n,["config"]);return i!=null&&xb(i,e),e}function Rb(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["documents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["documents"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Mb extends Os{constructor(e){super(),this.apiClient=e,this.list=async t=>new Ea(Fs.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Ib(e);return r=V("{name}",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>l)}}async delete(e){var t,i;let s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=Tb(e);s=V("{name}",o._url),r=o._query,delete o._url,delete o._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Pb(e);return r=V("{parent}/documents",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=Rb(l),h=new lR;return Object.assign(h,u),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kb extends Os{constructor(e,t=new Mb(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new Ea(Fs.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=cb(e);return r=V("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>l)}}async get(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=fb(e);return r=V("{name}",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>l)}}async delete(e){var t,i;let s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=hb(e);s=V("{name}",o._url),r=o._query,delete o._url,delete o._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=_b(e);return r=V("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=Ab(l),h=new uR;return Object.assign(h,u),h})}}async uploadToFileSearchStoreInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Sb(e);return r=V("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=wb(l),h=new cR;return Object.assign(h,u),h})}}async importFile(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=mb(e);return r=V("{file_search_store_name}:importFile",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=gb(l),h=new qv;return Object.assign(h,u),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Nb(n,e){const t={},i=d(n,["name"]);return i!=null&&f(t,["_url","name"],i),t}function bb(n,e){const t={},i=d(n,["name"]);return i!=null&&f(t,["_url","name"],i),t}function Db(n,e,t){const i={};if(d(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=d(n,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&f(e,["displayName"],s),d(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=d(n,["epochCount"]);e!==void 0&&r!=null&&f(e,["tuningTask","hyperparameters","epochCount"],r);const o=d(n,["learningRateMultiplier"]);if(o!=null&&f(i,["tuningTask","hyperparameters","learningRateMultiplier"],o),d(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(d(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=d(n,["batchSize"]);e!==void 0&&a!=null&&f(e,["tuningTask","hyperparameters","batchSize"],a);const l=d(n,["learningRate"]);if(e!==void 0&&l!=null&&f(e,["tuningTask","hyperparameters","learningRate"],l),d(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(d(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function Lb(n,e,t){const i={};let s=d(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const m=d(n,["validationDataset"]);e!==void 0&&m!=null&&f(e,["supervisedTuningSpec"],YA(m))}else if(s==="PREFERENCE_TUNING"){const m=d(n,["validationDataset"]);e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec"],YA(m))}const r=d(n,["tunedModelDisplayName"]);e!==void 0&&r!=null&&f(e,["tunedModelDisplayName"],r);const o=d(n,["description"]);e!==void 0&&o!=null&&f(e,["description"],o);let a=d(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const m=d(n,["epochCount"]);e!==void 0&&m!=null&&f(e,["supervisedTuningSpec","hyperParameters","epochCount"],m)}else if(a==="PREFERENCE_TUNING"){const m=d(n,["epochCount"]);e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],m)}let l=d(t,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const m=d(n,["learningRateMultiplier"]);e!==void 0&&m!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],m)}else if(l==="PREFERENCE_TUNING"){const m=d(n,["learningRateMultiplier"]);e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],m)}let u=d(t,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const m=d(n,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&f(e,["supervisedTuningSpec","exportLastCheckpointOnly"],m)}else if(u==="PREFERENCE_TUNING"){const m=d(n,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],m)}let h=d(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const m=d(n,["adapterSize"]);e!==void 0&&m!=null&&f(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m)}else if(h==="PREFERENCE_TUNING"){const m=d(n,["adapterSize"]);e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],m)}if(d(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const p=d(n,["labels"]);e!==void 0&&p!=null&&f(e,["labels"],p);const g=d(n,["beta"]);return e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","beta"],g),i}function Fb(n,e){const t={},i=d(n,["baseModel"]);i!=null&&f(t,["baseModel"],i);const s=d(n,["preTunedModel"]);s!=null&&f(t,["preTunedModel"],s);const r=d(n,["trainingDataset"]);r!=null&&Yb(r);const o=d(n,["config"]);return o!=null&&Db(o,t),t}function Ub(n,e){const t={},i=d(n,["baseModel"]);i!=null&&f(t,["baseModel"],i);const s=d(n,["preTunedModel"]);s!=null&&f(t,["preTunedModel"],s);const r=d(n,["trainingDataset"]);r!=null&&Kb(r,t,e);const o=d(n,["config"]);return o!=null&&Lb(o,t,e),t}function Hb(n,e){const t={},i=d(n,["name"]);return i!=null&&f(t,["_url","name"],i),t}function Vb(n,e){const t={},i=d(n,["name"]);return i!=null&&f(t,["_url","name"],i),t}function Ob(n,e,t){const i={},s=d(n,["pageSize"]);e!==void 0&&s!=null&&f(e,["_query","pageSize"],s);const r=d(n,["pageToken"]);e!==void 0&&r!=null&&f(e,["_query","pageToken"],r);const o=d(n,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),i}function Gb(n,e,t){const i={},s=d(n,["pageSize"]);e!==void 0&&s!=null&&f(e,["_query","pageSize"],s);const r=d(n,["pageToken"]);e!==void 0&&r!=null&&f(e,["_query","pageToken"],r);const o=d(n,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),i}function Bb(n,e){const t={},i=d(n,["config"]);return i!=null&&Ob(i,t),t}function zb(n,e){const t={},i=d(n,["config"]);return i!=null&&Gb(i,t),t}function qb(n,e){const t={},i=d(n,["sdkHttpResponse"]);i!=null&&f(t,["sdkHttpResponse"],i);const s=d(n,["nextPageToken"]);s!=null&&f(t,["nextPageToken"],s);const r=d(n,["tunedModels"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>eC(a))),f(t,["tuningJobs"],o)}return t}function $b(n,e){const t={},i=d(n,["sdkHttpResponse"]);i!=null&&f(t,["sdkHttpResponse"],i);const s=d(n,["nextPageToken"]);s!=null&&f(t,["nextPageToken"],s);const r=d(n,["tuningJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>Dm(a))),f(t,["tuningJobs"],o)}return t}function Wb(n,e){const t={},i=d(n,["name"]);i!=null&&f(t,["model"],i);const s=d(n,["name"]);return s!=null&&f(t,["endpoint"],s),t}function Yb(n,e){const t={};if(d(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=d(n,["examples"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>r)),f(t,["examples","examples"],s)}return t}function Kb(n,e,t){const i={};let s=d(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=d(n,["gcsUri"]);e!==void 0&&o!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=d(n,["gcsUri"]);e!==void 0&&o!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let r=d(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const o=d(n,["vertexDatasetResource"]);e!==void 0&&o!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(r==="PREFERENCE_TUNING"){const o=d(n,["vertexDatasetResource"]);e!==void 0&&o!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(d(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function eC(n,e){const t={},i=d(n,["sdkHttpResponse"]);i!=null&&f(t,["sdkHttpResponse"],i);const s=d(n,["name"]);s!=null&&f(t,["name"],s);const r=d(n,["state"]);r!=null&&f(t,["state"],Lw(r));const o=d(n,["createTime"]);o!=null&&f(t,["createTime"],o);const a=d(n,["tuningTask","startTime"]);a!=null&&f(t,["startTime"],a);const l=d(n,["tuningTask","completeTime"]);l!=null&&f(t,["endTime"],l);const u=d(n,["updateTime"]);u!=null&&f(t,["updateTime"],u);const h=d(n,["description"]);h!=null&&f(t,["description"],h);const p=d(n,["baseModel"]);p!=null&&f(t,["baseModel"],p);const g=d(n,["_self"]);return g!=null&&f(t,["tunedModel"],Wb(g)),t}function Dm(n,e){const t={},i=d(n,["sdkHttpResponse"]);i!=null&&f(t,["sdkHttpResponse"],i);const s=d(n,["name"]);s!=null&&f(t,["name"],s);const r=d(n,["state"]);r!=null&&f(t,["state"],Lw(r));const o=d(n,["createTime"]);o!=null&&f(t,["createTime"],o);const a=d(n,["startTime"]);a!=null&&f(t,["startTime"],a);const l=d(n,["endTime"]);l!=null&&f(t,["endTime"],l);const u=d(n,["updateTime"]);u!=null&&f(t,["updateTime"],u);const h=d(n,["error"]);h!=null&&f(t,["error"],h);const p=d(n,["description"]);p!=null&&f(t,["description"],p);const g=d(n,["baseModel"]);g!=null&&f(t,["baseModel"],g);const m=d(n,["tunedModel"]);m!=null&&f(t,["tunedModel"],m);const y=d(n,["preTunedModel"]);y!=null&&f(t,["preTunedModel"],y);const A=d(n,["supervisedTuningSpec"]);A!=null&&f(t,["supervisedTuningSpec"],A);const T=d(n,["preferenceOptimizationSpec"]);T!=null&&f(t,["preferenceOptimizationSpec"],T);const _=d(n,["tuningDataStats"]);_!=null&&f(t,["tuningDataStats"],_);const E=d(n,["encryptionSpec"]);E!=null&&f(t,["encryptionSpec"],E);const C=d(n,["partnerModelTuningSpec"]);C!=null&&f(t,["partnerModelTuningSpec"],C);const I=d(n,["customBaseModel"]);I!=null&&f(t,["customBaseModel"],I);const x=d(n,["experiment"]);x!=null&&f(t,["experiment"],x);const R=d(n,["labels"]);R!=null&&f(t,["labels"],R);const P=d(n,["outputUri"]);P!=null&&f(t,["outputUri"],P);const M=d(n,["pipelineJob"]);M!=null&&f(t,["pipelineJob"],M);const k=d(n,["serviceAccount"]);k!=null&&f(t,["serviceAccount"],k);const N=d(n,["tunedModelDisplayName"]);N!=null&&f(t,["tunedModelDisplayName"],N);const L=d(n,["veoTuningSpec"]);return L!=null&&f(t,["veoTuningSpec"],L),t}function Jb(n,e){const t={},i=d(n,["sdkHttpResponse"]);i!=null&&f(t,["sdkHttpResponse"],i);const s=d(n,["name"]);s!=null&&f(t,["name"],s);const r=d(n,["metadata"]);r!=null&&f(t,["metadata"],r);const o=d(n,["done"]);o!=null&&f(t,["done"],o);const a=d(n,["error"]);return a!=null&&f(t,["error"],a),t}function YA(n,e){const t={},i=d(n,["gcsUri"]);i!=null&&f(t,["validationDatasetUri"],i);const s=d(n,["vertexDatasetResource"]);return s!=null&&f(t,["validationDatasetUri"],s),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xb extends Os{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Ea(Fs.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(s.checkpointId=t.config.preTunedModelCheckpointId);const r=Object.assign(Object.assign({},t),{preTunedModel:s});return r.baseModel=void 0,await this.tuneInternal(r)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),r=await this.tuneMldevInternal(s);let o="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?o=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(o=r.name.split("/operations/")[0]),{name:o,state:xm.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Vb(e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>Dm(h))}else{const u=Hb(e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>eC(h))}}async listInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=zb(e);return a=V("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=$b(h),g=new IA;return Object.assign(g,p),g})}else{const u=Bb(e);return a=V("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=qb(h),g=new IA;return Object.assign(g,p),g})}}async cancel(e){var t,i,s,r;let o="",a={};if(this.apiClient.isVertexAI()){const l=bb(e);o=V("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const l=Nb(e);o=V("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async tuneInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=Ub(e,e);return r=V("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>Dm(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Fb(e);return r=V("tunedModels",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>Jb(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qb{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Zb=1024*1024*8,jb=3,eD=1e3,tD=2,Qf="x-goog-upload-status";async function nD(n,e,t){var i;const s=await tC(n,e,t),r=await(s==null?void 0:s.json());if(((i=s==null?void 0:s.headers)===null||i===void 0?void 0:i[Qf])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return r.file}async function iD(n,e,t){var i;const s=await tC(n,e,t),r=await(s==null?void 0:s.json());if(((i=s==null?void 0:s.headers)===null||i===void 0?void 0:i[Qf])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=Rw(r),a=new $v;return Object.assign(a,o),a}async function tC(n,e,t){var i,s;let r=0,o=0,a=new Pm(new Response),l="upload";for(r=n.size;o<r;){const u=Math.min(Zb,r-o),h=n.slice(o,o+u);o+u>=r&&(l+=", finalize");let p=0,g=eD;for(;p<jb&&(a=await t.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(o),"Content-Length":String(u)}}}),!(!((i=a==null?void 0:a.headers)===null||i===void 0)&&i[Qf]));)p++,await rD(g),g=g*tD;if(o+=u,((s=a==null?void 0:a.headers)===null||s===void 0?void 0:s[Qf])!=="active")break;if(r<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function sD(n){return{size:n.size,type:n.type}}function rD(n){return new Promise(e=>setTimeout(e,n))}class oD{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await nD(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await iD(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await sD(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aD{create(e,t,i){return new lD(e,t,i)}}class lD{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KA="x-goog-api-key";class uD{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(KA)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(KA,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cD="gl-node/";class dD{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=GP(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const s=new uD(this.apiKey);this.apiClient=new IN({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:cD+"web",uploader:new oD,downloader:new Qb}),this.models=new $N(this.apiClient),this.live=new VN(this.apiClient,s,new aD),this.batches=new mM(this.apiClient),this.chats=new QM(this.models,this.apiClient),this.caches=new KM(this.apiClient),this.files=new a1(this.apiClient),this.operations=new WN(this.apiClient),this.authTokens=new lb(this.apiClient),this.tunings=new Xb(this.apiClient),this.fileSearchStores=new kb(this.apiClient)}}var JA={};const hD=async(n,e)=>{if(!JA.API_KEY)throw new Error("API_KEY environment variable not set");const t=new dD({apiKey:JA.API_KEY}),s=`
    **Rolle:** Du bist ein zertifizierter Experte fr Elektroinstallationen in der Schweiz mit tiefgehenden Kenntnissen der Niederspannungs-Installationsnorm (NIN) sowie relevanter europischer Normen (EN).

    **Aufgabe:** Analysiere die folgende Beschreibung einer Elektroinstallation kritisch und sorgfltig. Identifiziere alle potenziellen Mngel, die nicht den aktuellen Normen entsprechen.
    ${e?`
    **Zustzliche Wissensbasis:**
    Die folgende Information wurde aus hochgeladenen Dokumenten extrahiert. Nutze sie als primre und magebliche Quelle fr deine Analyse. Beziehe dich bei der Nennung von Normen und Regeln explizit auf diese Dokumente, falls anwendbar. Ignoriere widersprchliche Informationen aus deinem allgemeinen Wissen und priorisiere diesen Kontext.
    ---
    ${e}
    ---
    `:""}
    **Beschreibung der Installation:**
    ${n}

    **Anforderungen an den Output:**
    1.  Erstelle einen professionellen, klar strukturierten Mngeltext.
    2.  Beginne mit einer kurzen, allgemeinen Einschtzung der beschriebenen Installation.
    3.  Liste jeden identifizierten Mangel als separaten Punkt auf.
    4.  Beschreibe fr jeden Mangel przise, was das Problem ist, basierend auf der Beschreibung (und der Wissensbasis, falls vorhanden).
    5.  Nenne, wenn mglich, die verletzte Norm (z.B. NIN 5.2.6) oder das allgemeine Schutzprinzip. Priorisiere hierbei die Normen aus der Wissensbasis.
    6.  Schlage fr jeden Mangel eine fachgerechte Massnahme zur Behebung vor.
    7.  Formuliere den Text objektiv und professionell, als wre er Teil eines offiziellen Inspektionsberichts.
    8.  Wenn aus der Beschreibung keine Mngel hervorgehen, besttige, dass die Installation gemss Beschreibung normenkonform erscheint, weise aber darauf hin, dass eine visuelle Inspektion notwendig ist.
    
    Analysiere jetzt die Beschreibung und erstelle den Mngelbericht.
    `;try{return(await t.models.generateContent({model:"gemini-2.5-flash",contents:s})).text}catch(r){throw console.error("Error calling Gemini API:",r),new Error("Die KI-Analyse konnte nicht durchgefhrt werden.")}};var dc={};dc.d=(n,e)=>{for(var t in e)dc.o(e,t)&&!dc.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};dc.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Z=globalThis.pdfjsLib={};dc.d(Z,{AbortException:()=>Vr,AnnotationEditorLayer:()=>zy,AnnotationEditorParamsType:()=>ue,AnnotationEditorType:()=>ee,AnnotationEditorUIManager:()=>ma,AnnotationLayer:()=>aF,AnnotationMode:()=>Ks,ColorPicker:()=>ip,DOMSVGFactory:()=>r0,DrawLayer:()=>Wy,FeatureTest:()=>$t,GlobalWorkerOptions:()=>Is,ImageKind:()=>Yh,InvalidPDFException:()=>Fm,MissingPDFException:()=>Mc,OPS:()=>jn,OutputScale:()=>Hm,PDFDataRangeTransport:()=>iT,PDFDateString:()=>t0,PDFWorker:()=>il,PasswordResponses:()=>mD,PermissionFlag:()=>gD,PixelsPerInch:()=>Or,RenderingCancelledException:()=>jv,TextLayer:()=>kc,TouchManager:()=>tp,UnexpectedResponseException:()=>Zf,Util:()=>W,VerbosityLevel:()=>$p,XfaLayer:()=>rT,build:()=>GL,createValidAbsoluteUrl:()=>AD,fetchData:()=>Jp,getDocument:()=>NL,getFilenameFromUrl:()=>RD,getPdfFilenameFromUrl:()=>MD,getXfaPageViewport:()=>kD,isDataScheme:()=>Xp,isPdfFile:()=>e0,noContextMenu:()=>vi,normalizeUnicode:()=>ID,setLayerDimensions:()=>ga,shadow:()=>oe,stopEvent:()=>Tn,version:()=>OL});const Dt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),nC=[1,0,0,1,0,0],Lm=[.001,0,0,.001,0,0],fD=1e7,Ig=1.35,Sn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ks={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},pD="pdfjs_internal_editor_",ee={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},ue={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},gD={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Tt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Yh={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Ze={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},ku={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},$p={ERRORS:0,WARNINGS:1,INFOS:5},jn={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},mD={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Wp=$p.WARNINGS;function yD(n){Number.isInteger(n)&&(Wp=n)}function vD(){return Wp}function Yp(n){Wp>=$p.INFOS&&console.log(`Info: ${n}`)}function te(n){Wp>=$p.WARNINGS&&console.log(`Warning: ${n}`)}function Se(n){throw new Error(n)}function Xe(n,e){n||Se(e)}function _D(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function AD(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=TD(n)}catch{}}const i=e?new URL(n,e):new URL(n);if(_D(i))return i}catch{}return null}function oe(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const Wr=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class XA extends Wr{constructor(e,t){super(e,"PasswordException"),this.code=t}}class xg extends Wr{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Fm extends Wr{constructor(e){super(e,"InvalidPDFException")}}class Mc extends Wr{constructor(e){super(e,"MissingPDFException")}}class Zf extends Wr{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class ED extends Wr{constructor(e){super(e,"FormatError")}}class Vr extends Wr{constructor(e){super(e,"AbortException")}}function iC(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Se("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),o=n.subarray(s,r);i.push(String.fromCharCode.apply(null,o))}return i.join("")}function Kp(n){typeof n!="string"&&Se("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function SD(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function Qv(n){const e=Object.create(null);for(const[t,i]of n)e[t]=i;return e}function wD(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function CD(){try{return new Function(""),!0}catch{return!1}}class $t{static get isLittleEndian(){return oe(this,"isLittleEndian",wD())}static get isEvalSupported(){return oe(this,"isEvalSupported",CD())}static get isOffscreenCanvasSupported(){return oe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return oe(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?oe(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):oe(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return oe(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Pg=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Ms,Kh,Um;class W{static makeHexColor(e,t,i){return`#${Pg[e]}${Pg[t]}${Pg[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const i=e[0]*t[0]+e[1]*t[2]+t[4],s=e[0]*t[1]+e[1]*t[3]+t[5];return[i,s]}static applyInverseTransform(e,t){const i=t[0]*t[3]-t[1]*t[2],s=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/i,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/i;return[s,r]}static getAxialAlignedBoundingBox(e,t){const i=this.applyTransform(e,t),s=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),o=this.applyTransform([e[2],e[1]],t);return[Math.min(i[0],s[0],r[0],o[0]),Math.min(i[1],s[1],r[1],o[1]),Math.max(i[0],s[0],r[0],o[0]),Math.max(i[1],s[1],r[1],o[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],i=e[0]*t[0]+e[1]*t[2],s=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],a=(i+o)/2,l=Math.sqrt((i+o)**2-4*(i*o-r*s))/2,u=a+l||1,h=a-l||1;return[Math.sqrt(u),Math.sqrt(h)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>o?null:[i,r,s,o]}static bezierBoundingBox(e,t,i,s,r,o,a,l,u){return u?(u[0]=Math.min(u[0],e,a),u[1]=Math.min(u[1],t,l),u[2]=Math.max(u[2],e,a),u[3]=Math.max(u[3],t,l)):u=[Math.min(e,a),Math.min(t,l),Math.max(e,a),Math.max(t,l)],w(this,Ms,Um).call(this,e,i,r,a,t,s,o,l,3*(-e+3*(i-r)+a),6*(e-2*i+r),3*(i-e),u),w(this,Ms,Um).call(this,e,i,r,a,t,s,o,l,3*(-t+3*(s-o)+l),6*(t-2*s+o),3*(s-t),u),u}}Ms=new WeakSet,Kh=function(e,t,i,s,r,o,a,l,u,h){if(u<=0||u>=1)return;const p=1-u,g=u*u,m=g*u,y=p*(p*(p*e+3*u*t)+3*g*i)+m*s,A=p*(p*(p*r+3*u*o)+3*g*a)+m*l;h[0]=Math.min(h[0],y),h[1]=Math.min(h[1],A),h[2]=Math.max(h[2],y),h[3]=Math.max(h[3],A)},Um=function(e,t,i,s,r,o,a,l,u,h,p,g){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&w(this,Ms,Kh).call(this,e,t,i,s,r,o,a,l,-p/h,g);return}const m=h**2-4*p*u;if(m<0)return;const y=Math.sqrt(m),A=2*u;w(this,Ms,Kh).call(this,e,t,i,s,r,o,a,l,(-h+y)/A,g),w(this,Ms,Kh).call(this,e,t,i,s,r,o,a,l,(-h-y)/A,g)},S(W,Ms);function TD(n){return decodeURIComponent(escape(n))}let Rg=null,QA=null;function ID(n){return Rg||(Rg=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,QA=new Map([["","t"]])),n.replaceAll(Rg,(e,t,i)=>t?t.normalize("NFKC"):QA.get(i))}function xD(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),iC(n)}const Zv="pdfjs_internal_id_";function PD(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(iC(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const Ki="http://www.w3.org/2000/svg",Zr=class Zr{};J(Zr,"CSS",96),J(Zr,"PDF",72),J(Zr,"PDF_TO_CSS_UNITS",Zr.CSS/Zr.PDF);let Or=Zr;async function Jp(n,e="text"){if(Vu(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class uh{constructor({viewBox:e,userUnit:t,scale:i,rotation:s,offsetX:r=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=s,this.offsetX=r,this.offsetY=o,i*=t;const l=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let h,p,g,m;switch(s%=360,s<0&&(s+=360),s){case 180:h=-1,p=0,g=0,m=1;break;case 90:h=0,p=1,g=1,m=0;break;case 270:h=0,p=-1,g=-1,m=0;break;case 0:h=1,p=0,g=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(g=-g,m=-m);let y,A,T,_;h===0?(y=Math.abs(u-e[1])*i+r,A=Math.abs(l-e[0])*i+o,T=(e[3]-e[1])*i,_=(e[2]-e[0])*i):(y=Math.abs(l-e[0])*i+r,A=Math.abs(u-e[1])*i+o,T=(e[2]-e[0])*i,_=(e[3]-e[1])*i),this.transform=[h*i,p*i,g*i,m*i,y-h*i*l-g*i*u,A-p*i*l-m*i*u],this.width=T,this.height=_}get rawDims(){const{userUnit:e,viewBox:t}=this,i=t.map(s=>s*e);return oe(this,"rawDims",{pageWidth:i[2]-i[0],pageHeight:i[3]-i[1],pageX:i[0],pageY:i[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new uh({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(e,t){return W.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=W.applyTransform([e[0],e[1]],this.transform),i=W.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){return W.applyInverseTransform([e,t],this.transform)}}class jv extends Wr{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Xp(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function e0(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function RD(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function MD(n,e="document.pdf"){if(typeof n!="string")return e;if(Xp(n))return te('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=t.exec(n);let r=i.exec(s[1])||i.exec(s[2])||i.exec(s[3]);if(r&&(r=r[0],r.includes("%")))try{r=i.exec(decodeURIComponent(r))[0]}catch{}return r||e}class ZA{constructor(){J(this,"started",Object.create(null));J(this,"times",[])}time(e){e in this.started&&te(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||te(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:s,end:r}of this.times)e.push(`${i.padEnd(t)} ${r-s}ms
`);return e.join("")}}function Vu(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function vi(n){n.preventDefault()}function Tn(n){n.preventDefault(),n.stopPropagation()}var bc;class t0{static toDateObject(e){if(!e||typeof e!="string")return null;c(this,bc)||v(this,bc,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=c(this,bc).exec(e);if(!t)return null;const i=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const u=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let p=parseInt(t[9],10)||0;return p=p>=0&&p<=59?p:0,u==="-"?(o+=h,a+=p):u==="+"&&(o-=h,a-=p),new Date(Date.UTC(i,s,r,o,a,l))}}bc=new WeakMap,S(t0,bc);function kD(n,{scale:e=1,rotation:t=0}){const{width:i,height:s}=n.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new uh({viewBox:r,userUnit:1,scale:e,rotation:t})}function n0(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(te(`Not a valid color format: "${n}"`),[0,0,0])}function ND(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,n0(i))}e.remove()}function ke(n){const{a:e,b:t,c:i,d:s,e:r,f:o}=n.getTransform();return[e,t,i,s,r,o]}function Si(n){const{a:e,b:t,c:i,d:s,e:r,f:o}=n.getTransform().invertSelf();return[e,t,i,s,r,o]}function ga(n,e,t=!1,i=!0){if(e instanceof uh){const{pageWidth:s,pageHeight:r}=e.rawDims,{style:o}=n,a=$t.isCSSRoundSupported,l=`var(--scale-factor) * ${s}px`,u=`var(--scale-factor) * ${r}px`,h=a?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,p=a?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!t||e.rotation%180===0?(o.width=h,o.height=p):(o.width=p,o.height=h)}i&&n.setAttribute("data-main-rotation",e.rotation)}class Hm{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Js,io,ei,so,Dc,Lc,op,sC,Wt,rC,oC,Jh,aC,Om;const Zi=class Zi{constructor(e){S(this,Wt);S(this,Js,null);S(this,io,null);S(this,ei);S(this,so,null);S(this,Dc,null);v(this,ei,e),c(Zi,Lc)||v(Zi,Lc,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=v(this,Js,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=c(this,ei)._uiManager._signal;e.addEventListener("contextmenu",vi,{signal:t}),e.addEventListener("pointerdown",w(Zi,op,sC),{signal:t});const i=v(this,so,document.createElement("div"));i.className="buttons",e.append(i);const s=c(this,ei).toolbarPosition;if(s){const{style:r}=e,o=c(this,ei)._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*o}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return w(this,Wt,aC).call(this),e}get div(){return c(this,Js)}hide(){var e;c(this,Js).classList.add("hidden"),(e=c(this,io))==null||e.hideDropdown()}show(){var e;c(this,Js).classList.remove("hidden"),(e=c(this,Dc))==null||e.shown()}async addAltText(e){const t=await e.render();w(this,Wt,Jh).call(this,t),c(this,so).prepend(t,c(this,Wt,Om)),v(this,Dc,e)}addColorPicker(e){v(this,io,e);const t=e.renderButton();w(this,Wt,Jh).call(this,t),c(this,so).prepend(t,c(this,Wt,Om))}remove(){var e;c(this,Js).remove(),(e=c(this,io))==null||e.destroy(),v(this,io,null)}};Js=new WeakMap,io=new WeakMap,ei=new WeakMap,so=new WeakMap,Dc=new WeakMap,Lc=new WeakMap,op=new WeakSet,sC=function(e){e.stopPropagation()},Wt=new WeakSet,rC=function(e){c(this,ei)._focusEventsAllowed=!1,Tn(e)},oC=function(e){c(this,ei)._focusEventsAllowed=!0,Tn(e)},Jh=function(e){const t=c(this,ei)._uiManager._signal;e.addEventListener("focusin",w(this,Wt,rC).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",w(this,Wt,oC).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",vi,{signal:t})},aC=function(){const{editorType:e,_uiManager:t}=c(this,ei),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",c(Zi,Lc)[e]),w(this,Wt,Jh).call(this,i),i.addEventListener("click",s=>{t.delete()},{signal:t._signal}),c(this,so).append(i)},Om=function(){const e=document.createElement("div");return e.className="divider",e},S(Zi,op),S(Zi,Lc,null);let Vm=Zi;var Fc,ro,oo,Gr,lC,uC,cC;class bD{constructor(e){S(this,Gr);S(this,Fc,null);S(this,ro,null);S(this,oo);v(this,oo,e)}show(e,t,i){const[s,r]=w(this,Gr,uC).call(this,t,i),{style:o}=c(this,ro)||v(this,ro,w(this,Gr,lC).call(this));e.append(c(this,ro)),o.insetInlineEnd=`${100*s}%`,o.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){c(this,ro).remove()}}Fc=new WeakMap,ro=new WeakMap,oo=new WeakMap,Gr=new WeakSet,lC=function(){const e=v(this,ro,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",vi,{signal:c(this,oo)._signal});const t=v(this,Fc,document.createElement("div"));return t.className="buttons",e.append(t),w(this,Gr,cC).call(this),e},uC=function(e,t){let i=0,s=0;for(const r of e){const o=r.y+r.height;if(o<i)continue;const a=r.x+(t?r.width:0);if(o>i){s=a,i=o;continue}t?a>s&&(s=a):a<s&&(s=a)}return[t?1-s:s,i]},cC=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=c(this,oo)._signal;e.addEventListener("contextmenu",vi,{signal:i}),e.addEventListener("click",()=>{c(this,oo).highlightSelection("floating_button")},{signal:i}),c(this,Fc).append(e)};function jf(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}var ap;class DD{constructor(){S(this,ap,0)}get id(){return`${pD}${Ut(this,ap)._++}`}}ap=new WeakMap;var sl,Uc,Pt,rl,Xh;const a0=class a0{constructor(){S(this,rl);S(this,sl,xD());S(this,Uc,0);S(this,Pt,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const r=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return oe(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:i,size:s,type:r}=e;return w(this,rl,Xh).call(this,`${t}_${i}_${s}_${r}`,e)}async getFromUrl(e){return w(this,rl,Xh).call(this,e,e)}async getFromBlob(e,t){const i=await t;return w(this,rl,Xh).call(this,e,i)}async getFromId(e){c(this,Pt)||v(this,Pt,new Map);const t=c(this,Pt).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){c(this,Pt)||v(this,Pt,new Map);let i=c(this,Pt).get(e);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${c(this,sl)}_${Ut(this,Uc)._++}`,refCounter:1,isSvg:!1},c(this,Pt).set(e,i),c(this,Pt).set(i.id,i),i}getSvgUrl(e){const t=c(this,Pt).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;c(this,Pt)||v(this,Pt,new Map);const t=c(this,Pt).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}(s=i.close)==null||s.call(i),t.bitmap=null}isValidId(e){return e.startsWith(`image_${c(this,sl)}_`)}};sl=new WeakMap,Uc=new WeakMap,Pt=new WeakMap,rl=new WeakSet,Xh=async function(e,t){c(this,Pt)||v(this,Pt,new Map);let i=c(this,Pt).get(e);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${c(this,sl)}_${Ut(this,Uc)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(i.url=t,s=await Jp(t,"blob")):t instanceof File?s=i.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const r=a0._isSVGFittingCanvas,o=new FileReader,a=new Image,l=new Promise((u,h)=>{a.onload=()=>{i.bitmap=a,i.isSvg=!0,u()},o.onload=async()=>{const p=i.svgUrl=o.result;a.src=await r?`${p}#svgView(preserveAspectRatio(none))`:p},a.onerror=o.onerror=h});o.readAsDataURL(s),await l}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){te(s),i=null}return c(this,Pt).set(e,i),i&&c(this,Pt).set(i.id,i),i};let Gm=a0;var qe,Xs,Hc,Le;class LD{constructor(e=128){S(this,qe,[]);S(this,Xs,!1);S(this,Hc);S(this,Le,-1);v(this,Hc,e)}add({cmd:e,undo:t,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(s&&e(),c(this,Xs))return;const l={cmd:e,undo:t,post:i,type:r};if(c(this,Le)===-1){c(this,qe).length>0&&(c(this,qe).length=0),v(this,Le,0),c(this,qe).push(l);return}if(o&&c(this,qe)[c(this,Le)].type===r){a&&(l.undo=c(this,qe)[c(this,Le)].undo),c(this,qe)[c(this,Le)]=l;return}const u=c(this,Le)+1;u===c(this,Hc)?c(this,qe).splice(0,1):(v(this,Le,u),u<c(this,qe).length&&c(this,qe).splice(u)),c(this,qe).push(l)}undo(){if(c(this,Le)===-1)return;v(this,Xs,!0);const{undo:e,post:t}=c(this,qe)[c(this,Le)];e(),t==null||t(),v(this,Xs,!1),v(this,Le,c(this,Le)-1)}redo(){if(c(this,Le)<c(this,qe).length-1){v(this,Le,c(this,Le)+1),v(this,Xs,!0);const{cmd:e,post:t}=c(this,qe)[c(this,Le)];e(),t==null||t(),v(this,Xs,!1)}}hasSomethingToUndo(){return c(this,Le)!==-1}hasSomethingToRedo(){return c(this,Le)<c(this,qe).length-1}cleanType(e){if(c(this,Le)!==-1){for(let t=c(this,Le);t>=0;t--)if(c(this,qe)[t].type!==e){c(this,qe).splice(t+1,c(this,Le)-t),v(this,Le,t);return}c(this,qe).length=0,v(this,Le,-1)}}destroy(){v(this,qe,null)}}qe=new WeakMap,Xs=new WeakMap,Hc=new WeakMap,Le=new WeakMap;var lp,dC;class ch{constructor(e){S(this,lp);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=$t.platform;for(const[i,s,r={}]of e)for(const o of i){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:s,options:r}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:s,options:r}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(w(this,lp,dC).call(this,t));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:o=[],checker:a=null}}=i;a&&!a(e,t)||(s.bind(e,...o,t)(),r||Tn(t))}}lp=new WeakSet,dC=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const up=class up{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return ND(e),oe(this,"_colors",e)}convert(e){const t=n0(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,s]of this._colors)if(s.every((r,o)=>r===t[o]))return up._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?W.makeHexColor(...t):e}};J(up,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Bm=up;var ol,cn,et,pt,al,ts,ll,bn,Qs,ao,ul,lo,Ii,ti,uo,Vc,Oc,cl,Gc,xi,Zs,dl,js,Pi,cp,er,Bc,tr,co,zc,qc,ot,ye,ns,ho,$c,Wc,nr,Ri,is,Yc,Dn,H,Qh,zm,hC,fC,Zh,pC,gC,mC,qm,yC,$m,Wm,vC,Ht,Ji,_C,AC,Ym,EC,Ou,Km;const $a=class $a{constructor(e,t,i,s,r,o,a,l,u,h,p,g,m){S(this,H);S(this,ol,new AbortController);S(this,cn,null);S(this,et,new Map);S(this,pt,new Map);S(this,al,null);S(this,ts,null);S(this,ll,null);S(this,bn,new LD);S(this,Qs,null);S(this,ao,null);S(this,ul,0);S(this,lo,new Set);S(this,Ii,null);S(this,ti,null);S(this,uo,new Set);J(this,"_editorUndoBar",null);S(this,Vc,!1);S(this,Oc,!1);S(this,cl,!1);S(this,Gc,null);S(this,xi,null);S(this,Zs,null);S(this,dl,null);S(this,js,!1);S(this,Pi,null);S(this,cp,new DD);S(this,er,!1);S(this,Bc,!1);S(this,tr,null);S(this,co,null);S(this,zc,null);S(this,qc,null);S(this,ot,ee.NONE);S(this,ye,new Set);S(this,ns,null);S(this,ho,null);S(this,$c,null);S(this,Wc,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});S(this,nr,[0,0]);S(this,Ri,null);S(this,is,null);S(this,Yc,null);S(this,Dn,null);const y=this._signal=c(this,ol).signal;v(this,is,e),v(this,Yc,t),v(this,al,i),this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:y}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:y}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:y}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:y}),s._on("setpreference",this.onSetPreference.bind(this),{signal:y}),s._on("switchannotationeditorparams",A=>this.updateParams(A.type,A.value),{signal:y}),w(this,H,pC).call(this),w(this,H,vC).call(this),w(this,H,qm).call(this),v(this,ts,r.annotationStorage),v(this,Gc,r.filterFactory),v(this,ho,o),v(this,dl,a||null),v(this,Vc,l),v(this,Oc,u),v(this,cl,h),v(this,qc,p||null),this.viewParameters={realScale:Or.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=g||null,this._supportsPinchToZoom=m!==!1}static get _keyboardManager(){const e=$a.prototype,t=o=>c(o,is).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),i=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:l}=a;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return oe(this,"_keyboardManager",new ch([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&c(o,is).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&c(o,is).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,i,s,r;(e=c(this,Dn))==null||e.resolve(),v(this,Dn,null),(t=c(this,ol))==null||t.abort(),v(this,ol,null),this._signal=null;for(const o of c(this,pt).values())o.destroy();c(this,pt).clear(),c(this,et).clear(),c(this,uo).clear(),v(this,cn,null),c(this,ye).clear(),c(this,bn).destroy(),(i=c(this,al))==null||i.destroy(),(s=c(this,Pi))==null||s.hide(),v(this,Pi,null),c(this,xi)&&(clearTimeout(c(this,xi)),v(this,xi,null)),c(this,Ri)&&(clearTimeout(c(this,Ri)),v(this,Ri,null)),(r=this._editorUndoBar)==null||r.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return c(this,qc)}get useNewAltTextFlow(){return c(this,Oc)}get useNewAltTextWhenAddingImage(){return c(this,cl)}get hcmFilter(){return oe(this,"hcmFilter",c(this,ho)?c(this,Gc).addHCMFilter(c(this,ho).foreground,c(this,ho).background):"none")}get direction(){return oe(this,"direction",getComputedStyle(c(this,is)).direction)}get highlightColors(){return oe(this,"highlightColors",c(this,dl)?new Map(c(this,dl).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return oe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),v(this,ao,e)}setMainHighlightColorPicker(e){v(this,zc,e)}editAltText(e,t=!1){var i;(i=c(this,al))==null||i.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":v(this,cl,t);break}}onPageChanging({pageNumber:e}){v(this,ul,e-1)}focusMainContainer(){c(this,is).focus()}findParent(e,t){for(const i of c(this,pt).values()){const{x:s,y:r,width:o,height:a}=i.div.getBoundingClientRect();if(e>=s&&e<=s+o&&t>=r&&t<=r+a)return i}return null}disableUserSelect(e=!1){c(this,Yc).classList.toggle("noUserSelect",e)}addShouldRescale(e){c(this,uo).add(e)}removeShouldRescale(e){c(this,uo).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Or.PDF_TO_CSS_UNITS;for(const i of c(this,uo))i.onScaleChanging();(t=c(this,ao))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:o}=t,a=t.toString(),u=w(this,H,Qh).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(u);if(!h)return;t.empty();const p=w(this,H,zm).call(this,u),g=c(this,ot)===ee.NONE,m=()=>{p==null||p.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:o,text:a}),g&&this.showAllEditors("highlight",!0,!0)};if(g){this.switchToMode(ee.HIGHLIGHT,m);return}m()}addToAnnotationStorage(e){!e.isEmpty()&&c(this,ts)&&!c(this,ts).has(e.id)&&c(this,ts).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,c(this,js)&&(v(this,js,!1),w(this,H,Zh).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of c(this,ye))if(t.div.contains(e)){v(this,co,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!c(this,co))return;const[e,t]=c(this,co);v(this,co,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){w(this,H,qm).call(this),w(this,H,$m).call(this)}removeEditListeners(){w(this,H,yC).call(this),w(this,H,Wm).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of c(this,ti))if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of c(this,ti))if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var i;if(e.preventDefault(),(i=c(this,cn))==null||i.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of c(this,ye)){const r=s.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const o of c(this,ti))if(o.isHandlingMimeForPasting(r.type)){o.paste(r,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){te(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const l of i){const u=await s.deserialize(l);if(!u)return;r.push(u)}const o=()=>{for(const l of r)w(this,H,Ym).call(this,l);w(this,H,Km).call(this,r)},a=()=>{for(const l of r)l.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(r){te(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),c(this,ot)!==ee.NONE&&!this.isEditorHandlingKeyboard&&$a._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,c(this,js)&&(v(this,js,!1),w(this,H,Zh).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(w(this,H,gC).call(this),w(this,H,$m).call(this),w(this,H,Ht).call(this,{isEditing:c(this,ot)!==ee.NONE,isEmpty:w(this,H,Ou).call(this),hasSomethingToUndo:c(this,bn).hasSomethingToUndo(),hasSomethingToRedo:c(this,bn).hasSomethingToRedo(),hasSelectedEditor:!1})):(w(this,H,mC).call(this),w(this,H,Wm).call(this),w(this,H,Ht).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!c(this,ti)){v(this,ti,e);for(const t of c(this,ti))w(this,H,Ji).call(this,t.defaultPropertiesToUpdate)}}getId(){return c(this,cp).id}get currentLayer(){return c(this,pt).get(c(this,ul))}getLayer(e){return c(this,pt).get(e)}get currentPageIndex(){return c(this,ul)}addLayer(e){c(this,pt).set(e.pageIndex,e),c(this,er)?e.enable():e.disable()}removeLayer(e){c(this,pt).delete(e.pageIndex)}async updateMode(e,t=null,i=!1){var s;if(c(this,ot)!==e&&!(c(this,Dn)&&(await c(this,Dn).promise,!c(this,Dn)))){if(v(this,Dn,Promise.withResolvers()),v(this,ot,e),e===ee.NONE){this.setEditingState(!1),w(this,H,AC).call(this),(s=this._editorUndoBar)==null||s.hide(),c(this,Dn).resolve();return}this.setEditingState(!0),await w(this,H,_C).call(this),this.unselectAll();for(const r of c(this,pt).values())r.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),c(this,Dn).resolve();return}for(const r of c(this,et).values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();c(this,Dn).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==c(this,ot)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var i;if(c(this,ti)){switch(e){case ue.CREATE:this.currentLayer.addNewEditor();return;case ue.HIGHLIGHT_DEFAULT_COLOR:(i=c(this,zc))==null||i.updateColor(t);break;case ue.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(c(this,$c)||v(this,$c,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const s of c(this,ye))s.updateParams(e,t);for(const s of c(this,ti))s.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){var r;for(const o of c(this,et).values())o.editorType===e&&o.show(t);(((r=c(this,$c))==null?void 0:r.get(ue.HIGHLIGHT_SHOW_ALL))??!0)!==t&&w(this,H,Ji).call(this,[[ue.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(c(this,Bc)!==e){v(this,Bc,e);for(const t of c(this,pt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const i of c(this,et).values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return c(this,et).get(e)}addEditor(e){c(this,et).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(c(this,xi)&&clearTimeout(c(this,xi)),v(this,xi,setTimeout(()=>{this.focusMainContainer(),v(this,xi,null)},0))),c(this,et).delete(e.id),this.unselect(e),(!e.annotationElementId||!c(this,lo).has(e.annotationElementId))&&((t=c(this,ts))==null||t.remove(e.id))}addDeletedAnnotationElement(e){c(this,lo).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return c(this,lo).has(e)}removeDeletedAnnotationElement(e){c(this,lo).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){c(this,cn)!==e&&(v(this,cn,e),e&&w(this,H,Ji).call(this,e.propertiesToUpdate))}updateUI(e){c(this,H,EC)===e&&w(this,H,Ji).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){w(this,H,Ji).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(c(this,ye).has(e)){c(this,ye).delete(e),e.unselect(),w(this,H,Ht).call(this,{hasSelectedEditor:this.hasSelection});return}c(this,ye).add(e),e.select(),w(this,H,Ji).call(this,e.propertiesToUpdate),w(this,H,Ht).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=c(this,ao))==null||t.commitOrRemove();for(const i of c(this,ye))i!==e&&i.unselect();c(this,ye).clear(),c(this,ye).add(e),e.select(),w(this,H,Ji).call(this,e.propertiesToUpdate),w(this,H,Ht).call(this,{hasSelectedEditor:!0})}isSelected(e){return c(this,ye).has(e)}get firstSelectedEditor(){return c(this,ye).values().next().value}unselect(e){e.unselect(),c(this,ye).delete(e),w(this,H,Ht).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return c(this,ye).size!==0}get isEnterHandled(){return c(this,ye).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;c(this,bn).undo(),w(this,H,Ht).call(this,{hasSomethingToUndo:c(this,bn).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:w(this,H,Ou).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){c(this,bn).redo(),w(this,H,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:c(this,bn).hasSomethingToRedo(),isEmpty:w(this,H,Ou).call(this)})}addCommands(e){c(this,bn).add(e),w(this,H,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:w(this,H,Ou).call(this)})}cleanUndoStack(e){c(this,bn).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...c(this,ye)],i=()=>{var o;(o=this._editorUndoBar)==null||o.show(s,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},s=()=>{for(const o of t)w(this,H,Ym).call(this,o)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=c(this,cn))==null||e.commitOrRemove()}hasSomethingToControl(){return c(this,cn)||this.hasSelection}selectAll(){for(const e of c(this,ye))e.commit();w(this,H,Km).call(this,c(this,et).values())}unselectAll(){var e;if(!(c(this,cn)&&(c(this,cn).commitOrRemove(),c(this,ot)!==ee.NONE))&&!((e=c(this,ao))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of c(this,ye))t.unselect();c(this,ye).clear(),w(this,H,Ht).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;c(this,nr)[0]+=e,c(this,nr)[1]+=t;const[s,r]=c(this,nr),o=[...c(this,ye)],a=1e3;c(this,Ri)&&clearTimeout(c(this,Ri)),v(this,Ri,setTimeout(()=>{v(this,Ri,null),c(this,nr)[0]=c(this,nr)[1]=0,this.addCommands({cmd:()=>{for(const l of o)c(this,et).has(l.id)&&l.translateInPage(s,r)},undo:()=>{for(const l of o)c(this,et).has(l.id)&&l.translateInPage(-s,-r)},mustExec:!1})},a));for(const l of o)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),v(this,Ii,new Map);for(const e of c(this,ye))c(this,Ii).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!c(this,Ii))return!1;this.disableUserSelect(!1);const e=c(this,Ii);v(this,Ii,null);let t=!1;for(const[{x:s,y:r,pageIndex:o},a]of e)a.newX=s,a.newY=r,a.newPageIndex=o,t||(t=s!==a.savedX||r!==a.savedY||o!==a.savedPageIndex);if(!t)return!1;const i=(s,r,o,a)=>{if(c(this,et).has(s.id)){const l=c(this,pt).get(a);l?s._setParentAndPosition(l,r,o):(s.pageIndex=a,s.x=r,s.y=o)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:o,newPageIndex:a}]of e)i(s,r,o,a)},undo:()=>{for(const[s,{savedX:r,savedY:o,savedPageIndex:a}]of e)i(s,r,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(c(this,Ii))for(const i of c(this,Ii).keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||c(this,ye).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return c(this,cn)===e}getActive(){return c(this,cn)}getMode(){return c(this,ot)}get imageManager(){return oe(this,"imageManager",new Gm)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,h=t.rangeCount;u<h;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(u,h,p,g)=>({x:(h-s)/o,y:1-(u+p-i)/r,width:g/o,height:p/r});break;case"180":a=(u,h,p,g)=>({x:1-(u+p-i)/r,y:1-(h+g-s)/o,width:p/r,height:g/o});break;case"270":a=(u,h,p,g)=>({x:1-(h+g-s)/o,y:(u-i)/r,width:g/o,height:p/r});break;default:a=(u,h,p,g)=>({x:(u-i)/r,y:(h-s)/o,width:p/r,height:g/o});break}const l=[];for(let u=0,h=t.rangeCount;u<h;u++){const p=t.getRangeAt(u);if(!p.collapsed)for(const{x:g,y:m,width:y,height:A}of p.getClientRects())y===0||A===0||l.push(a(g,m,y,A))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(c(this,ll)||v(this,ll,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=c(this,ll))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=c(this,ll))==null?void 0:s.get(e.data.id);if(!t)return;const i=c(this,ts).getRawValue(t);i&&(c(this,ot)===ee.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}};ol=new WeakMap,cn=new WeakMap,et=new WeakMap,pt=new WeakMap,al=new WeakMap,ts=new WeakMap,ll=new WeakMap,bn=new WeakMap,Qs=new WeakMap,ao=new WeakMap,ul=new WeakMap,lo=new WeakMap,Ii=new WeakMap,ti=new WeakMap,uo=new WeakMap,Vc=new WeakMap,Oc=new WeakMap,cl=new WeakMap,Gc=new WeakMap,xi=new WeakMap,Zs=new WeakMap,dl=new WeakMap,js=new WeakMap,Pi=new WeakMap,cp=new WeakMap,er=new WeakMap,Bc=new WeakMap,tr=new WeakMap,co=new WeakMap,zc=new WeakMap,qc=new WeakMap,ot=new WeakMap,ye=new WeakMap,ns=new WeakMap,ho=new WeakMap,$c=new WeakMap,Wc=new WeakMap,nr=new WeakMap,Ri=new WeakMap,is=new WeakMap,Yc=new WeakMap,Dn=new WeakMap,H=new WeakSet,Qh=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},zm=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of c(this,pt).values())if(i.hasTextLayer(e))return i;return null},hC=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=w(this,H,Qh).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(c(this,Pi)||v(this,Pi,new bD(this)),c(this,Pi).show(i,s,this.direction==="ltr"))},fC=function(){var r,o,a;const e=document.getSelection();if(!e||e.isCollapsed){c(this,ns)&&((r=c(this,Pi))==null||r.hide(),v(this,ns,null),w(this,H,Ht).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===c(this,ns))return;const s=w(this,H,Qh).call(this,e).closest(".textLayer");if(!s){c(this,ns)&&((o=c(this,Pi))==null||o.hide(),v(this,ns,null),w(this,H,Ht).call(this,{hasSelectedText:!1}));return}if((a=c(this,Pi))==null||a.hide(),v(this,ns,t),w(this,H,Ht).call(this,{hasSelectedText:!0}),!(c(this,ot)!==ee.HIGHLIGHT&&c(this,ot)!==ee.NONE)&&(c(this,ot)===ee.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),v(this,js,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=c(this,ot)===ee.HIGHLIGHT?w(this,H,zm).call(this,s):null;l==null||l.toggleDrawing();const u=new AbortController,h=this.combinedSignal(u),p=g=>{g.type==="pointerup"&&g.button!==0||(u.abort(),l==null||l.toggleDrawing(!0),g.type==="pointerup"&&w(this,H,Zh).call(this,"main_toolbar"))};window.addEventListener("pointerup",p,{signal:h}),window.addEventListener("blur",p,{signal:h})}},Zh=function(e=""){c(this,ot)===ee.HIGHLIGHT?this.highlightSelection(e):c(this,Vc)&&w(this,H,hC).call(this)},pC=function(){document.addEventListener("selectionchange",w(this,H,fC).bind(this),{signal:this._signal})},gC=function(){if(c(this,Zs))return;v(this,Zs,new AbortController);const e=this.combinedSignal(c(this,Zs));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},mC=function(){var e;(e=c(this,Zs))==null||e.abort(),v(this,Zs,null)},qm=function(){if(c(this,tr))return;v(this,tr,new AbortController);const e=this.combinedSignal(c(this,tr));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},yC=function(){var e;(e=c(this,tr))==null||e.abort(),v(this,tr,null)},$m=function(){if(c(this,Qs))return;v(this,Qs,new AbortController);const e=this.combinedSignal(c(this,Qs));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},Wm=function(){var e;(e=c(this,Qs))==null||e.abort(),v(this,Qs,null)},vC=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Ht=function(e){Object.entries(e).some(([i,s])=>c(this,Wc)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(c(this,Wc),e)}),c(this,ot)===ee.HIGHLIGHT&&e.hasSelectedEditor===!1&&w(this,H,Ji).call(this,[[ue.HIGHLIGHT_FREE,!0]]))},Ji=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},_C=async function(){if(!c(this,er)){v(this,er,!0);const e=[];for(const t of c(this,pt).values())e.push(t.enable());await Promise.all(e);for(const t of c(this,et).values())t.enable()}},AC=function(){if(this.unselectAll(),c(this,er)){v(this,er,!1);for(const e of c(this,pt).values())e.disable();for(const e of c(this,et).values())e.disable()}},Ym=function(e){const t=c(this,pt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},EC=function(){let e=null;for(e of c(this,ye));return e},Ou=function(){if(c(this,et).size===0)return!0;if(c(this,et).size===1)for(const e of c(this,et).values())return e.isEmpty();return!1},Km=function(e){for(const t of c(this,ye))t.unselect();c(this,ye).clear();for(const t of e)t.isEmpty()||(c(this,ye).add(t),t.select());w(this,H,Ht).call(this,{hasSelectedEditor:this.hasSelection})},J($a,"TRANSLATE_SMALL",1),J($a,"TRANSLATE_BIG",10);let ma=$a;var at,Mi,ni,hl,ki,dn,fl,Ni,en,ss,fo,bi,ir,pi,Gu,jh;const Vt=class Vt{constructor(e){S(this,pi);S(this,at,null);S(this,Mi,!1);S(this,ni,null);S(this,hl,null);S(this,ki,null);S(this,dn,null);S(this,fl,!1);S(this,Ni,null);S(this,en,null);S(this,ss,null);S(this,fo,null);S(this,bi,!1);v(this,en,e),v(this,bi,e._uiManager.useNewAltTextFlow),c(Vt,ir)||v(Vt,ir,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Vt._l10n??(Vt._l10n=e)}async render(){const e=v(this,ni,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=v(this,hl,document.createElement("span"));e.append(t),c(this,bi)?(e.classList.add("new"),e.setAttribute("data-l10n-id",c(Vt,ir).missing),t.setAttribute("data-l10n-id",c(Vt,ir)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=c(this,en)._uiManager._signal;e.addEventListener("contextmenu",vi,{signal:i}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),c(this,en)._uiManager.editAltText(c(this,en)),c(this,bi)&&c(this,en)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:c(this,pi,Gu)}})};return e.addEventListener("click",s,{capture:!0,signal:i}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(v(this,fl,!0),s(r))},{signal:i}),await w(this,pi,jh).call(this),e}finish(){c(this,ni)&&(c(this,ni).focus({focusVisible:c(this,fl)}),v(this,fl,!1))}isEmpty(){return c(this,bi)?c(this,at)===null:!c(this,at)&&!c(this,Mi)}hasData(){return c(this,bi)?c(this,at)!==null||!!c(this,ss):this.isEmpty()}get guessedText(){return c(this,ss)}async setGuessedText(e){c(this,at)===null&&(v(this,ss,e),v(this,fo,await Vt._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),w(this,pi,jh).call(this))}toggleAltTextBadge(e=!1){var t;if(!c(this,bi)||c(this,at)){(t=c(this,Ni))==null||t.remove(),v(this,Ni,null);return}if(!c(this,Ni)){const i=v(this,Ni,document.createElement("div"));i.className="noAltTextBadge",c(this,en).div.append(i)}c(this,Ni).classList.toggle("hidden",!e)}serialize(e){let t=c(this,at);return!e&&c(this,ss)===t&&(t=c(this,fo)),{altText:t,decorative:c(this,Mi),guessedText:c(this,ss),textWithDisclaimer:c(this,fo)}}get data(){return{altText:c(this,at),decorative:c(this,Mi)}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:s,cancel:r=!1}){i&&(v(this,ss,i),v(this,fo,s)),!(c(this,at)===e&&c(this,Mi)===t)&&(r||(v(this,at,e),v(this,Mi,t)),w(this,pi,jh).call(this))}toggle(e=!1){c(this,ni)&&(!e&&c(this,dn)&&(clearTimeout(c(this,dn)),v(this,dn,null)),c(this,ni).disabled=!e)}shown(){c(this,en)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:c(this,pi,Gu)}})}destroy(){var e,t;(e=c(this,ni))==null||e.remove(),v(this,ni,null),v(this,hl,null),v(this,ki,null),(t=c(this,Ni))==null||t.remove(),v(this,Ni,null)}};at=new WeakMap,Mi=new WeakMap,ni=new WeakMap,hl=new WeakMap,ki=new WeakMap,dn=new WeakMap,fl=new WeakMap,Ni=new WeakMap,en=new WeakMap,ss=new WeakMap,fo=new WeakMap,bi=new WeakMap,ir=new WeakMap,pi=new WeakSet,Gu=function(){return c(this,at)&&"added"||c(this,at)===null&&this.guessedText&&"review"||"missing"},jh=async function(){var s,r,o;const e=c(this,ni);if(!e)return;if(c(this,bi)){if(e.classList.toggle("done",!!c(this,at)),e.setAttribute("data-l10n-id",c(Vt,ir)[c(this,pi,Gu)]),(s=c(this,hl))==null||s.setAttribute("data-l10n-id",c(Vt,ir)[`${c(this,pi,Gu)}-label`]),!c(this,at)){(r=c(this,ki))==null||r.remove();return}}else{if(!c(this,at)&&!c(this,Mi)){e.classList.remove("done"),(o=c(this,ki))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=c(this,ki);if(!t){v(this,ki,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${c(this,en).id}`;const a=100,l=c(this,en)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(c(this,dn)),v(this,dn,null)},{once:!0}),e.addEventListener("mouseenter",()=>{v(this,dn,setTimeout(()=>{v(this,dn,null),c(this,ki).classList.add("show"),c(this,en)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:l}),e.addEventListener("mouseleave",()=>{var u;c(this,dn)&&(clearTimeout(c(this,dn)),v(this,dn,null)),(u=c(this,ki))==null||u.classList.remove("show")},{signal:l})}c(this,Mi)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=c(this,at)),t.parentNode||e.append(t);const i=c(this,en).getImageForAltText();i==null||i.setAttribute("aria-describedby",t.id)},S(Vt,ir,null),J(Vt,"_l10n",null);let ep=Vt;var Kc,po,Jc,Xc,Qc,Zc,jc,pl,rs,go,sr,Us,SC,wC,Jm;const l0=class l0{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:o=null,signal:a}){S(this,Us);S(this,Kc);S(this,po,!1);S(this,Jc,null);S(this,Xc);S(this,Qc);S(this,Zc);S(this,jc);S(this,pl);S(this,rs,null);S(this,go);S(this,sr,null);v(this,Kc,e),v(this,Jc,i),v(this,Xc,t),v(this,Qc,s),v(this,Zc,r),v(this,jc,o),v(this,go,new AbortController),v(this,pl,AbortSignal.any([a,c(this,go).signal])),e.addEventListener("touchstart",w(this,Us,SC).bind(this),{passive:!1,signal:c(this,pl)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return oe(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=c(this,go))==null||e.abort(),v(this,go,null)}};Kc=new WeakMap,po=new WeakMap,Jc=new WeakMap,Xc=new WeakMap,Qc=new WeakMap,Zc=new WeakMap,jc=new WeakMap,pl=new WeakMap,rs=new WeakMap,go=new WeakMap,sr=new WeakMap,Us=new WeakSet,SC=function(e){var s,r,o;if((s=c(this,Xc))!=null&&s.call(this)||e.touches.length<2)return;if(!c(this,sr)){v(this,sr,new AbortController);const a=AbortSignal.any([c(this,pl),c(this,sr).signal]),l=c(this,Kc),u={signal:a,passive:!1};l.addEventListener("touchmove",w(this,Us,wC).bind(this),u),l.addEventListener("touchend",w(this,Us,Jm).bind(this),u),l.addEventListener("touchcancel",w(this,Us,Jm).bind(this),u),(r=c(this,Qc))==null||r.call(this)}if(Tn(e),e.touches.length!==2||(o=c(this,Jc))!=null&&o.call(this)){v(this,rs,null);return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),v(this,rs,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY})},wC=function(e){var I;if(!c(this,rs)||e.touches.length!==2)return;let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:s,screenY:r}=t,{screenX:o,screenY:a}=i,l=c(this,rs),{touch0X:u,touch0Y:h,touch1X:p,touch1Y:g}=l,m=p-u,y=g-h,A=o-s,T=a-r,_=Math.hypot(A,T)||1,E=Math.hypot(m,y)||1;if(!c(this,po)&&Math.abs(E-_)<=l0.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=r,l.touch1X=o,l.touch1Y=a,e.preventDefault(),!c(this,po)){v(this,po,!0);return}const C=[(s+o)/2,(r+a)/2];(I=c(this,Zc))==null||I.call(this,C,E,_)},Jm=function(e){var t;c(this,sr).abort(),v(this,sr,null),(t=c(this,jc))==null||t.call(this),c(this,rs)&&(e.preventDefault(),v(this,rs,null),v(this,po,!1))};let tp=l0;var mo,ii,Ie,gl,rr,ed,yo,gt,vo,os,or,td,_o,hn,nd,Ao,as,Di,ml,yl,Ln,Eo,id,dp,X,Xm,sd,Qm,ef,CC,TC,Zm,tf,jm,IC,xC,PC,ey,RC,ty,MC,kC,NC,ny,Bu;const ne=class ne{constructor(e){S(this,X);S(this,mo,null);S(this,ii,null);S(this,Ie,null);S(this,gl,!1);S(this,rr,null);S(this,ed,"");S(this,yo,!1);S(this,gt,null);S(this,vo,null);S(this,os,null);S(this,or,null);S(this,td,"");S(this,_o,!1);S(this,hn,null);S(this,nd,!1);S(this,Ao,!1);S(this,as,!1);S(this,Di,null);S(this,ml,0);S(this,yl,0);S(this,Ln,null);S(this,Eo,null);J(this,"_editToolbar",null);J(this,"_initialOptions",Object.create(null));J(this,"_initialData",null);J(this,"_isVisible",!0);J(this,"_uiManager",null);J(this,"_focusEventsAllowed",!0);S(this,id,!1);S(this,dp,ne._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,o];const[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ne.prototype._resizeWithKeyboard,t=ma.TRANSLATE_SMALL,i=ma.TRANSLATE_BIG;return oe(this,"_resizerKeyboardManager",new ch([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],ne.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return oe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new FD({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ne._l10n??(ne._l10n=e),ne._l10nResizer||(ne._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ne._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);ne._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Se("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return c(this,id)}set _isDraggable(e){var t;v(this,id,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=c(this,dp)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):w(this,X,Bu).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(c(this,_o)?v(this,_o,!1):this.parent.setSelected(this))}focusout(e){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,s){const[r,o]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(e+i)/r,this.y=(t+s)/o,this.fixAndSetPosition()}translate(e,t){w(this,X,Xm).call(this,this.parentDimensions,e,t)}translateInPage(e,t){c(this,hn)||v(this,hn,[this.x,this.y,this.width,this.height]),w(this,X,Xm).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){c(this,hn)||v(this,hn,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[s,r]}=this;if(this.x+=e/s,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:g}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,g)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[l,u]=this.getBaseTranslation();o+=l,a+=u;const{style:h}=i;h.left=`${(100*o).toFixed(2)}%`,h.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!c(this,hn)&&(c(this,hn)[0]!==this.x||c(this,hn)[1]!==this.y)}get _hasBeenResized(){return!!c(this,hn)&&(c(this,hn)[2]!==this.width||c(this,hn)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=ne,s=i/e,r=i/t;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,s]}=this;let{x:r,y:o,width:a,height:l}=this;if(a*=i,l*=s,r*=i,o*=s,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(i-a,r)),o=Math.max(0,Math.min(s-l,o));break;case 90:r=Math.max(0,Math.min(i-l,r)),o=Math.min(s,Math.max(a,o));break;case 180:r=Math.min(i,Math.max(a,r)),o=Math.min(s,Math.max(l,o));break;case 270:r=Math.min(i,Math.max(l,r)),o=Math.max(0,Math.min(s-a,o));break}this.x=r/=i,this.y=o/=s;const[u,h]=this.getBaseTranslation();r+=u,o+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var i;return w(i=ne,sd,Qm).call(i,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var i;return w(i=ne,sd,Qm).call(i,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,s]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/i).toFixed(2)}%`,c(this,yo)||(r.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,s=i.endsWith("%"),r=!c(this,yo)&&t.endsWith("%");if(s&&r)return;const[o,a]=this.parentDimensions;s||(e.width=`${(100*parseFloat(i)/o).toFixed(2)}%`),!c(this,yo)&&!r&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=c(this,Ie))==null||e.finish()}async addEditToolbar(){return this._editToolbar||c(this,Ao)?this._editToolbar:(this._editToolbar=new Vm(this),this.div.append(this._editToolbar.render()),c(this,Ie)&&await this._editToolbar.addAltText(c(this,Ie)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=c(this,Ie))==null||e.destroy())}addContainer(e){var i;const t=(i=this._editToolbar)==null?void 0:i.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){c(this,Ie)||(ep.initialize(ne._l10n),v(this,Ie,new ep(this)),c(this,mo)&&(c(this,Ie).data=c(this,mo),v(this,mo,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=c(this,Ie))==null?void 0:e.data}set altTextData(e){c(this,Ie)&&(c(this,Ie).data=e)}get guessedAltText(){var e;return(e=c(this,Ie))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=c(this,Ie))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=c(this,Ie))==null?void 0:t.serialize(e)}hasAltText(){return!!c(this,Ie)&&!c(this,Ie).isEmpty()}hasAltTextData(){var e;return((e=c(this,Ie))==null?void 0:e.hasData())??!1}render(){var r;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=c(this,gl)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),w(this,X,ty).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),jf(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(c(this,Eo)||v(this,Eo,new tp({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:w(this,X,IC).bind(this),onPinching:w(this,X,xC).bind(this),onPinchEnd:w(this,X,PC).bind(this),signal:this._uiManager._signal}))),(r=this._uiManager._editorUndoBar)==null||r.hide(),this.div}pointerdown(e){const{isMac:t}=$t.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(v(this,_o,!0),this._isDraggable){w(this,X,RC).call(this,e);return}w(this,X,ey).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){c(this,Di)&&clearTimeout(c(this,Di)),v(this,Di,setTimeout(()=>{var e;v(this,Di,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const s=this.parentScale,[r,o]=this.pageDimensions,[a,l]=this.pageTranslation,u=e/s,h=t/s,p=this.x*r,g=this.y*o,m=this.width*r,y=this.height*o;switch(i){case 0:return[p+u+a,o-g-h-y+l,p+u+m+a,o-g-h+l];case 90:return[p+h+a,o-g+u+l,p+h+y+a,o-g+u+m+l];case 180:return[p-u-m+a,o-g+h+l,p-u+a,o-g+h+y+l];case 270:return[p-h-y+a,o-g-u-m+l,p-h+a,o-g-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,s,r,o]=e,a=r-i,l=o-s;switch(this.rotation){case 0:return[i,t-o,a,l];case 90:return[i,t-s,l,a];case 180:return[r,t-s,a,l];case 270:return[r,t-o,l,a];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){v(this,Ao,!0)}disableEditMode(){v(this,Ao,!1)}isInEditMode(){return c(this,Ao)}shouldGetKeyboardEvents(){return c(this,as)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:r,innerWidth:o}=window;return t<o&&s>0&&e<r&&i>0}rebuild(){w(this,X,ty).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){Se("An editor must be serializable")}static async deserialize(e,t,i){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});s.rotation=e.rotation,v(s,mo,e.accessibilityData);const[r,o]=s.pageDimensions,[a,l,u,h]=s.getRectInCurrentCoords(e.rect,o);return s.x=a/r,s.y=l/o,s.width=u/r,s.height=h/o,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=c(this,or))==null||e.abort(),v(this,or,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),c(this,Di)&&(clearTimeout(c(this,Di)),v(this,Di,null)),w(this,X,Bu).call(this),this.removeEditToolbar(),c(this,Ln)){for(const i of c(this,Ln).values())clearTimeout(i);v(this,Ln,null)}this.parent=null,(t=c(this,Eo))==null||t.destroy(),v(this,Eo,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(w(this,X,CC).call(this),c(this,gt).classList.remove("hidden"),jf(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),v(this,os,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=c(this,gt).children;if(!c(this,ii)){v(this,ii,Array.from(t));const o=w(this,X,MC).bind(this),a=w(this,X,kC).bind(this),l=this._uiManager._signal;for(const u of c(this,ii)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:l}),u.addEventListener("blur",a,{signal:l}),u.addEventListener("focus",w(this,X,NC).bind(this,h),{signal:l}),u.setAttribute("data-l10n-id",ne._l10nResizer[h])}}const i=c(this,ii)[0];let s=0;for(const o of t){if(o===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(c(this,ii).length/4);if(r!==s){if(r<s)for(let a=0;a<s-r;a++)c(this,gt).append(c(this,gt).firstChild);else if(r>s)for(let a=0;a<r-s;a++)c(this,gt).firstChild.before(c(this,gt).lastChild);let o=0;for(const a of t){const u=c(this,ii)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",ne._l10nResizer[u])}}w(this,X,ny).call(this,0),v(this,as,!0),c(this,gt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){c(this,as)&&w(this,X,jm).call(this,c(this,td),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){w(this,X,Bu).call(this),this.div.focus()}select(){var e,t,i;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,r;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(i=c(this,Ie))==null||i.toggleAltTextBadge(!1)}unselect(){var e,t,i,s,r;(e=c(this,gt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(r=c(this,Ie))==null||r.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return c(this,nd)}set isEditing(e){v(this,nd,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){v(this,yo,!0);const i=e/t,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){c(this,Ln)||v(this,Ln,new Map);const{action:i}=e;let s=c(this,Ln).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),c(this,Ln).delete(i),c(this,Ln).size===0&&v(this,Ln,null)},ne._telemetryTimeout),c(this,Ln).set(i,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),v(this,gl,!1)}disable(){this.div&&(this.div.tabIndex=-1),v(this,gl,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};mo=new WeakMap,ii=new WeakMap,Ie=new WeakMap,gl=new WeakMap,rr=new WeakMap,ed=new WeakMap,yo=new WeakMap,gt=new WeakMap,vo=new WeakMap,os=new WeakMap,or=new WeakMap,td=new WeakMap,_o=new WeakMap,hn=new WeakMap,nd=new WeakMap,Ao=new WeakMap,as=new WeakMap,Di=new WeakMap,ml=new WeakMap,yl=new WeakMap,Ln=new WeakMap,Eo=new WeakMap,id=new WeakMap,dp=new WeakMap,X=new WeakSet,Xm=function([e,t],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},sd=new WeakSet,Qm=function(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},ef=function(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}},CC=function(){if(c(this,gt))return;v(this,gt,document.createElement("div")),c(this,gt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const s=document.createElement("div");c(this,gt).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",w(this,X,TC).bind(this,i),{signal:t}),s.addEventListener("contextmenu",vi,{signal:t}),s.tabIndex=-1}this.div.prepend(c(this,gt))},TC=function(e,t){var h;t.preventDefault();const{isMac:i}=$t.platform;if(t.button!==0||t.ctrlKey&&i)return;(h=c(this,Ie))==null||h.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,v(this,vo,[t.screenX,t.screenY]);const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",w(this,X,jm).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Tn,{passive:!1,signal:o}),window.addEventListener("contextmenu",vi,{signal:o}),v(this,os,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var p;r.abort(),this.parent.togglePointerEvents(!0),(p=c(this,Ie))==null||p.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=a,this.div.style.cursor=l,w(this,X,tf).call(this)};window.addEventListener("pointerup",u,{signal:o}),window.addEventListener("blur",u,{signal:o})},Zm=function(e,t,i,s){this.width=i,this.height=s,this.x=e,this.y=t;const[r,o]=this.parentDimensions;this.setDims(r*i,o*s),this.fixAndSetPosition(),this._onResized()},tf=function(){if(!c(this,os))return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:s}=c(this,os);v(this,os,null);const r=this.x,o=this.y,a=this.width,l=this.height;r===e&&o===t&&a===i&&l===s||this.addCommands({cmd:w(this,X,Zm).bind(this,r,o,a,l),undo:w(this,X,Zm).bind(this,e,t,i,s),mustExec:!0})},jm=function(e,t){const[i,s]=this.parentDimensions,r=this.x,o=this.y,a=this.width,l=this.height,u=ne.MIN_SIZE/i,h=ne.MIN_SIZE/s,p=w(this,X,ef).call(this,this.rotation),g=(F,$)=>[p[0]*F+p[2]*$,p[1]*F+p[3]*$],m=w(this,X,ef).call(this,360-this.rotation),y=(F,$)=>[m[0]*F+m[2]*$,m[1]*F+m[3]*$];let A,T,_=!1,E=!1;switch(e){case"topLeft":_=!0,A=(F,$)=>[0,0],T=(F,$)=>[F,$];break;case"topMiddle":A=(F,$)=>[F/2,0],T=(F,$)=>[F/2,$];break;case"topRight":_=!0,A=(F,$)=>[F,0],T=(F,$)=>[0,$];break;case"middleRight":E=!0,A=(F,$)=>[F,$/2],T=(F,$)=>[0,$/2];break;case"bottomRight":_=!0,A=(F,$)=>[F,$],T=(F,$)=>[0,0];break;case"bottomMiddle":A=(F,$)=>[F/2,$],T=(F,$)=>[F/2,0];break;case"bottomLeft":_=!0,A=(F,$)=>[0,$],T=(F,$)=>[F,0];break;case"middleLeft":E=!0,A=(F,$)=>[0,$/2],T=(F,$)=>[F,$/2];break}const C=A(a,l),I=T(a,l);let x=g(...I);const R=ne._round(r+x[0]),P=ne._round(o+x[1]);let M=1,k=1,N,L;if(t.fromKeyboard)({deltaX:N,deltaY:L}=t);else{const{screenX:F,screenY:$}=t,[U,K]=c(this,vo);[N,L]=this.screenToPageTranslation(F-U,$-K),c(this,vo)[0]=F,c(this,vo)[1]=$}if([N,L]=y(N/i,L/s),_){const F=Math.hypot(a,l);M=k=Math.max(Math.min(Math.hypot(I[0]-C[0]-N,I[1]-C[1]-L)/F,1/a,1/l),u/a,h/l)}else E?M=Math.max(u,Math.min(1,Math.abs(I[0]-C[0]-N)))/a:k=Math.max(h,Math.min(1,Math.abs(I[1]-C[1]-L)))/l;const Y=ne._round(a*M),ie=ne._round(l*k);x=g(...T(Y,ie));const se=R-x[0],De=P-x[1];c(this,hn)||v(this,hn,[this.x,this.y,this.width,this.height]),this.width=Y,this.height=ie,this.x=se,this.y=De,this.setDims(i*Y,s*ie),this.fixAndSetPosition(),this._onResizing()},IC=function(){var e;v(this,os,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=c(this,Ie))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},xC=function(e,t,i){let r=.7*(i/t)+1-.7;if(r===1)return;const o=w(this,X,ef).call(this,this.rotation),a=(R,P)=>[o[0]*R+o[2]*P,o[1]*R+o[3]*P],[l,u]=this.parentDimensions,h=this.x,p=this.y,g=this.width,m=this.height,y=ne.MIN_SIZE/l,A=ne.MIN_SIZE/u;r=Math.max(Math.min(r,1/g,1/m),y/g,A/m);const T=ne._round(g*r),_=ne._round(m*r);if(T===g&&_===m)return;c(this,hn)||v(this,hn,[h,p,g,m]);const E=a(g/2,m/2),C=ne._round(h+E[0]),I=ne._round(p+E[1]),x=a(T/2,_/2);this.x=C-x[0],this.y=I-x[1],this.width=T,this.height=_,this.setDims(l*T,u*_),this.fixAndSetPosition(),this._onResizing()},PC=function(){var e;(e=c(this,Ie))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),w(this,X,tf).call(this)},ey=function(e){const{isMac:t}=$t.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},RC=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,r=this._uiManager.combinedSignal(s),o={capture:!0,passive:!1,signal:r},a=u=>{s.abort(),v(this,rr,null),v(this,_o,!1),this._uiManager.endDragSession()||w(this,X,ey).call(this,u),i&&this._onStopDragging()};t&&(v(this,ml,e.clientX),v(this,yl,e.clientY),v(this,rr,e.pointerId),v(this,ed,e.pointerType),window.addEventListener("pointermove",u=>{i||(i=!0,this._onStartDragging());const{clientX:h,clientY:p,pointerId:g}=u;if(g!==c(this,rr)){Tn(u);return}const[m,y]=this.screenToPageTranslation(h-c(this,ml),p-c(this,yl));v(this,ml,h),v(this,yl,p),this._uiManager.dragSelectedEditors(m,y)},o),window.addEventListener("touchmove",Tn,o),window.addEventListener("pointerdown",u=>{u.pointerType===c(this,ed)&&(c(this,Eo)||u.isPrimary)&&a(u),Tn(u)},o));const l=u=>{if(!c(this,rr)||c(this,rr)===u.pointerId){a(u);return}Tn(u)};window.addEventListener("pointerup",l,{signal:r}),window.addEventListener("blur",l,{signal:r})},ty=function(){if(c(this,or)||!this.div)return;v(this,or,new AbortController);const e=this._uiManager.combinedSignal(c(this,or));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},MC=function(e){ne._resizerKeyboardManager.exec(this,e)},kC=function(e){var t;c(this,as)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==c(this,gt)&&w(this,X,Bu).call(this)},NC=function(e){v(this,td,c(this,as)?e:"")},ny=function(e){if(c(this,ii))for(const t of c(this,ii))t.tabIndex=e},Bu=function(){v(this,as,!1),w(this,X,ny).call(this,-1),w(this,X,tf).call(this)},S(ne,sd),J(ne,"_l10n",null),J(ne,"_l10nResizer",null),J(ne,"_borderLineWidth",-1),J(ne,"_colorManager",new Bm),J(ne,"_zIndex",1),J(ne,"_telemetryTimeout",1e3);let He=ne;class FD extends He{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const jA=3285377520,Nn=4294901760,wi=65535;class bC{constructor(e){this.h1=e?e&4294967295:jA,this.h2=e?e&4294967295:jA}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let A=0,T=e.length;A<T;A++){const _=e.charCodeAt(A);_<=255?t[i++]=_:(t[i++]=_>>>8,t[i++]=_&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,o=new Uint32Array(t.buffer,0,s);let a=0,l=0,u=this.h1,h=this.h2;const p=3432918353,g=461845907,m=p&wi,y=g&wi;for(let A=0;A<s;A++)A&1?(a=o[A],a=a*p&Nn|a*m&wi,a=a<<15|a>>>17,a=a*g&Nn|a*y&wi,u^=a,u=u<<13|u>>>19,u=u*5+3864292196):(l=o[A],l=l*p&Nn|l*m&wi,l=l<<15|l>>>17,l=l*g&Nn|l*y&wi,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(a=0,r){case 3:a^=t[s*4+2]<<16;case 2:a^=t[s*4+1]<<8;case 1:a^=t[s*4],a=a*p&Nn|a*m&wi,a=a<<15|a>>>17,a=a*g&Nn|a*y&wi,s&1?u^=a:h^=a}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Nn|e*36045&wi,t=t*4283543511&Nn|((t<<16|e>>>16)*2950163797&Nn)>>>16,e^=t>>>1,e=e*444984403&Nn|e*60499&wi,t=t*3301882366&Nn|((t<<16|e>>>16)*3120437893&Nn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const iy=Object.freeze({map:null,hash:"",transfer:void 0});var So,wo,lt,hp,DC;class i0{constructor(){S(this,hp);S(this,So,!1);S(this,wo,null);S(this,lt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=c(this,lt).get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return c(this,lt).get(e)}remove(e){if(c(this,lt).delete(e),c(this,lt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of c(this,lt).values())if(t instanceof He)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=c(this,lt).get(e);let s=!1;if(i!==void 0)for(const[r,o]of Object.entries(t))i[r]!==o&&(s=!0,i[r]=o);else s=!0,c(this,lt).set(e,t);s&&w(this,hp,DC).call(this),t instanceof He&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return c(this,lt).has(e)}getAll(){return c(this,lt).size>0?Qv(c(this,lt)):null}setAll(e){for(const[t,i]of Object.entries(e))this.setValue(t,i)}get size(){return c(this,lt).size}resetModified(){c(this,So)&&(v(this,So,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new LC(this)}get serializable(){if(c(this,lt).size===0)return iy;const e=new Map,t=new bC,i=[],s=Object.create(null);let r=!1;for(const[o,a]of c(this,lt)){const l=a instanceof He?a.serialize(!1,s):a;l&&(e.set(o,l),t.update(`${o}:${JSON.stringify(l)}`),r||(r=!!l.bitmap))}if(r)for(const o of e.values())o.bitmap&&i.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:iy}get editorStats(){let e=null;const t=new Map;for(const i of c(this,lt).values()){if(!(i instanceof He))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:r}=s;t.has(r)||t.set(r,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const o=e[r]||(e[r]=new Map);for(const[a,l]of Object.entries(s)){if(a==="type")continue;let u=o.get(a);u||(u=new Map,o.set(a,u));const h=u.get(l)??0;u.set(l,h+1)}}for(const[i,s]of t)e[i]=s.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){v(this,wo,null)}get modifiedIds(){if(c(this,wo))return c(this,wo);const e=[];for(const t of c(this,lt).values())!(t instanceof He)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return v(this,wo,{ids:new Set(e),hash:e.join(",")})}}So=new WeakMap,wo=new WeakMap,lt=new WeakMap,hp=new WeakSet,DC=function(){c(this,So)||(v(this,So,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var rd;class LC extends i0{constructor(t){super();S(this,rd);const{map:i,hash:s,transfer:r}=t.serializable,o=structuredClone(i,r?{transfer:r}:null);v(this,rd,{map:o,hash:s,transfer:r})}get print(){Se("Should not call PrintAnnotationStorage.print")}get serializable(){return c(this,rd)}get modifiedIds(){return oe(this,"modifiedIds",{ids:new Set,hash:""})}}rd=new WeakMap;var vl;class UD{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){S(this,vl,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),c(this,vl).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||c(this,vl).has(e.loadedName))){if(Xe(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:r}=e,o=new FontFace(i,s,r);this.addNativeFontFace(o);try{await o.load(),c(this,vl).add(i),t==null||t(e)}catch{te(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Se("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw te(`Failed to load font '${i.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return oe(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Dt||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),oe(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Xe(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:t,callback:e};return i.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return oe(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(I,x){return I.charCodeAt(x)<<24|I.charCodeAt(x+1)<<16|I.charCodeAt(x+2)<<8|I.charCodeAt(x+3)&255}function s(I,x,R,P){const M=I.substring(0,x),k=I.substring(x+R);return M+P+k}let r,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const l=a.getContext("2d");let u=0;function h(I,x){if(++u>30){te("Load test font never loaded."),x();return}if(l.font="30px "+I,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){x();return}setTimeout(h.bind(null,I,x))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let g=this._loadTestFont;g=s(g,976,p.length,p);const y=16,A=1482184792;let T=i(g,y);for(r=0,o=p.length-3;r<o;r+=4)T=T-A+i(p,r)|0;r<p.length&&(T=T-A+i(p+"XXX",r)|0),g=s(g,y,4,SD(T));const _=`url(data:font/opentype;base64,${btoa(g)});`,E=`@font-face {font-family:"${p}";src:${_}}`;this.insertRule(E);const C=this._document.createElement("div");C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px";for(const I of[e.loadedName,p]){const x=this._document.createElement("span");x.textContent="Hi",x.style.fontFamily=I,C.append(x)}this._document.body.append(C),h(p,()=>{C.remove(),t.complete()})}}vl=new WeakMap;class HD{constructor(e,{disableFontFace:t=!1,fontExtraProperties:i=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this.disableFontFace=t===!0,this.fontExtraProperties=i===!0,this._inspectFont=s}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${PD(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(i=this._inspectFont)==null||i.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let s;try{s=e.get(i)}catch(o){te(`getPathGenerator - ignoring character: "${o}".`)}const r=new Path2D(s||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=r}}const Rh={DATA:1,ERROR:2},Ke={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function eE(){}function Zt(n){if(n instanceof Vr||n instanceof Fm||n instanceof Mc||n instanceof XA||n instanceof Zf||n instanceof xg)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Se('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Vr(n.message);case"InvalidPDFException":return new Fm(n.message);case"MissingPDFException":return new Mc(n.message);case"PasswordException":return new XA(n.message,n.code);case"UnexpectedResponseException":return new Zf(n.message,n.status);case"UnknownErrorException":return new xg(n.message,n.details)}return new xg(n.message,n.toString())}var _l,Yn,FC,UC,HC,nf;class zu{constructor(e,t,i){S(this,Yn);S(this,_l,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",w(this,Yn,FC).bind(this),{signal:c(this,_l).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(o){r.reject(o)}return r.promise}sendWithStream(e,t,i,s){const r=this.streamId++,o=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:o,targetName:a,action:e,streamId:r,data:t,desiredSize:u.desiredSize},s),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:o,targetName:a,stream:Ke.PULL,streamId:r,desiredSize:u.desiredSize}),h.promise},cancel:u=>{Xe(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:o,targetName:a,stream:Ke.CANCEL,streamId:r,reason:Zt(u)}),h.promise}},i)}destroy(){var e;(e=c(this,_l))==null||e.abort(),v(this,_l,null)}}_l=new WeakMap,Yn=new WeakSet,FC=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){w(this,Yn,HC).call(this,e);return}if(e.callback){const i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===Rh.DATA)s.resolve(e.data);else if(e.callback===Rh.ERROR)s.reject(Zt(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,s=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(o){r.postMessage({sourceName:i,targetName:s,callback:Rh.DATA,callbackId:e.callbackId,data:o})},function(o){r.postMessage({sourceName:i,targetName:s,callback:Rh.ERROR,callbackId:e.callbackId,reason:Zt(o)})});return}if(e.streamId){w(this,Yn,UC).call(this,e);return}t(e.data)},UC=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,o=this,a=this.actionHandler[e.action],l={enqueue(u,h=1,p){if(this.isCancelled)return;const g=this.desiredSize;this.desiredSize-=h,g>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:Ke.ENQUEUE,streamId:t,chunk:u},p)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Ke.CLOSE,streamId:t}),delete o.streamSinks[t])},error(u){Xe(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Ke.ERROR,streamId:t,reason:Zt(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(a,e.data,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Ke.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:i,targetName:s,stream:Ke.START_COMPLETE,streamId:t,reason:Zt(u)})})},HC=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case Ke.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(Zt(e.reason));break;case Ke.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(Zt(e.reason));break;case Ke.PULL:if(!a){r.postMessage({sourceName:i,targetName:s,stream:Ke.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||eE).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Ke.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:i,targetName:s,stream:Ke.PULL_COMPLETE,streamId:t,reason:Zt(u)})});break;case Ke.ENQUEUE:if(Xe(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case Ke.CLOSE:if(Xe(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),w(this,Yn,nf).call(this,o,t);break;case Ke.ERROR:Xe(o,"error should have stream controller"),o.controller.error(Zt(e.reason)),w(this,Yn,nf).call(this,o,t);break;case Ke.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(Zt(e.reason)),w(this,Yn,nf).call(this,o,t);break;case Ke.CANCEL:if(!a)break;const l=Zt(e.reason);Promise.try(a.onCancel||eE,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Ke.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:i,targetName:s,stream:Ke.CANCEL_COMPLETE,streamId:t,reason:Zt(u)})}),a.sinkCapability.reject(l),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},nf=async function(e,t){var i,s,r;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(s=e.pullCall)==null?void 0:s.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var od;class VC{constructor({enableHWA:e=!1}){S(this,od,!1);v(this,od,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!c(this,od)})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Se("Abstract method `_createCanvas` called.")}}od=new WeakMap;class VD extends VC{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class OC{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Se("Abstract method `_fetch` called.")}}class GC extends OC{async _fetch(e){const t=await Jp(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Kp(t)}}class BC{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,s,r){return"none"}destroy(e=!1){}}var Co,Al,ls,us,Rt,To,Io,O,It,qu,Ta,sf,Ia,zC,sy,xa,$u,Wu,ry,Yu;class OD extends BC{constructor({docId:t,ownerDocument:i=globalThis.document}){super();S(this,O);S(this,Co);S(this,Al);S(this,ls);S(this,us);S(this,Rt);S(this,To);S(this,Io,0);v(this,us,t),v(this,Rt,i)}addFilter(t){if(!t)return"none";let i=c(this,O,It).get(t);if(i)return i;const[s,r,o]=w(this,O,sf).call(this,t),a=t.length===1?s:`${s}${r}${o}`;if(i=c(this,O,It).get(a),i)return c(this,O,It).set(t,i),i;const l=`g_${c(this,us)}_transfer_map_${Ut(this,Io)._++}`,u=w(this,O,Ia).call(this,l);c(this,O,It).set(t,u),c(this,O,It).set(a,u);const h=w(this,O,xa).call(this,l);return w(this,O,Wu).call(this,s,r,o,h),u}addHCMFilter(t,i){var y;const s=`${t}-${i}`,r="base";let o=c(this,O,qu).get(r);if((o==null?void 0:o.key)===s||(o?((y=o.filter)==null||y.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},c(this,O,qu).set(r,o)),!t||!i))return o.url;const a=w(this,O,Yu).call(this,t);t=W.makeHexColor(...a);const l=w(this,O,Yu).call(this,i);if(i=W.makeHexColor(...l),c(this,O,Ta).style.color="",t==="#000000"&&i==="#ffffff"||t===i)return o.url;const u=new Array(256);for(let A=0;A<=255;A++){const T=A/255;u[A]=T<=.03928?T/12.92:((T+.055)/1.055)**2.4}const h=u.join(","),p=`g_${c(this,us)}_hcm_filter`,g=o.filter=w(this,O,xa).call(this,p);w(this,O,Wu).call(this,h,h,h,g),w(this,O,sy).call(this,g);const m=(A,T)=>{const _=a[A]/255,E=l[A]/255,C=new Array(T+1);for(let I=0;I<=T;I++)C[I]=_+I/T*(E-_);return C.join(",")};return w(this,O,Wu).call(this,m(0,5),m(1,5),m(2,5),g),o.url=w(this,O,Ia).call(this,p),o.url}addAlphaFilter(t){let i=c(this,O,It).get(t);if(i)return i;const[s]=w(this,O,sf).call(this,[t]),r=`alpha_${s}`;if(i=c(this,O,It).get(r),i)return c(this,O,It).set(t,i),i;const o=`g_${c(this,us)}_alpha_map_${Ut(this,Io)._++}`,a=w(this,O,Ia).call(this,o);c(this,O,It).set(t,a),c(this,O,It).set(r,a);const l=w(this,O,xa).call(this,o);return w(this,O,ry).call(this,s,l),a}addLuminosityFilter(t){let i=c(this,O,It).get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=w(this,O,sf).call(this,[t]),r=`luminosity_${s}`):r="luminosity",i=c(this,O,It).get(r),i)return c(this,O,It).set(t,i),i;const o=`g_${c(this,us)}_luminosity_map_${Ut(this,Io)._++}`,a=w(this,O,Ia).call(this,o);c(this,O,It).set(t,a),c(this,O,It).set(r,a);const l=w(this,O,xa).call(this,o);return w(this,O,zC).call(this,l),t&&w(this,O,ry).call(this,s,l),a}addHighlightHCMFilter(t,i,s,r,o){var E;const a=`${i}-${s}-${r}-${o}`;let l=c(this,O,qu).get(t);if((l==null?void 0:l.key)===a||(l?((E=l.filter)==null||E.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},c(this,O,qu).set(t,l)),!i||!s))return l.url;const[u,h]=[i,s].map(w(this,O,Yu).bind(this));let p=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),g=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[m,y]=[r,o].map(w(this,O,Yu).bind(this));g<p&&([p,g,m,y]=[g,p,y,m]),c(this,O,Ta).style.color="";const A=(C,I,x)=>{const R=new Array(256),P=(g-p)/x,M=C/255,k=(I-C)/(255*x);let N=0;for(let L=0;L<=x;L++){const Y=Math.round(p+L*P),ie=M+L*k;for(let se=N;se<=Y;se++)R[se]=ie;N=Y+1}for(let L=N;L<256;L++)R[L]=R[N-1];return R.join(",")},T=`g_${c(this,us)}_hcm_${t}_filter`,_=l.filter=w(this,O,xa).call(this,T);return w(this,O,sy).call(this,_),w(this,O,Wu).call(this,A(m[0],y[0],5),A(m[1],y[1],5),A(m[2],y[2],5),_),l.url=w(this,O,Ia).call(this,T),l.url}destroy(t=!1){var i,s,r,o;t&&((i=c(this,To))!=null&&i.size)||((s=c(this,ls))==null||s.parentNode.parentNode.remove(),v(this,ls,null),(r=c(this,Al))==null||r.clear(),v(this,Al,null),(o=c(this,To))==null||o.clear(),v(this,To,null),v(this,Io,0))}}Co=new WeakMap,Al=new WeakMap,ls=new WeakMap,us=new WeakMap,Rt=new WeakMap,To=new WeakMap,Io=new WeakMap,O=new WeakSet,It=function(){return c(this,Al)||v(this,Al,new Map)},qu=function(){return c(this,To)||v(this,To,new Map)},Ta=function(){if(!c(this,ls)){const t=c(this,Rt).createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=c(this,Rt).createElementNS(Ki,"svg");s.setAttribute("width",0),s.setAttribute("height",0),v(this,ls,c(this,Rt).createElementNS(Ki,"defs")),t.append(s),s.append(c(this,ls)),c(this,Rt).body.append(t)}return c(this,ls)},sf=function(t){if(t.length===1){const u=t[0],h=new Array(256);for(let g=0;g<256;g++)h[g]=u[g]/255;const p=h.join(",");return[p,p,p]}const[i,s,r]=t,o=new Array(256),a=new Array(256),l=new Array(256);for(let u=0;u<256;u++)o[u]=i[u]/255,a[u]=s[u]/255,l[u]=r[u]/255;return[o.join(","),a.join(","),l.join(",")]},Ia=function(t){if(c(this,Co)===void 0){v(this,Co,"");const i=c(this,Rt).URL;i!==c(this,Rt).baseURI&&(Xp(i)?te('#createUrl: ignore "data:"-URL for performance reasons.'):v(this,Co,i.split("#",1)[0]))}return`url(${c(this,Co)}#${t})`},zC=function(t){const i=c(this,Rt).createElementNS(Ki,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)},sy=function(t){const i=c(this,Rt).createElementNS(Ki,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)},xa=function(t){const i=c(this,Rt).createElementNS(Ki,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),c(this,O,Ta).append(i),i},$u=function(t,i,s){const r=c(this,Rt).createElementNS(Ki,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)},Wu=function(t,i,s,r){const o=c(this,Rt).createElementNS(Ki,"feComponentTransfer");r.append(o),w(this,O,$u).call(this,o,"feFuncR",t),w(this,O,$u).call(this,o,"feFuncG",i),w(this,O,$u).call(this,o,"feFuncB",s)},ry=function(t,i){const s=c(this,Rt).createElementNS(Ki,"feComponentTransfer");i.append(s),w(this,O,$u).call(this,s,"feFuncA",t)},Yu=function(t){return c(this,O,Ta).style.color=t,n0(getComputedStyle(c(this,O,Ta)).getPropertyValue("color"))};class qC{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Se("Abstract method `_fetch` called.")}}class $C extends qC{async _fetch(e){const t=await Jp(e,"arraybuffer");return new Uint8Array(t)}}Dt&&te("Please use the `legacy` build in Node.js environments.");async function WC(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class GD extends BC{}class BD extends VC{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class zD extends OC{async _fetch(e){return WC(e)}}class qD extends qC{async _fetch(e){return WC(e)}}const Nt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function oy(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,i),n.clip(s)}class s0{getPattern(){Se("Abstract method `getPattern` called.")}}class $D extends s0{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,s){let r;if(s===Nt.STROKE||s===Nt.FILL){const o=t.current.getClippedPathBoundingBox(s,ke(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,l=Math.ceil(o[3]-o[1])||1,u=t.cachedCanvases.getCanvas("pattern",a,l),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-o[0],-o[1]),i=W.transform(i,[1,0,0,1,o[0],o[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),oy(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(u.canvas,"no-repeat");const p=new DOMMatrix(i);r.setTransform(p)}else oy(e,this._bbox),r=this._createGradient(e);return r}}function Mg(n,e,t,i,s,r,o,a){const l=e.coords,u=e.colors,h=n.data,p=n.width*4;let g;l[t+1]>l[i+1]&&(g=t,t=i,i=g,g=r,r=o,o=g),l[i+1]>l[s+1]&&(g=i,i=s,s=g,g=o,o=a,a=g),l[t+1]>l[i+1]&&(g=t,t=i,i=g,g=r,r=o,o=g);const m=(l[t]+e.offsetX)*e.scaleX,y=(l[t+1]+e.offsetY)*e.scaleY,A=(l[i]+e.offsetX)*e.scaleX,T=(l[i+1]+e.offsetY)*e.scaleY,_=(l[s]+e.offsetX)*e.scaleX,E=(l[s+1]+e.offsetY)*e.scaleY;if(y>=E)return;const C=u[r],I=u[r+1],x=u[r+2],R=u[o],P=u[o+1],M=u[o+2],k=u[a],N=u[a+1],L=u[a+2],Y=Math.round(y),ie=Math.round(E);let se,De,F,$,U,K,Q,ce;for(let le=Y;le<=ie;le++){if(le<T){const me=le<y?0:(y-le)/(y-T);se=m-(m-A)*me,De=C-(C-R)*me,F=I-(I-P)*me,$=x-(x-M)*me}else{let me;le>E?me=1:T===E?me=0:me=(T-le)/(T-E),se=A-(A-_)*me,De=R-(R-k)*me,F=P-(P-N)*me,$=M-(M-L)*me}let Re;le<y?Re=0:le>E?Re=1:Re=(y-le)/(y-E),U=m-(m-_)*Re,K=C-(C-k)*Re,Q=I-(I-N)*Re,ce=x-(x-L)*Re;const Xt=Math.round(Math.min(se,U)),Yi=Math.round(Math.max(se,U));let Ge=p*le+Xt*4;for(let me=Xt;me<=Yi;me++)Re=(se-me)/(se-U),Re<0?Re=0:Re>1&&(Re=1),h[Ge++]=De-(De-K)*Re|0,h[Ge++]=F-(F-Q)*Re|0,h[Ge++]=$-($-ce)*Re|0,h[Ge++]=255}}function WD(n,e,t){const i=e.coords,s=e.colors;let r,o;switch(e.type){case"lattice":const a=e.verticesPerRow,l=Math.floor(i.length/a)-1,u=a-1;for(r=0;r<l;r++){let h=r*a;for(let p=0;p<u;p++,h++)Mg(n,t,i[h],i[h+1],i[h+a],s[h],s[h+1],s[h+a]),Mg(n,t,i[h+a+1],i[h+1],i[h+a],s[h+a+1],s[h+1],s[h+a])}break;case"triangles":for(r=0,o=i.length;r<o;r+=3)Mg(n,t,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class YD extends s0{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,i){const a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-a,h=Math.ceil(this._bounds[3])-l,p=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),g=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),m=u/p,y=h/g,A={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/m,scaleY:1/y},T=p+2*2,_=g+2*2,E=i.getCanvas("mesh",T,_),C=E.context,I=C.createImageData(p,g);if(t){const R=I.data;for(let P=0,M=R.length;P<M;P+=4)R[P]=t[0],R[P+1]=t[1],R[P+2]=t[2],R[P+3]=255}for(const R of this._figures)WD(I,R,A);return C.putImageData(I,2,2),{canvas:E.canvas,offsetX:a-2*m,offsetY:l-2*y,scaleX:m,scaleY:y}}getPattern(e,t,i,s){oy(e,this._bbox);let r;if(s===Nt.SHADING)r=W.singularValueDecompose2dScale(ke(e));else if(r=W.singularValueDecompose2dScale(t.baseTransform),this.matrix){const a=W.singularValueDecompose2dScale(this.matrix);r=[r[0]*a[0],r[1]*a[1]]}const o=this._createMeshCanvas(r,s===Nt.SHADING?null:this._background,t.cachedCanvases);return s!==Nt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class KD extends s0{getPattern(){return"hotpink"}}function JD(n){switch(n[0]){case"RadialAxial":return new $D(n);case"Mesh":return new YD(n);case"Dummy":return new KD}throw new Error(`Unknown IR type: ${n[0]}`)}const tE={COLORED:1,UNCOLORED:2},fp=class fp{constructor(e,t,i,s,r){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:s,tilingType:r,color:o,canvasGraphicsFactory:a}=this;let{xstep:l,ystep:u}=this;l=Math.abs(l),u=Math.abs(u),Yp("TilingType: "+r);const h=t[0],p=t[1],g=t[2],m=t[3],y=g-h,A=m-p,T=W.singularValueDecompose2dScale(this.matrix),_=W.singularValueDecompose2dScale(this.baseTransform),E=T[0]*_[0],C=T[1]*_[1];let I=y,x=A,R=!1,P=!1;const M=Math.ceil(l*E),k=Math.ceil(u*C),N=Math.ceil(y*E),L=Math.ceil(A*C);M>=N?I=l:R=!0,k>=L?x=u:P=!0;const Y=this.getSizeAndScale(I,this.ctx.canvas.width,E),ie=this.getSizeAndScale(x,this.ctx.canvas.height,C),se=e.cachedCanvases.getCanvas("pattern",Y.size,ie.size),De=se.context,F=a.createCanvasGraphics(De);if(F.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(F,s,o),De.translate(-Y.scale*h,-ie.scale*p),F.transform(Y.scale,0,0,ie.scale,0,0),De.save(),this.clipBbox(F,h,p,g,m),F.baseTransform=ke(F.ctx),F.executeOperatorList(i),F.endDrawing(),De.restore(),R||P){const $=se.canvas;R&&(I=l),P&&(x=u);const U=this.getSizeAndScale(I,this.ctx.canvas.width,E),K=this.getSizeAndScale(x,this.ctx.canvas.height,C),Q=U.size,ce=K.size,le=e.cachedCanvases.getCanvas("pattern-workaround",Q,ce),Re=le.context,Xt=R?Math.floor(y/l):0,Yi=P?Math.floor(A/u):0;for(let Ge=0;Ge<=Xt;Ge++)for(let me=0;me<=Yi;me++)Re.drawImage($,Q*Ge,ce*me,Q,ce,0,0,Q,ce);return{canvas:le.canvas,scaleX:U.scale,scaleY:K.scale,offsetX:h,offsetY:p}}return{canvas:se.canvas,scaleX:Y.scale,scaleY:ie.scale,offsetX:h,offsetY:p}}getSizeAndScale(e,t,i){const s=Math.max(fp.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*i);return r>=s?r=s:i=r/e,{scale:i,size:r}}clipBbox(e,t,i,s,r){const o=s-t,a=r-i;e.ctx.rect(t,i,o,a),e.current.updateRectMinMax(ke(e.ctx),[t,i,s,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const s=e.ctx,r=e.current;switch(t){case tE.COLORED:const o=this.ctx;s.fillStyle=o.fillStyle,s.strokeStyle=o.strokeStyle,r.fillColor=o.fillStyle,r.strokeColor=o.strokeStyle;break;case tE.UNCOLORED:const a=W.makeHexColor(i[0],i[1],i[2]);s.fillStyle=a,s.strokeStyle=a,r.fillColor=a,r.strokeColor=a;break;default:throw new ED(`Unsupported paint type: ${t}`)}}getPattern(e,t,i,s){let r=i;s!==Nt.SHADING&&(r=W.transform(r,t.baseTransform),this.matrix&&(r=W.transform(r,this.matrix)));const o=this.createPatternCanvas(t);let a=new DOMMatrix(r);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const l=e.createPattern(o.canvas,"repeat");return l.setTransform(a),l}};J(fp,"MAX_PATTERN_SIZE",3e3);let ay=fp;function XD({src:n,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const a=$t.isLittleEndian?4278190080:255,[l,u]=o?[r,a]:[a,r],h=i>>3,p=i&7,g=n.length;t=new Uint32Array(t.buffer);let m=0;for(let y=0;y<s;y++){for(const T=e+h;e<T;e++){const _=e<g?n[e]:255;t[m++]=_&128?u:l,t[m++]=_&64?u:l,t[m++]=_&32?u:l,t[m++]=_&16?u:l,t[m++]=_&8?u:l,t[m++]=_&4?u:l,t[m++]=_&2?u:l,t[m++]=_&1?u:l}if(p===0)continue;const A=e<g?n[e++]:255;for(let T=0;T<p;T++)t[m++]=A&1<<7-T?u:l}return{srcPos:e,destPos:m}}const nE=16,iE=100,QD=15,sE=10,rE=1e3,sn=16;function ZD(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(i,s){e.translate(i,s),this.__originalTranslate(i,s)},n.scale=function(i,s){e.scale(i,s),this.__originalScale(i,s)},n.transform=function(i,s,r,o,a,l){e.transform(i,s,r,o,a,l),this.__originalTransform(i,s,r,o,a,l)},n.setTransform=function(i,s,r,o,a,l){e.setTransform(i,s,r,o,a,l),this.__originalSetTransform(i,s,r,o,a,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(i){e.rotate(i),this.__originalRotate(i)},n.clip=function(i){e.clip(i),this.__originalClip(i)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,s,r,o,a){e.bezierCurveTo(t,i,s,r,o,a),this.__originalBezierCurveTo(t,i,s,r,o,a)},n.rect=function(t,i,s,r){e.rect(t,i,s,r),this.__originalRect(t,i,s,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class jD{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,i)):(s=this.canvasFactory.create(t,i),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Mh(n,e,t,i,s,r,o,a,l,u){const[h,p,g,m,y,A]=ke(n);if(p===0&&g===0){const E=o*h+y,C=Math.round(E),I=a*m+A,x=Math.round(I),R=(o+l)*h+y,P=Math.abs(Math.round(R)-C)||1,M=(a+u)*m+A,k=Math.abs(Math.round(M)-x)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(m),C,x),n.drawImage(e,t,i,s,r,0,0,P,k),n.setTransform(h,p,g,m,y,A),[P,k]}if(h===0&&m===0){const E=a*g+y,C=Math.round(E),I=o*p+A,x=Math.round(I),R=(a+u)*g+y,P=Math.abs(Math.round(R)-C)||1,M=(o+l)*p+A,k=Math.abs(Math.round(M)-x)||1;return n.setTransform(0,Math.sign(p),Math.sign(g),0,C,x),n.drawImage(e,t,i,s,r,0,0,k,P),n.setTransform(h,p,g,m,y,A),[k,P]}n.drawImage(e,t,i,s,r,o,a,l,u);const T=Math.hypot(h,p),_=Math.hypot(g,m);return[T*l,_*u]}function eL(n){const{width:e,height:t}=n;if(e>rE||t>rE)return null;const i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let o=new Uint8Array(r*(t+1)),a,l,u;const h=e+7&-8;let p=new Uint8Array(h*t),g=0;for(const _ of n.data){let E=128;for(;E>0;)p[g++]=_&E?0:255,E>>=1}let m=0;for(g=0,p[g]!==0&&(o[0]=1,++m),l=1;l<e;l++)p[g]!==p[g+1]&&(o[l]=p[g]?2:1,++m),g++;for(p[g]!==0&&(o[l]=2,++m),a=1;a<t;a++){g=a*h,u=a*r,p[g-h]!==p[g]&&(o[u]=p[g]?1:8,++m);let _=(p[g]?4:0)+(p[g-h]?8:0);for(l=1;l<e;l++)_=(_>>2)+(p[g+1]?4:0)+(p[g-h+1]?8:0),s[_]&&(o[u+l]=s[_],++m),g++;if(p[g-h]!==p[g]&&(o[u+l]=p[g]?2:4,++m),m>i)return null}for(g=h*(t-1),u=a*r,p[g]!==0&&(o[u]=8,++m),l=1;l<e;l++)p[g]!==p[g+1]&&(o[u+l]=p[g]?4:8,++m),g++;if(p[g]!==0&&(o[u+l]=4,++m),m>i)return null;const y=new Int32Array([0,r,-1,0,-r,0,0,0,1]),A=new Path2D;for(a=0;m&&a<=t;a++){let _=a*r;const E=_+e;for(;_<E&&!o[_];)_++;if(_===E)continue;A.moveTo(_%r,a);const C=_;let I=o[_];do{const x=y[I];do _+=x;while(!o[_]);const R=o[_];R!==5&&R!==10?(I=R,o[_]=0):(I=R&51*I>>4,o[_]&=I>>2|I<<2),A.lineTo(_%r,_/r|0),o[_]||--m}while(C!==_);--a}return p=null,o=null,function(_){_.save(),_.scale(1/e,-1/t),_.translate(0,-t),_.fill(A),_.beginPath(),_.restore()}}class oE{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=nC,this.textMatrixScale=1,this.fontMatrix=Lm,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Tt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,i){[t,i]=W.applyTransform([t,i],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(e,t){const i=W.applyTransform(t,e),s=W.applyTransform(t.slice(2),e),r=W.applyTransform([t[0],t[3]],e),o=W.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,i[0],s[0],r[0],o[0]),this.minY=Math.min(this.minY,i[1],s[1],r[1],o[1]),this.maxX=Math.max(this.maxX,i[0],s[0],r[0],o[0]),this.maxY=Math.max(this.maxY,i[1],s[1],r[1],o[1])}updateScalingPathMinMax(e,t){W.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,i,s,r,o,a,l,u,h){const p=W.bezierBoundingBox(t,i,s,r,o,a,l,u,h);h||this.updateRectMinMax(e,p)}getPathBoundingBox(e=Nt.FILL,t=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(e===Nt.STROKE){t||Se("Stroke bounding box must include transform.");const s=W.singularValueDecompose2dScale(t),r=s[0]*this.lineWidth/2,o=s[1]*this.lineWidth/2;i[0]-=r,i[1]-=o,i[2]+=r,i[3]+=o}return i}updateClipFromPath(){const e=W.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Nt.FILL,t=null){return W.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function aE(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,s=t%sn,r=(t-s)/sn,o=s===0?r:r+1,a=n.createImageData(i,sn);let l=0,u;const h=e.data,p=a.data;let g,m,y,A;if(e.kind===Yh.GRAYSCALE_1BPP){const T=h.byteLength,_=new Uint32Array(p.buffer,0,p.byteLength>>2),E=_.length,C=i+7>>3,I=4294967295,x=$t.isLittleEndian?4278190080:255;for(g=0;g<o;g++){for(y=g<r?sn:s,u=0,m=0;m<y;m++){const R=T-l;let P=0;const M=R>C?i:R*8-7,k=M&-8;let N=0,L=0;for(;P<k;P+=8)L=h[l++],_[u++]=L&128?I:x,_[u++]=L&64?I:x,_[u++]=L&32?I:x,_[u++]=L&16?I:x,_[u++]=L&8?I:x,_[u++]=L&4?I:x,_[u++]=L&2?I:x,_[u++]=L&1?I:x;for(;P<M;P++)N===0&&(L=h[l++],N=128),_[u++]=L&N?I:x,N>>=1}for(;u<E;)_[u++]=0;n.putImageData(a,0,g*sn)}}else if(e.kind===Yh.RGBA_32BPP){for(m=0,A=i*sn*4,g=0;g<r;g++)p.set(h.subarray(l,l+A)),l+=A,n.putImageData(a,0,m),m+=sn;g<o&&(A=i*s*4,p.set(h.subarray(l,l+A)),n.putImageData(a,0,m))}else if(e.kind===Yh.RGB_24BPP)for(y=sn,A=i*y,g=0;g<o;g++){for(g>=r&&(y=s,A=i*y),u=0,m=A;m--;)p[u++]=h[l++],p[u++]=h[l++],p[u++]=h[l++],p[u++]=255;n.putImageData(a,0,g*sn)}else throw new Error(`bad image kind: ${e.kind}`)}function lE(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,s=t%sn,r=(t-s)/sn,o=s===0?r:r+1,a=n.createImageData(i,sn);let l=0;const u=e.data,h=a.data;for(let p=0;p<o;p++){const g=p<r?sn:s;({srcPos:l}=XD({src:u,srcPos:l,dest:h,width:i,height:g,nonBlackColor:0})),n.putImageData(a,0,p*sn)}}function Nu(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function kh(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Dt){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function uE(n,e){if(e)return!0;const t=W.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*Or.PDF_TO_CSS_UNITS);return t[0]<=i&&t[1]<=i}const tL=["butt","round","square"],nL=["miter","round","bevel"],iL={},cE={};var _i,ly,uy,cy;const u0=class u0{constructor(e,t,i,s,r,{optionalContentConfig:o,markedContentStack:a=null},l,u){S(this,_i);this.ctx=e,this.current=new oE(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new jD(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=a,i){const l=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...ke(this.compositeCtx))}this.ctx.save(),kh(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=ke(this.ctx)}executeOperatorList(e,t,i,s){const r=e.argsArray,o=e.fnArray;let a=t||0;const l=r.length;if(l===a)return a;const u=l-a>sE&&typeof i=="function",h=u?Date.now()+QD:0;let p=0;const g=this.commonObjs,m=this.objs;let y;for(;;){if(s!==void 0&&a===s.nextBreakPoint)return s.breakIt(a,i),a;if(y=o[a],y!==jn.dependency)this[y].apply(this,r[a]);else for(const A of r[a]){const T=A.startsWith("g_")?g:m;if(!T.has(A))return T.get(A,i),a}if(a++,a===l)return a;if(u&&++p>sE){if(Date.now()>h)return i(),a;p=0}}}endDrawing(){w(this,_i,ly).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),w(this,_i,uy).call(this)}_scaleImage(e,t){const i=e.width??e.displayWidth,s=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=i,l=s,u="prescale1",h,p;for(;r>2&&a>1||o>2&&l>1;){let g=a,m=l;r>2&&a>1&&(g=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),r/=a/g),o>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/m),h=this.cachedCanvases.getCanvas(u,g,m),p=h.context,p.clearRect(0,0,g,m),p.drawImage(e,0,0,a,l,0,0,g,m),e=h.canvas,a=g,l=m,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:s}=e,r=this.current.fillColor,o=this.current.patternFill,a=ke(t);let l,u,h,p;if((e.bitmap||e.data)&&e.count>1){const M=e.bitmap||e.data.buffer;u=JSON.stringify(o?a:[a.slice(0,4),r]),l=this._cachedBitmapsMap.get(M),l||(l=new Map,this._cachedBitmapsMap.set(M,l));const k=l.get(u);if(k&&!o){const N=Math.round(Math.min(a[0],a[2])+a[4]),L=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:k,offsetX:N,offsetY:L}}h=k}h||(p=this.cachedCanvases.getCanvas("maskCanvas",i,s),lE(p.context,e));let g=W.transform(a,[1/i,0,0,-1/s,0,0]);g=W.transform(g,[1,0,0,1,0,-s]);const[m,y,A,T]=W.getAxialAlignedBoundingBox([0,0,i,s],g),_=Math.round(A-m)||1,E=Math.round(T-y)||1,C=this.cachedCanvases.getCanvas("fillCanvas",_,E),I=C.context,x=m,R=y;I.translate(-x,-R),I.transform(...g),h||(h=this._scaleImage(p.canvas,Si(I)),h=h.img,l&&o&&l.set(u,h)),I.imageSmoothingEnabled=uE(ke(I),e.interpolate),Mh(I,h,0,0,h.width,h.height,0,0,i,s),I.globalCompositeOperation="source-in";const P=W.transform(Si(I),[1,0,0,1,-x,-R]);return I.fillStyle=o?r.getPattern(t,this,P,Nt.FILL):r,I.fillRect(0,0,i,s),l&&!o&&(this.cachedCanvases.delete("fillCanvas"),l.set(u,C.canvas)),{canvas:C.canvas,offsetX:Math.round(x),offsetY:Math.round(R)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=tL[e]}setLineJoin(e){this.ctx.lineJoin=nL[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx,this.ctx=s.context;const r=this.ctx;r.setTransform(...ke(this.suspendedCtx)),Nu(this.suspendedCtx,r),ZD(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Nu(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,s){const r=s[0],o=s[1],a=s[2]-r,l=s[3]-o;a===0||l===0||(this.genericComposeSMask(t.context,i,a,l,t.subtype,t.backdrop,t.transferMap,r,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,s,r,o,a,l,u,h,p){let g=e.canvas,m=l-h,y=u-p;if(o){const T=W.makeHexColor(...o);if(m<0||y<0||m+i>g.width||y+s>g.height){const _=this.cachedCanvases.getCanvas("maskExtension",i,s),E=_.context;E.drawImage(g,-m,-y),E.globalCompositeOperation="destination-atop",E.fillStyle=T,E.fillRect(0,0,i,s),E.globalCompositeOperation="source-over",g=_.canvas,m=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const _=new Path2D;_.rect(m,y,i,s),e.clip(_),e.globalCompositeOperation="destination-atop",e.fillStyle=T,e.fillRect(m,y,i,s),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const A=new Path2D;A.rect(l,u,i,s),t.clip(A),t.globalCompositeOperation="destination-in",t.drawImage(g,m,y,i,s,l,u,i,s),t.restore()}save(){this.inSMaskMode?(Nu(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Nu(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,i,s,r,o){this.ctx.transform(e,t,i,s,r,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){const s=this.ctx,r=this.current;let o=r.x,a=r.y,l,u;const h=ke(s),p=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,g=p?i.slice(0):null;for(let m=0,y=0,A=e.length;m<A;m++)switch(e[m]|0){case jn.rectangle:o=t[y++],a=t[y++];const T=t[y++],_=t[y++],E=o+T,C=a+_;s.moveTo(o,a),T===0||_===0?s.lineTo(E,C):(s.lineTo(E,a),s.lineTo(E,C),s.lineTo(o,C)),p||r.updateRectMinMax(h,[o,a,E,C]),s.closePath();break;case jn.moveTo:o=t[y++],a=t[y++],s.moveTo(o,a),p||r.updatePathMinMax(h,o,a);break;case jn.lineTo:o=t[y++],a=t[y++],s.lineTo(o,a),p||r.updatePathMinMax(h,o,a);break;case jn.curveTo:l=o,u=a,o=t[y+4],a=t[y+5],s.bezierCurveTo(t[y],t[y+1],t[y+2],t[y+3],o,a),r.updateCurvePathMinMax(h,l,u,t[y],t[y+1],t[y+2],t[y+3],o,a,g),y+=6;break;case jn.curveTo2:l=o,u=a,s.bezierCurveTo(o,a,t[y],t[y+1],t[y+2],t[y+3]),r.updateCurvePathMinMax(h,l,u,o,a,t[y],t[y+1],t[y+2],t[y+3],g),o=t[y+2],a=t[y+3],y+=4;break;case jn.curveTo3:l=o,u=a,o=t[y+2],a=t[y+3],s.bezierCurveTo(t[y],t[y+1],o,a,o,a),r.updateCurvePathMinMax(h,l,u,t[y],t[y+1],o,a,o,a,g),y+=4;break;case jn.closePath:s.closePath();break}p&&r.updateScalingPathMinMax(h,g),r.setCurrentPoint(o,a)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,i=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&(i!=null&&i.getPattern)?(t.save(),t.strokeStyle=i.getPattern(t,this,Si(t),Nt.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;let r=!1;s&&(t.save(),t.fillStyle=i.getPattern(t,this,Si(t),Nt.FILL),r=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=iL}eoClip(){this.pendingClip=cE}beginText(){this.current.textMatrix=nC,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const i=new Path2D,s=t.getTransform().invertSelf();for(const{transform:r,x:o,y:a,fontSize:l,path:u}of e)i.addPath(u,new DOMMatrix(r).preMultiplySelf(s).translate(o,a).scale(l,-l));t.clip(i),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const i=this.commonObjs.get(e),s=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=i.fontMatrix||Lm,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&te("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const r=i.loadedName||"sans-serif",o=((h=i.systemFontInfo)==null?void 0:h.css)||`"${r}", ${i.fallbackName}`;let a="normal";i.black?a="900":i.bold&&(a="bold");const l=i.italic?"italic":"normal";let u=t;t<nE?u=nE:t>iE&&(u=iE),this.current.fontSizeScale=t/u,this.ctx.font=`${l} ${a} ${u}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,i,s,r,o){this.current.textMatrix=[e,t,i,s,r,o],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,i,s,r){const o=this.ctx,a=this.current,l=a.font,u=a.textRenderingMode,h=a.fontSize/a.fontSizeScale,p=u&Tt.FILL_STROKE_MASK,g=!!(u&Tt.ADD_TO_PATH_FLAG),m=a.patternFill&&!l.missingFile,y=a.patternStroke&&!l.missingFile;let A;if((l.disableFontFace||g||m||y)&&(A=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||m||y){if(o.save(),o.translate(t,i),o.scale(h,-h),p===Tt.FILL||p===Tt.FILL_STROKE)if(s){const T=o.getTransform();o.setTransform(...s),o.fill(w(this,_i,cy).call(this,A,T,s))}else o.fill(A);if(p===Tt.STROKE||p===Tt.FILL_STROKE)if(r){const T=o.getTransform();o.setTransform(...r),o.stroke(w(this,_i,cy).call(this,A,T,r))}else o.lineWidth/=h,o.stroke(A);o.restore()}else(p===Tt.FILL||p===Tt.FILL_STROKE)&&o.fillText(e,t,i),(p===Tt.STROKE||p===Tt.FILL_STROKE)&&o.strokeText(e,t,i);g&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:ke(o),x:t,y:i,fontSize:h,path:A})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){i=!0;break}return oe(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(s===0)return;const r=this.ctx,o=t.fontSizeScale,a=t.charSpacing,l=t.wordSpacing,u=t.fontDirection,h=t.textHScale*u,p=e.length,g=i.vertical,m=g?1:-1,y=i.defaultVMetrics,A=s*t.fontMatrix[0],T=t.textRenderingMode===Tt.FILL&&!i.disableFontFace&&!t.patternFill;r.save(),r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),u>0?r.scale(h,-1):r.scale(h,1);let _,E;if(t.patternFill){r.save();const P=t.fillColor.getPattern(r,this,Si(r),Nt.FILL);_=ke(r),r.restore(),r.fillStyle=P}if(t.patternStroke){r.save();const P=t.strokeColor.getPattern(r,this,Si(r),Nt.STROKE);E=ke(r),r.restore(),r.strokeStyle=P}let C=t.lineWidth;const I=t.textMatrixScale;if(I===0||C===0){const P=t.textRenderingMode&Tt.FILL_STROKE_MASK;(P===Tt.STROKE||P===Tt.FILL_STROKE)&&(C=this.getSinglePixelWidth())}else C/=I;if(o!==1&&(r.scale(o,o),C/=o),r.lineWidth=C,i.isInvalidPDFjsFont){const P=[];let M=0;for(const k of e)P.push(k.unicode),M+=k.width;r.fillText(P.join(""),0,0),t.x+=M*A*h,r.restore(),this.compose();return}let x=0,R;for(R=0;R<p;++R){const P=e[R];if(typeof P=="number"){x+=m*P*s/1e3;continue}let M=!1;const k=(P.isSpace?l:0)+a,N=P.fontChar,L=P.accent;let Y,ie,se=P.width;if(g){const F=P.vmetric||y,$=-(P.vmetric?F[1]:se*.5)*A,U=F[2]*A;se=F?-F[0]:se,Y=$/o,ie=(x+U)/o}else Y=x/o,ie=0;if(i.remeasure&&se>0){const F=r.measureText(N).width*1e3/s*o;if(se<F&&this.isFontSubpixelAAEnabled){const $=se/F;M=!0,r.save(),r.scale($,1),Y/=$}else se!==F&&(Y+=(se-F)/2e3*s/o)}if(this.contentVisible&&(P.isInFont||i.missingFile)){if(T&&!L)r.fillText(N,Y,ie);else if(this.paintChar(N,Y,ie,_,E),L){const F=Y+s*L.offset.x/o,$=ie-s*L.offset.y/o;this.paintChar(L.fontChar,F,$,_,E)}}const De=g?se*A-k*u:se*A+k*u;x+=De,M&&r.restore()}g?t.y-=x:t.x+=x*h,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,s=i.font,r=i.fontSize,o=i.fontDirection,a=s.vertical?1:-1,l=i.charSpacing,u=i.wordSpacing,h=i.textHScale*o,p=i.fontMatrix||Lm,g=e.length,m=i.textRenderingMode===Tt.INVISIBLE;let y,A,T,_;if(!(m||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...i.textMatrix),t.translate(i.x,i.y),t.scale(h,o),y=0;y<g;++y){if(A=e[y],typeof A=="number"){_=a*A*r/1e3,this.ctx.translate(_,0),i.x+=_*h;continue}const E=(A.isSpace?u:0)+l,C=s.charProcOperatorList[A.operatorListId];if(!C){te(`Type3 character "${A.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=A,this.save(),t.scale(r,r),t.transform(...p),this.executeOperatorList(C),this.restore()),T=W.applyTransform([A.width,0],p)[0]*r+E,t.translate(T,0),i.x+=T*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,s,r,o){this.ctx.rect(i,s,r-i,o-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=e[1],s=this.baseTransform||ke(this.ctx),r={createCanvasGraphics:o=>new u0(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new ay(e,i,this.ctx,r,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,i){this.ctx.strokeStyle=this.current.strokeColor=W.makeHexColor(e,t,i),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,i){this.ctx.fillStyle=this.current.fillColor=W.makeHexColor(e,t,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=JD(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,Si(t),Nt.SHADING);const s=Si(t);if(s){const{width:r,height:o}=t.canvas,[a,l,u,h]=W.getAxialAlignedBoundingBox([0,0,r,o],s);this.ctx.fillRect(a,l,u-a,h-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Se("Should not call beginInlineImage")}beginImageData(){Se("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=ke(this.ctx),t)){const i=t[2]-t[0],s=t[3]-t[1];this.ctx.rect(t[0],t[1],i,s),this.current.updateRectMinMax(ke(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Yp("TODO: Support non-isolated groups."),e.knockout&&te("Knockout groups not supported.");const i=ke(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=W.getAxialAlignedBoundingBox(e.bbox,ke(t));const r=[0,0,t.canvas.width,t.canvas.height];s=W.intersect(s,r)||[0,0,0,0];const o=Math.floor(s[0]),a=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-o,1),u=Math.max(Math.ceil(s[3])-a,1);this.current.startNewPathAndClipBox([0,0,l,u]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(h,l,u),g=p.context;g.translate(-o,-a),g.transform(...i),e.smask?this.smaskStack.push({canvas:p.canvas,context:g,offsetX:o,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,a),t.save()),Nu(t,g),this.ctx=g,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=ke(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const r=W.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,i,s,r){if(w(this,_i,ly).call(this),kh(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const o=t[2]-t[0],a=t[3]-t[1];if(r&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=a;const[l,u]=W.singularValueDecompose2dScale(ke(this.ctx)),{viewportScale:h}=this,p=Math.ceil(o*this.outputScaleX*h),g=Math.ceil(a*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(p,g);const{canvas:m,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(e,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.save(),this.ctx.setTransform(l,0,0,-u,0,a*u),kh(this.ctx)}else kh(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],o,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new oE(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),w(this,_i,uy).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=eL(e)),s.compiled)){s.compiled(i);return}const r=this._createMaskCanvas(e),o=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(o,r.offsetX,r.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,s=0,r,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);const a=this.ctx;a.save();const l=ke(a);a.transform(t,i,s,r,0,0);const u=this._createMaskCanvas(e);a.setTransform(1,0,0,1,u.offsetX-l[4],u.offsetY-l[5]);for(let h=0,p=o.length;h<p;h+=2){const g=W.transform(l,[t,i,s,r,o[h],o[h+1]]),[m,y]=W.applyTransform([0,0],g);a.drawImage(u.canvas,m,y)}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const r of e){const{data:o,width:a,height:l,transform:u}=r,h=this.cachedCanvases.getCanvas("maskCanvas",a,l),p=h.context;p.save();const g=this.getObject(o,r);lE(p,g),p.globalCompositeOperation="source-in",p.fillStyle=s?i.getPattern(p,this,Si(t),Nt.FILL):i,p.fillRect(0,0,a,l),p.restore(),t.save(),t.transform(...u),t.scale(1,-1),Mh(t,h.canvas,0,0,a,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){te("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,s){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){te("Dependent image isn't ready yet");return}const o=r.width,a=r.height,l=[];for(let u=0,h=s.length;u<h;u+=2)l.push({transform:[t,0,0,i,s[u],s[u+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(r,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:s}=e,r=this.cachedCanvases.getCanvas("inlineImage",i,s),o=r.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,s=this.ctx;if(this.save(),!Dt){const{filter:a}=s;a!=="none"&&a!==""&&(s.filter="none")}s.scale(1/t,-1/i);let r;if(e.bitmap)r=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)r=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,i).context;aE(l,e),r=this.applyTransferMapsToCanvas(l)}const o=this._scaleImage(r,Si(s));s.imageSmoothingEnabled=uE(ke(s),e.interpolate),Mh(s,o.img,0,0,o.paintWidth,o.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const r=e.width,o=e.height,l=this.cachedCanvases.getCanvas("inlineImage",r,o).context;aE(l,e),s=this.applyTransferMapsToCanvas(l)}for(const r of t)i.save(),i.transform(...r.transform),i.scale(1,-1),Mh(i,s,r.x,r.y,r.w,r.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const i=this.ctx;this.pendingClip&&(t||(this.pendingClip===cE?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=ke(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:s,d:r}=this.ctx.getTransform();let o,a;if(i===0&&s===0){const l=Math.abs(t),u=Math.abs(r);if(l===u)if(e===0)o=a=1/l;else{const h=l*e;o=a=h<1?1/h:1}else if(e===0)o=1/l,a=1/u;else{const h=l*e,p=u*e;o=h<1?1/h:1,a=p<1?1/p:1}}else{const l=Math.abs(t*r-i*s),u=Math.hypot(t,i),h=Math.hypot(s,r);if(e===0)o=h/l,a=u/l;else{const p=e*l;o=h>p?h/p:1,a=u>p?u/p:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:i}=this.current,[s,r]=this.getScaleForStroking();if(t.lineWidth=i||1,s===1&&r===1){t.stroke();return}const o=t.getLineDash();if(e&&t.save(),t.scale(s,r),o.length>0){const a=Math.max(s,r);t.setLineDash(o.map(l=>l/a)),t.lineDashOffset/=a}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};_i=new WeakSet,ly=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},uy=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},cy=function(e,t,i){const s=new Path2D;return s.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),s};let nl=u0;for(const n in jn)nl.prototype[n]!==void 0&&(nl.prototype[jn[n]]=nl.prototype[n]);var ad,ld;class Is{static get workerPort(){return c(this,ad)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");v(this,ad,e)}static get workerSrc(){return c(this,ld)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");v(this,ld,e)}}ad=new WeakMap,ld=new WeakMap,S(Is,ad,null),S(Is,ld,"");var xo,ud;class sL{constructor({parsedData:e,rawData:t}){S(this,xo);S(this,ud);v(this,xo,e),v(this,ud,t)}getRaw(){return c(this,ud)}get(e){return c(this,xo).get(e)??null}getAll(){return Qv(c(this,xo))}has(e){return c(this,xo).has(e)}}xo=new WeakMap,ud=new WeakMap;const Pa=Symbol("INTERNAL");var cd,dd,hd,El;class rL{constructor(e,{name:t,intent:i,usage:s,rbGroups:r}){S(this,cd,!1);S(this,dd,!1);S(this,hd,!1);S(this,El,!0);v(this,cd,!!(e&Sn.DISPLAY)),v(this,dd,!!(e&Sn.PRINT)),this.name=t,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(c(this,hd))return c(this,El);if(!c(this,El))return!1;const{print:e,view:t}=this.usage;return c(this,cd)?(t==null?void 0:t.viewState)!=="OFF":c(this,dd)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,i=!1){e!==Pa&&Se("Internal method `_setVisible` called."),v(this,hd,i),v(this,El,t)}}cd=new WeakMap,dd=new WeakMap,hd=new WeakMap,El=new WeakMap;var ar,ve,Sl,wl,fd,dy;class oL{constructor(e,t=Sn.DISPLAY){S(this,fd);S(this,ar,null);S(this,ve,new Map);S(this,Sl,null);S(this,wl,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,v(this,wl,e.order);for(const i of e.groups)c(this,ve).set(i.id,new rL(t,i));if(e.baseState==="OFF")for(const i of c(this,ve).values())i._setVisible(Pa,!1);for(const i of e.on)c(this,ve).get(i)._setVisible(Pa,!0);for(const i of e.off)c(this,ve).get(i)._setVisible(Pa,!1);v(this,Sl,this.getHash())}}isVisible(e){if(c(this,ve).size===0)return!0;if(!e)return Yp("Optional content group not defined."),!0;if(e.type==="OCG")return c(this,ve).has(e.id)?c(this,ve).get(e.id).visible:(te(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return w(this,fd,dy).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!c(this,ve).has(t))return te(`Optional content group not found: ${t}`),!0;if(c(this,ve).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!c(this,ve).has(t))return te(`Optional content group not found: ${t}`),!0;if(!c(this,ve).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!c(this,ve).has(t))return te(`Optional content group not found: ${t}`),!0;if(!c(this,ve).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!c(this,ve).has(t))return te(`Optional content group not found: ${t}`),!0;if(c(this,ve).get(t).visible)return!1}return!0}return te(`Unknown optional content policy ${e.policy}.`),!0}return te(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){var r;const s=c(this,ve).get(e);if(!s){te(`Optional content group not found: ${e}`);return}if(i&&t&&s.rbGroups.length)for(const o of s.rbGroups)for(const a of o)a!==e&&((r=c(this,ve).get(a))==null||r._setVisible(Pa,!1,!0));s._setVisible(Pa,!!t,!0),v(this,ar,null)}setOCGState({state:e,preserveRB:t}){let i;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=c(this,ve).get(s);if(r)switch(i){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!r.visible,t);break}}v(this,ar,null)}get hasInitialVisibility(){return c(this,Sl)===null||this.getHash()===c(this,Sl)}getOrder(){return c(this,ve).size?c(this,wl)?c(this,wl).slice():[...c(this,ve).keys()]:null}getGroups(){return c(this,ve).size>0?Qv(c(this,ve)):null}getGroup(e){return c(this,ve).get(e)||null}getHash(){if(c(this,ar)!==null)return c(this,ar);const e=new bC;for(const[t,i]of c(this,ve))e.update(`${t}:${i.visible}`);return v(this,ar,e.hexdigest())}}ar=new WeakMap,ve=new WeakMap,Sl=new WeakMap,wl=new WeakMap,fd=new WeakSet,dy=function(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let s=1;s<t;s++){const r=e[s];let o;if(Array.isArray(r))o=w(this,fd,dy).call(this,r);else if(c(this,ve).has(r))o=c(this,ve).get(r).visible;else return te(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return i==="And"};class aL{constructor(e,{disableRange:t=!1,disableStream:i=!1}){Xe(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(r==null?void 0:r.length)>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,u)=>{this._onReceiveData({begin:l,chunk:u})}),e.addProgressListener((l,u)=>{this._onProgress({loaded:l,total:u})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(i),!0)});Xe(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,i,s,r;e.total===void 0?(i=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||i.call(t,{loaded:e.loaded}):(r=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||r.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Xe(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new lL(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new uL(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeReaders.slice(0))i.cancel(e);this._pdfDataRangeTransport.abort()}}class lL{constructor(e,t,i=!1,s=null){this._stream=e,this._done=i||!1,this._filename=e0(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class uL{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function cL(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let h=a(t);return h=unescape(h),h=l(h),h=u(h),r(h)}if(t=o(n),t){const h=u(t);return r(h)}if(t=i("filename","i").exec(n),t){t=t[1];let h=a(t);return h=u(h),r(h)}function i(h,p){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function s(h,p){if(h){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const g=new TextDecoder(h,{fatal:!0}),m=Kp(p);p=g.decode(m),e=!1}catch{}}return p}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=s("utf-8",h),e&&(h=s("iso-8859-1",h))),h}function o(h){const p=[];let g;const m=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(g=m.exec(h))!==null;){let[,A,T,_]=g;if(A=parseInt(A,10),A in p){if(A===0)break;continue}p[A]=[T,_]}const y=[];for(let A=0;A<p.length&&A in p;++A){let[T,_]=p[A];_=a(_),T&&(_=unescape(_),A===0&&(_=l(_))),y.push(_)}return y.join("")}function a(h){if(h.startsWith('"')){const p=h.slice(1).split('\\"');for(let g=0;g<p.length;++g){const m=p[g].indexOf('"');m!==-1&&(p[g]=p[g].slice(0,m),p.length=g+1),p[g]=p[g].replaceAll(/\\(.)/g,"$1")}h=p.join('"')}return h}function l(h){const p=h.indexOf("'");if(p===-1)return h;const g=h.slice(0,p),y=h.slice(p+1).replace(/^[^']*'/,"");return s(g,y)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,g,m,y){if(m==="q"||m==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,T){return String.fromCharCode(parseInt(T,16))}),s(g,y);try{y=atob(y)}catch{}return s(g,y)})}return""}function YC(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const s=e[i];s!==void 0&&t.append(i,s)}return t}function Qp(n){try{return new URL(n).origin}catch{}return null}function KC({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function JC(n){const e=n.get("Content-Disposition");if(e){let t=cL(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(e0(t))return t}return null}function Zp(n,e){return n===404||n===0&&e.startsWith("file:")?new Mc('Missing PDF "'+e+'".'):new Zf(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function XC(n){return n===200||n===206}function QC(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function ZC(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(te(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class dE{constructor(e){J(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=YC(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Xe(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new dL(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new hL(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class dL{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),s=t.url;fetch(s,QC(i,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=Qp(r.url),!XC(r.status))throw Zp(r.status,s);this._reader=r.body.getReader(),this._headersCapability.resolve();const o=r.headers,{allowRangeRequests:a,suggestedLength:l}=KC({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=JC(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Vr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:ZC(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class hL{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${i-1}`);const o=s.url;fetch(o,QC(r,this._withCredentials,this._abortController)).then(a=>{const l=Qp(a.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!XC(a.status))throw Zp(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:ZC(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const kg=200,Ng=206;function fL(n){const e=n.response;return typeof e!="string"?e:Kp(e).buffer}class pL{constructor({url:e,httpHeaders:t,withCredentials:i}){J(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=YC(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,o]of this.headers)t.setRequestHeader(r,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=Ng):s.expectedStatus=kg,t.responseType="arraybuffer",Xe(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){var s;const i=this.pendingRequests[e];i&&((s=i.onProgress)==null||s.call(i,t))}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){i.onError(s.status);return}const r=s.status||kg;if(!(r===kg&&i.expectedStatus===Ng)&&r!==i.expectedStatus){i.onError(s.status);return}const a=fL(s);if(r===Ng){const l=s.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);u?i.onDone({begin:parseInt(u[1],10),chunk:a}):(te('Missing or invalid "Content-Range" header.'),i.onError(0))}else a?i.onDone({begin:0,chunk:a}):i.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class gL{constructor(e){this._source=e,this._manager=new pL(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Xe(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new mL(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new yL(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class mL{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Qp(t.responseURL);const i=t.getAllResponseHeaders(),s=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[l,...u]=a.split(": ");return[l,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:o}=KC({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=JC(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Zp(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class yL{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Qp((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Zp(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const vL=/^[a-z][a-z0-9\-+.]+:/i;function _L(n){if(vL.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class AL{constructor(e){this.source=e,this.url=_L(e.url),Xe(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Xe(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new EL(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new SL(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class EL{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new Mc(`Missing PDF "${this._url}".`)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Vr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class SL{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const wL=1e5,Qt=30,CL=.8;var mE,lr,tn,pd,gd,Po,cs,md,yd,Ro,Cl,Tl,ur,Il,vd,xl,Mo,_d,Ad,ko,No,Ed,cr,Pl,Hs,jC,eT,hy,Pn,rf,fy,tT,nT;const je=class je{constructor({textContentSource:e,container:t,viewport:i}){S(this,Hs);S(this,lr,Promise.withResolvers());S(this,tn,null);S(this,pd,!1);S(this,gd,!!((mE=globalThis.FontInspector)!=null&&mE.enabled));S(this,Po,null);S(this,cs,null);S(this,md,0);S(this,yd,0);S(this,Ro,null);S(this,Cl,null);S(this,Tl,0);S(this,ur,0);S(this,Il,Object.create(null));S(this,vd,[]);S(this,xl,null);S(this,Mo,[]);S(this,_d,new WeakMap);S(this,Ad,null);var l;if(e instanceof ReadableStream)v(this,xl,e);else if(typeof e=="object")v(this,xl,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');v(this,tn,v(this,Cl,t)),v(this,ur,i.scale*(globalThis.devicePixelRatio||1)),v(this,Tl,i.rotation),v(this,cs,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:r,pageX:o,pageY:a}=i.rawDims;v(this,Ad,[1,0,0,-1,-o,a+r]),v(this,yd,s),v(this,md,r),w(l=je,Pn,tT).call(l),ga(t,i),c(this,lr).promise.finally(()=>{c(je,Pl).delete(this),v(this,cs,null),v(this,Il,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=$t.platform;return oe(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{c(this,Ro).read().then(({value:t,done:i})=>{if(i){c(this,lr).resolve();return}c(this,Po)??v(this,Po,t.lang),Object.assign(c(this,Il),t.styles),w(this,Hs,jC).call(this,t.items),e()},c(this,lr).reject)};return v(this,Ro,c(this,xl).getReader()),c(je,Pl).add(this),e(),c(this,lr).promise}update({viewport:e,onBefore:t=null}){var r;const i=e.scale*(globalThis.devicePixelRatio||1),s=e.rotation;if(s!==c(this,Tl)&&(t==null||t(),v(this,Tl,s),ga(c(this,Cl),{rotation:s})),i!==c(this,ur)){t==null||t(),v(this,ur,i);const o={div:null,properties:null,ctx:w(r=je,Pn,rf).call(r,c(this,Po))};for(const a of c(this,Mo))o.properties=c(this,_d).get(a),o.div=a,w(this,Hs,hy).call(this,o)}}cancel(){var t;const e=new Vr("TextLayer task cancelled.");(t=c(this,Ro))==null||t.cancel(e).catch(()=>{}),v(this,Ro,null),c(this,lr).reject(e)}get textDivs(){return c(this,Mo)}get textContentItemsStr(){return c(this,vd)}static cleanup(){if(!(c(this,Pl).size>0)){c(this,ko).clear();for(const{canvas:e}of c(this,No).values())e.remove();c(this,No).clear()}}};lr=new WeakMap,tn=new WeakMap,pd=new WeakMap,gd=new WeakMap,Po=new WeakMap,cs=new WeakMap,md=new WeakMap,yd=new WeakMap,Ro=new WeakMap,Cl=new WeakMap,Tl=new WeakMap,ur=new WeakMap,Il=new WeakMap,vd=new WeakMap,xl=new WeakMap,Mo=new WeakMap,_d=new WeakMap,Ad=new WeakMap,ko=new WeakMap,No=new WeakMap,Ed=new WeakMap,cr=new WeakMap,Pl=new WeakMap,Hs=new WeakSet,jC=function(e){var s,r;if(c(this,pd))return;(r=c(this,cs)).ctx??(r.ctx=w(s=je,Pn,rf).call(s,c(this,Po)));const t=c(this,Mo),i=c(this,vd);for(const o of e){if(t.length>wL){te("Ignoring additional textDivs for performance reasons."),v(this,pd,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=c(this,tn);v(this,tn,document.createElement("span")),c(this,tn).classList.add("markedContent"),o.id!==null&&c(this,tn).setAttribute("id",`${o.id}`),a.append(c(this,tn))}else o.type==="endMarkedContent"&&v(this,tn,c(this,tn).parentNode);continue}i.push(o.str),w(this,Hs,eT).call(this,o)}},eT=function(e){var A;const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};c(this,Mo).push(t);const s=W.transform(c(this,Ad),e.transform);let r=Math.atan2(s[1],s[0]);const o=c(this,Il)[e.fontName];o.vertical&&(r+=Math.PI/2);let a=c(this,gd)&&o.fontSubstitution||o.fontFamily;a=je.fontFamilyMap.get(a)||a;const l=Math.hypot(s[2],s[3]),u=l*w(A=je,Pn,nT).call(A,a,c(this,Po));let h,p;r===0?(h=s[4],p=s[5]-u):(h=s[4]+u*Math.sin(r),p=s[5]-u*Math.cos(r));const g="calc(var(--scale-factor)*",m=t.style;c(this,tn)===c(this,Cl)?(m.left=`${(100*h/c(this,yd)).toFixed(2)}%`,m.top=`${(100*p/c(this,md)).toFixed(2)}%`):(m.left=`${g}${h.toFixed(2)}px)`,m.top=`${g}${p.toFixed(2)}px)`),m.fontSize=`${g}${(c(je,cr)*l).toFixed(2)}px)`,m.fontFamily=a,i.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,c(this,gd)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),r!==0&&(i.angle=r*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const T=Math.abs(e.transform[0]),_=Math.abs(e.transform[3]);T!==_&&Math.max(T,_)/Math.min(T,_)>1.5&&(y=!0)}if(y&&(i.canvasWidth=o.vertical?e.height:e.width),c(this,_d).set(t,i),c(this,cs).div=t,c(this,cs).properties=i,w(this,Hs,hy).call(this,c(this,cs)),i.hasText&&c(this,tn).append(t),i.hasEOL){const T=document.createElement("br");T.setAttribute("role","presentation"),c(this,tn).append(T)}},hy=function(e){var a;const{div:t,properties:i,ctx:s}=e,{style:r}=t;let o="";if(c(je,cr)>1&&(o=`scale(${1/c(je,cr)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=r,{canvasWidth:u,fontSize:h}=i;w(a=je,Pn,fy).call(a,s,h*c(this,ur),l);const{width:p}=s.measureText(t.textContent);p>0&&(o=`scaleX(${u*c(this,ur)/p}) ${o}`)}i.angle!==0&&(o=`rotate(${i.angle}deg) ${o}`),o.length>0&&(r.transform=o)},Pn=new WeakSet,rf=function(e=null){let t=c(this,No).get(e||(e=""));if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),c(this,No).set(e,t),c(this,Ed).set(t,{size:0,family:""})}return t},fy=function(e,t,i){const s=c(this,Ed).get(e);t===s.size&&i===s.family||(e.font=`${t}px ${i}`,s.size=t,s.family=i)},tT=function(){if(c(this,cr)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),v(this,cr,e.getBoundingClientRect().height),e.remove()},nT=function(e,t){const i=c(this,ko).get(e);if(i)return i;const s=w(this,Pn,rf).call(this,t);s.canvas.width=s.canvas.height=Qt,w(this,Pn,fy).call(this,s,Qt,e);const r=s.measureText("");let o=r.fontBoundingBoxAscent,a=Math.abs(r.fontBoundingBoxDescent);if(o){const h=o/(o+a);return c(this,ko).set(e,h),s.canvas.width=s.canvas.height=0,h}s.strokeStyle="red",s.clearRect(0,0,Qt,Qt),s.strokeText("g",0,0);let l=s.getImageData(0,0,Qt,Qt).data;a=0;for(let h=l.length-1-3;h>=0;h-=4)if(l[h]>0){a=Math.ceil(h/4/Qt);break}s.clearRect(0,0,Qt,Qt),s.strokeText("A",0,Qt),l=s.getImageData(0,0,Qt,Qt).data,o=0;for(let h=0,p=l.length;h<p;h+=4)if(l[h]>0){o=Qt-Math.floor(h/4/Qt);break}s.canvas.width=s.canvas.height=0;const u=o?o/(o+a):CL;return c(this,ko).set(e,u),u},S(je,Pn),S(je,ko,new Map),S(je,No,new Map),S(je,Ed,new WeakMap),S(je,cr,null),S(je,Pl,new Set);let kc=je;class Nc{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function s(r){var l;if(!r)return;let o=null;const a=r.name;if(a==="#text")o=r.value;else if(Nc.shouldBuildText(a))(l=r==null?void 0:r.attributes)!=null&&l.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&t.push({str:o}),!!r.children)for(const u of r.children)s(u)}return s(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const TL=65536,IL=100,xL=5e3,PL=Dt?BD:VD,RL=Dt?zD:GC,ML=Dt?GD:OD,kL=Dt?qD:$C;function NL(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new py,{docId:t}=e,i=n.url?bL(n.url):null,s=n.data?DL(n.data):null,r=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,l=n.range instanceof iT?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:TL;let h=n.worker instanceof il?n.worker:null;const p=n.verbosity,g=typeof n.docBaseUrl=="string"&&!Xp(n.docBaseUrl)?n.docBaseUrl:null,m=typeof n.cMapUrl=="string"?n.cMapUrl:null,y=n.cMapPacked!==!1,A=n.CMapReaderFactory||RL,T=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,_=n.StandardFontDataFactory||kL,E=n.stopAtErrors!==!0,C=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,I=n.isEvalSupported!==!1,x=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Dt,R=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Dt&&($t.platform.isFirefox||!globalThis.chrome),P=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,M=typeof n.disableFontFace=="boolean"?n.disableFontFace:Dt,k=n.fontExtraProperties===!0,N=n.enableXfa===!0,L=n.ownerDocument||globalThis.document,Y=n.disableRange===!0,ie=n.disableStream===!0,se=n.disableAutoFetch===!0,De=n.pdfBug===!0,F=n.CanvasFactory||PL,$=n.FilterFactory||ML,U=n.enableHWA===!0,K=l?l.length:n.length??NaN,Q=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Dt&&!M,ce=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:A===GC&&_===$C&&m&&T&&Vu(m,document.baseURI)&&Vu(T,document.baseURI),le=null;yD(p);const Re={canvasFactory:new F({ownerDocument:L,enableHWA:U}),filterFactory:new $({docId:t,ownerDocument:L}),cMapReaderFactory:ce?null:new A({baseUrl:m,isCompressed:y}),standardFontDataFactory:ce?null:new _({baseUrl:T})};if(!h){const Ge={verbosity:p,port:Is.workerPort};h=Ge.port?il.fromPort(Ge):new il(Ge),e._worker=h}const Xt={docId:t,apiVersion:"4.10.38",data:s,password:a,disableAutoFetch:se,rangeChunkSize:u,length:K,docBaseUrl:g,enableXfa:N,evaluatorOptions:{maxImageSize:C,disableFontFace:M,ignoreErrors:E,isEvalSupported:I,isOffscreenCanvasSupported:x,isImageDecoderSupported:R,canvasMaxAreaInBytes:P,fontExtraProperties:k,useSystemFonts:Q,cMapUrl:ce?m:null,standardFontDataUrl:ce?T:null}},Yi={disableFontFace:M,fontExtraProperties:k,ownerDocument:L,pdfBug:De,styleElement:le,loadingParams:{disableAutoFetch:se,enableXfa:N}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Ge=h.messageHandler.sendWithPromise("GetDocRequest",Xt,s?[s.buffer]:null);let me;if(l)me=new aL(l,{disableRange:Y,disableStream:ie});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");let wa;if(Dt)if(Vu(i)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");wa=dE}else wa=AL;else wa=Vu(i)?dE:gL;me=new wa({url:i,length:K,httpHeaders:r,withCredentials:o,rangeChunkSize:u,disableRange:Y,disableStream:ie})}return Ge.then(wa=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const f0=new zu(t,wa,h.port),tI=new HL(f0,e,me,Yi,Re);e._transport=tI,f0.send("Ready",null)})}).catch(e._capability.reject),e}function bL(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Dt&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function DL(n){if(Dt&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Kp(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function hE(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var pp;const gp=class gp{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Ut(gp,pp)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,i,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,r}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}};pp=new WeakMap,S(gp,pp,0);let py=gp;class iT{constructor(e,t,i=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const i of this._rangeListeners)i(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Se("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class LL{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return oe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var dr,ds,Bn,Ra,of;class FL{constructor(e,t,i,s=!1){S(this,Bn);S(this,dr,null);S(this,ds,!1);this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=s?new ZA:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new sT,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new uh({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return oe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:s=Ks.ENABLE,transform:r=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:l=null,pageColors:u=null,printAnnotationStorage:h=null,isEditing:p=!1}){var I,x;(I=this._stats)==null||I.time("Overall");const g=this._transport.getRenderingIntent(i,s,h,p),{renderingIntent:m,cacheKey:y}=g;v(this,ds,!1),w(this,Bn,of).call(this),a||(a=this._transport.getOptionalContentConfig(m));let A=this._intentStates.get(y);A||(A=Object.create(null),this._intentStates.set(y,A)),A.streamReaderCancelTimeout&&(clearTimeout(A.streamReaderCancelTimeout),A.streamReaderCancelTimeout=null);const T=!!(m&Sn.PRINT);A.displayReadyCapability||(A.displayReadyCapability=Promise.withResolvers(),A.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(x=this._stats)==null||x.time("Page Request"),this._pumpOperatorList(g));const _=R=>{var P;A.renderTasks.delete(E),(this._maybeCleanupAfterRender||T)&&v(this,ds,!0),w(this,Bn,Ra).call(this,!T),R?(E.capability.reject(R),this._abortOperatorList({intentState:A,reason:R instanceof Error?R:new Error(R)})):E.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(P=globalThis.Stats)!=null&&P.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},E=new my({callback:_,params:{canvasContext:e,viewport:t,transform:r,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:A.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:u});(A.renderTasks||(A.renderTasks=new Set)).add(E);const C=E.task;return Promise.all([A.displayReadyCapability.promise,a]).then(([R,P])=>{var M;if(this.destroyed){_();return}if((M=this._stats)==null||M.time("Rendering"),!(P.renderingIntent&m))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");E.initializeGraphics({transparency:R,optionalContentConfig:P}),E.operatorListChanged()}).catch(_),C}getOperatorList({intent:e="display",annotationMode:t=Ks.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){var u;function r(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const o=this._transport.getRenderingIntent(e,t,i,s,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Nc.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,s){function r(){o.read().then(function({value:l,done:u}){if(u){i(a);return}a.lang??(a.lang=l.lang),Object.assign(a.styles,l.styles),a.items.push(...l.items),r()},s)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),v(this,ds,!1),w(this,Bn,of).call(this),Promise.all(e)}cleanup(e=!1){v(this,ds,!0);const t=w(this,Bn,Ra).call(this,!1);return e&&t&&this._stats&&(this._stats=new ZA),t}_startRenderPage(e,t){var s,r;const i=this._intentStates.get(t);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(r=i.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let i=0,s=e.length;i<s;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&w(this,Bn,Ra).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:s}){const{map:r,transfer:o}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:s},o).getReader(),u=this._intentStates.get(t);u.streamReader=l;const h=()=>{l.read().then(({value:p,done:g})=>{if(g){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,u),h())},p=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const g of u.renderTasks)g.operatorListChanged();w(this,Bn,Ra).call(this,!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(p);else if(u.opListReadCapability)u.opListReadCapability.reject(p);else throw p}})};h()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof jv){let s=IL;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new Vr(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}dr=new WeakMap,ds=new WeakMap,Bn=new WeakSet,Ra=function(e=!1){if(w(this,Bn,of).call(this),!c(this,ds)||this.destroyed)return!1;if(e)return v(this,dr,setTimeout(()=>{v(this,dr,null),w(this,Bn,Ra).call(this,!1)},xL)),!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),v(this,ds,!1),!0},of=function(){c(this,dr)&&(clearTimeout(c(this,dr)),v(this,dr,null))};var hs,mp;class UL{constructor(){S(this,hs,new Map);S(this,mp,Promise.resolve())}postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};c(this,mp).then(()=>{for(const[s]of c(this,hs))s.call(this,i)})}addEventListener(e,t,i=null){let s=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:r}=i;if(r.aborted){te("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);s=()=>r.removeEventListener("abort",o),r.addEventListener("abort",o)}c(this,hs).set(t,s)}removeEventListener(e,t){const i=c(this,hs).get(t);i==null||i(),c(this,hs).delete(t)}terminate(){for(const[,e]of c(this,hs))e==null||e();c(this,hs).clear()}}hs=new WeakMap,mp=new WeakMap;var yp,bo,Do,Rl,af,Ml,lf;const Me=class Me{constructor({name:e=null,port:t=null,verbosity:i=vD()}={}){S(this,Rl);var s;if(this.name=e,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((s=c(Me,Do))!=null&&s.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(c(Me,Do)||v(Me,Do,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new zu("main","worker",e),this._messageHandler.on("ready",function(){}),w(this,Rl,af).call(this)}_initialize(){if(c(Me,bo)||c(Me,Ml,lf)){this._setupFakeWorker();return}let{workerSrc:e}=Me;try{Me._isSameOrigin(window.location.href,e)||(e=Me._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new zu("main","worker",t),s=()=>{r.abort(),i.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;t.addEventListener("error",()=>{this._webWorker||s()},{signal:r.signal}),i.on("test",a=>{if(r.abort(),this.destroyed||!a){s();return}this._messageHandler=i,this._port=t,this._webWorker=t,w(this,Rl,af).call(this)}),i.on("ready",a=>{if(r.abort(),this.destroyed){s();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const a=new Uint8Array;i.send("test",a,[a.buffer])};o();return}catch{Yp("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){c(Me,bo)||(te("Setting up fake worker."),v(Me,bo,!0)),Me._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new UL;this._port=t;const i=`fake${Ut(Me,yp)._++}`,s=new zu(i+"_worker",i,t);e.setup(s,t),this._messageHandler=new zu(i,i+"_worker",t),w(this,Rl,af).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,i;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=c(Me,Do))==null||t.delete(this._port),this._port=null,(i=this._messageHandler)==null||i.destroy(),this._messageHandler=null}static fromPort(e){var i;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(i=c(this,Do))==null?void 0:i.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Me(e)}static get workerSrc(){if(Is.workerSrc)return Is.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return oe(this,"_setupFakeWorkerGlobal",(async()=>c(this,Ml,lf)?c(this,Ml,lf):(await import(this.workerSrc)).WorkerMessageHandler)())}};yp=new WeakMap,bo=new WeakMap,Do=new WeakMap,Rl=new WeakSet,af=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Ml=new WeakSet,lf=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},S(Me,Ml),S(Me,yp,0),S(Me,bo,!1),S(Me,Do),Dt&&(v(Me,bo,!0),Is.workerSrc||(Is.workerSrc="./pdf.worker.mjs")),Me._isSameOrigin=(e,t)=>{let i;try{if(i=new URL(e),!i.origin||i.origin==="null")return!1}catch{return!1}const s=new URL(t,i);return i.origin===s.origin},Me._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let il=Me;var fs,Li,kl,Nl,ps,Lo,Ku;class HL{constructor(e,t,i,s,r){S(this,Lo);S(this,fs,new Map);S(this,Li,new Map);S(this,kl,new Map);S(this,Nl,new Map);S(this,ps,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new sT,this.fontLoader=new UD({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return oe(this,"annotationStorage",new i0)}getRenderingIntent(e,t=Ks.ENABLE,i=null,s=!1,r=!1){let o=Sn.DISPLAY,a=iy;switch(e){case"any":o=Sn.ANY;break;case"display":break;case"print":o=Sn.PRINT;break;default:te(`getRenderingIntent - invalid intent: ${e}`)}const l=o&Sn.PRINT&&i instanceof LC?i:this.annotationStorage;switch(t){case Ks.DISABLE:o+=Sn.ANNOTATIONS_DISABLE;break;case Ks.ENABLE:break;case Ks.ENABLE_FORMS:o+=Sn.ANNOTATIONS_FORMS;break;case Ks.ENABLE_STORAGE:o+=Sn.ANNOTATIONS_STORAGE,a=l.serializable;break;default:te(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(o+=Sn.IS_EDITING),r&&(o+=Sn.OPLIST);const{ids:u,hash:h}=l.modifiedIds,p=[o,a.hash,h];return{renderingIntent:o,cacheKey:p.join("_"),annotationStorageSerializable:a,modifiedIds:u}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=c(this,ps))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of c(this,Li).values())e.push(s._destroy());c(this,Li).clear(),c(this,kl).clear(),c(this,Nl).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,r;this.commonObjs.clear(),this.fontLoader.clear(),c(this,fs).clear(),this.filterFactory.destroy(),kc.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new Vr("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,s)=>{Xe(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},s.onPull=()=>{this._fullReader.read().then(function({value:r,done:o}){if(o){s.close();return}Xe(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{this._fullReader.cancel(r),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async i=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:r,contentLength:o}=this._fullReader;return(!s||!r)&&(this._lastProgress&&((a=t.onProgress)==null||a.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:s,isRangeSupported:r,contentLength:o}}),e.on("GetRangeReader",(i,s)=>{Xe(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:o,done:a}){if(a){s.close();return}Xe(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{r.cancel(o),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new LL(i,this))}),e.on("DocException",i=>{t._capability.reject(Zt(i))}),e.on("PasswordRequest",i=>{v(this,ps,Promise.withResolvers());try{if(!t.onPassword)throw Zt(i);const s=r=>{r instanceof Error?c(this,ps).reject(r):c(this,ps).resolve({password:r})};t.onPassword(s,i.code)}catch(s){c(this,ps).reject(s)}return c(this,ps).promise}),e.on("DataLoaded",i=>{var s;(s=t.onProgress)==null||s.call(t,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;c(this,Li).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,s,r])=>{var o;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":const{disableFontFace:a,fontExtraProperties:l,pdfBug:u}=this._params;if("error"in r){const m=r.error;te(`Error during font loading: ${m}`),this.commonObjs.resolve(i,m);break}const h=u&&((o=globalThis.FontInspector)!=null&&o.enabled)?(m,y)=>globalThis.FontInspector.fontAdded(m,y):null,p=new HD(r,{disableFontFace:a,fontExtraProperties:l,inspectFont:h});this.fontLoader.bind(p).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l&&p.data&&(p.data=null),this.commonObjs.resolve(i,p)});break;case"CopyLocalImage":const{imageRef:g}=r;Xe(g,"The imageRef must be defined.");for(const m of c(this,Li).values())for(const[,y]of m.objs)if((y==null?void 0:y.ref)===g)return y.dataLen?(this.commonObjs.resolve(i,structuredClone(y)),y.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([i,s,r,o])=>{var l;if(this.destroyed)return;const a=c(this,Li).get(s);if(!a.objs.has(i)){if(a._intentStates.size===0){(l=o==null?void 0:o.bitmap)==null||l.close();return}switch(r){case"Image":a.objs.resolve(i,o),(o==null?void 0:o.dataLen)>fD&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(i,o);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",i=>{var s;this.destroyed||(s=t.onProgress)==null||s.call(t,{loaded:i.loaded,total:i.total})}),e.on("FetchBuiltInCMap",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(i)}),e.on("FetchStandardFontData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&te("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((i=this._fullReader)==null?void 0:i.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=c(this,kl).get(t);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&c(this,Nl).set(r.refStr,e);const o=new FL(t,r,this,this._params.pdfBug);return c(this,Li).set(t,o),o});return c(this,kl).set(t,s),s}getPageIndex(e){return hE(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return w(this,Lo,Ku).call(this,"GetFieldObjects")}hasJSActions(){return w(this,Lo,Ku).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return w(this,Lo,Ku).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return w(this,Lo,Ku).call(this,"GetOptionalContentConfig").then(t=>new oL(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=c(this,fs).get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(s=>{var r,o;return{info:s[0],metadata:s[1]?new sL(s[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return c(this,fs).set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of c(this,Li).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),c(this,fs).clear(),this.filterFactory.destroy(!0),kc.cleanup()}}cachedPageNumber(e){if(!hE(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return c(this,Nl).get(t)??null}}fs=new WeakMap,Li=new WeakMap,kl=new WeakMap,Nl=new WeakMap,ps=new WeakMap,Lo=new WeakSet,Ku=function(e,t=null){const i=c(this,fs).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise(e,t);return c(this,fs).set(e,s),s};const bu=Symbol("INITIAL_DATA");var fn,Sd,gy;class sT{constructor(){S(this,Sd);S(this,fn,Object.create(null))}get(e,t=null){if(t){const s=w(this,Sd,gy).call(this,e);return s.promise.then(()=>t(s.data)),null}const i=c(this,fn)[e];if(!i||i.data===bu)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=c(this,fn)[e];return!!t&&t.data!==bu}delete(e){const t=c(this,fn)[e];return!t||t.data===bu?!1:(delete c(this,fn)[e],!0)}resolve(e,t=null){const i=w(this,Sd,gy).call(this,e);i.data=t,i.resolve()}clear(){var e;for(const t in c(this,fn)){const{data:i}=c(this,fn)[t];(e=i==null?void 0:i.bitmap)==null||e.close()}v(this,fn,Object.create(null))}*[Symbol.iterator](){for(const e in c(this,fn)){const{data:t}=c(this,fn)[e];t!==bu&&(yield[e,t])}}}fn=new WeakMap,Sd=new WeakSet,gy=function(e){var t;return(t=c(this,fn))[e]||(t[e]={...Promise.withResolvers(),data:bu})};var hr;class VL{constructor(e){S(this,hr,null);v(this,hr,e),this.onContinue=null}get promise(){return c(this,hr).capability.promise}cancel(e=0){c(this,hr).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=c(this,hr).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=c(this,hr);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}hr=new WeakMap;var fr,Fo;const jr=class jr{constructor({callback:e,params:t,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:p=!1,pageColors:g=null}){S(this,fr,null);this.callback=e,this.params=t,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=p,this.pageColors=g,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new VL(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var a,l;if(this.cancelled)return;if(this._canvas){if(c(jr,Fo).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");c(jr,Fo).add(this._canvas)}this._pdfBug&&((a=globalThis.StepperManager)!=null&&a.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:r,background:o}=this.params;this.gfx=new nl(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:s,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var i;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),c(this,fr)&&(window.cancelAnimationFrame(c(this,fr)),v(this,fr,null)),c(jr,Fo).delete(this._canvas),this.callback(e||new jv(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?v(this,fr,window.requestAnimationFrame(()=>{v(this,fr,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),c(jr,Fo).delete(this._canvas),this.callback())))}};fr=new WeakMap,Fo=new WeakMap,S(jr,Fo,new WeakSet);let my=jr;const OL="4.10.38",GL="f9bea397f";function fE(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Du(n){return Math.max(0,Math.min(255,255*n))}class pE{static CMYK_G([e,t,i,s]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Du(e),[e,e,e]}static G_HTML([e]){const t=fE(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(Du)}static RGB_HTML(e){return`#${e.map(fE).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,i+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,i,s]){return[Du(1-Math.min(1,e+s)),Du(1-Math.min(1,i+s)),Du(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const s=1-e,r=1-t,o=1-i,a=Math.min(s,r,o);return["CMYK",s,r,o,a]}}class BL{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Se("Abstract method `_createSVG` called.")}}class r0 extends BL{_createSVG(e){return document.createElementNS(Ki,e)}}class rT{static setupStorage(e,t,i,s,r){const o=s.getValue(t,{value:null});switch(i.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),r==="print")break;e.addEventListener("input",a=>{s.setValue(t,{value:a.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(o.value===i.attributes.xfaOn?e.setAttribute("checked",!0):o.value===i.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",a=>{s.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),r==="print")break;e.addEventListener("input",a=>{s.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of i.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const l=a.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:s,linkService:r}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${s}`);for(const[l,u]of Object.entries(o))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!a||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}a&&r.addLinkAttributes(e,o.href,o.newWindow),i&&o.dataId&&this.setupStorage(e,o.dataId,t,i)}static render(e){var p,g;const t=e.annotationStorage,i=e.linkService,s=e.xfaHtml,r=e.intent||"display",o=document.createElement(s.name);s.attributes&&this.setAttributes({html:o,element:s,intent:r,linkService:i});const a=r!=="richText",l=e.div;if(l.append(o),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=m}a&&l.setAttribute("class","xfaLayer xfaFont");const u=[];if(s.children.length===0){if(s.value){const m=document.createTextNode(s.value);o.append(m),a&&Nc.shouldBuildText(s.name)&&u.push(m)}return{textDivs:u}}const h=[[s,-1,o]];for(;h.length>0;){const[m,y,A]=h.at(-1);if(y+1===m.children.length){h.pop();continue}const T=m.children[++h.at(-1)[1]];if(T===null)continue;const{name:_}=T;if(_==="#text"){const C=document.createTextNode(T.value);u.push(C),A.append(C);continue}const E=(p=T==null?void 0:T.attributes)!=null&&p.xmlns?document.createElementNS(T.attributes.xmlns,_):document.createElement(_);if(A.append(E),T.attributes&&this.setAttributes({html:E,element:T,storage:t,intent:r,linkService:i}),((g=T.children)==null?void 0:g.length)>0)h.push([T,-1,E]);else if(T.value){const C=document.createTextNode(T.value);a&&Nc.shouldBuildText(_)&&u.push(C),E.append(C)}}for(const m of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const dh=1e3,zL=9,ya=new WeakSet;function Fr(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class qL{static create(e){switch(e.data.annotationType){case Ze.LINK:return new oT(e);case Ze.TEXT:return new $L(e);case Ze.WIDGET:switch(e.data.fieldType){case"Tx":return new WL(e);case"Btn":return e.data.radioButton?new uT(e):e.data.checkBox?new KL(e):new JL(e);case"Ch":return new XL(e);case"Sig":return new YL(e)}return new Sa(e);case Ze.POPUP:return new vy(e);case Ze.FREETEXT:return new pT(e);case Ze.LINE:return new ZL(e);case Ze.SQUARE:return new jL(e);case Ze.CIRCLE:return new eF(e);case Ze.POLYLINE:return new gT(e);case Ze.CARET:return new nF(e);case Ze.INK:return new o0(e);case Ze.POLYGON:return new tF(e);case Ze.HIGHLIGHT:return new mT(e);case Ze.UNDERLINE:return new iF(e);case Ze.SQUIGGLY:return new sF(e);case Ze.STRIKEOUT:return new rF(e);case Ze.STAMP:return new yT(e);case Ze.FILEATTACHMENT:return new oF(e);default:return new Ye(e)}}}var Uo,bl,Dl,wd,yy;const c0=class c0{constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){S(this,wd);S(this,Uo,null);S(this,bl,!1);S(this,Dl,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:i}){return!!(e!=null&&e.str||t!=null&&t.str||i!=null&&i.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return c0._hasPopupData(this.data)}updateEdited(e){var i;if(!this.container)return;c(this,Uo)||v(this,Uo,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&w(this,wd,yy).call(this,t),(i=c(this,Dl))==null||i.popup.updateEdited(e)}resetEdited(){var e;c(this,Uo)&&(w(this,wd,yy).call(this,c(this,Uo).rect),(e=c(this,Dl))==null||e.popup.resetEdited(),v(this,Uo,null))}_createContainer(e){const{data:t,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof Sa||(r.tabIndex=dh);const{style:o}=r;if(o.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof vy){const{rotation:A}=t;return!t.hasOwnCanvas&&A!==0&&this.setRotation(A,r),r}const{width:a,height:l}=Fr(t.rect);if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const A=t.borderStyle.horizontalCornerRadius,T=t.borderStyle.verticalCornerRadius;if(A>0||T>0){const E=`calc(${A}px * var(--scale-factor)) / calc(${T}px * var(--scale-factor))`;o.borderRadius=E}else if(this instanceof uT){const E=`calc(${a}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;o.borderRadius=E}switch(t.borderStyle.style){case ku.SOLID:o.borderStyle="solid";break;case ku.DASHED:o.borderStyle="dashed";break;case ku.BEVELED:te("Unimplemented border style: beveled");break;case ku.INSET:te("Unimplemented border style: inset");break;case ku.UNDERLINE:o.borderBottomStyle="solid";break}const _=t.borderColor||null;_?(v(this,bl,!0),o.borderColor=W.makeHexColor(_[0]|0,_[1]|0,_[2]|0)):o.borderWidth=0}const u=W.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:h,pageHeight:p,pageX:g,pageY:m}=s.rawDims;o.left=`${100*(u[0]-g)/h}%`,o.top=`${100*(u[1]-m)/p}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(o.width=`${100*a/h}%`,o.height=`${100*l/p}%`):this.setRotation(y,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims,{width:r,height:o}=Fr(this.data.rect);let a,l;e%180===0?(a=100*r/i,l=100*o/s):(a=100*o/i,l=100*r/s),t.style.width=`${a}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,s)=>{const r=s.detail[t],o=r[0],a=r.slice(1);s.target.style[i]=pE[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[i]:pE[`${o}_rgb`](a)})};return oe(this,"_commonActions",{display:t=>{const{display:i}=t.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const s of Object.keys(t.detail)){const r=e[s]||i[s];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[s,r]of Object.entries(t)){const o=i[s];if(o){const a={detail:{[s]:r},target:e};o(a),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,s,r]=this.data.rect.map(A=>Math.fround(A));if(e.length===8){const[A,T,_,E]=e.subarray(2,6);if(s===A&&r===T&&t===_&&i===E)return}const{style:o}=this.container;let a;if(c(this,bl)){const{borderColor:A,borderWidth:T}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${A}" stroke-width="${T}">`],this.container.classList.add("hasBorder")}const l=s-t,u=r-i,{svgFactory:h}=this,p=h.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0);const g=h.createElement("defs");p.append(g);const m=h.createElement("clipPath"),y=`clippath_${this.data.id}`;m.setAttribute("id",y),m.setAttribute("clipPathUnits","objectBoundingBox"),g.append(m);for(let A=2,T=e.length;A<T;A+=8){const _=e[A],E=e[A+1],C=e[A+2],I=e[A+3],x=h.createElement("rect"),R=(C-t)/l,P=(r-E)/u,M=(_-C)/l,k=(E-I)/u;x.setAttribute("x",R),x.setAttribute("y",P),x.setAttribute("width",M),x.setAttribute("height",k),m.append(x),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${R}" y="${P}" width="${M}" height="${k}"/>`)}c(this,bl)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(p),this.container.style.clipPath=`url(#${y})`}_createPopup(){const{data:e}=this,t=v(this,Dl,new vy({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){Se("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:r,id:o,exportValues:a}of s){if(r===-1||o===t)continue;const l=typeof a=="string"?a:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!ya.has(u)){te(`_getElementsByName - element not allowed: ${o}`);continue}i.push({id:o,exportValue:l,domElement:u})}return i}for(const s of document.getElementsByName(e)){const{exportValue:r}=s,o=s.getAttribute("data-element-id");o!==t&&ya.has(s)&&i.push({id:o,exportValue:r,domElement:s})}return i}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};Uo=new WeakMap,bl=new WeakMap,Dl=new WeakMap,wd=new WeakSet,yy=function(e){const{container:{style:t},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:l}}}}=this;i==null||i.splice(0,4,...e);const{width:u,height:h}=Fr(e);t.left=`${100*(e[0]-a)/r}%`,t.top=`${100*(o-e[3]+l)/o}%`,s===0?(t.width=`${100*u/r}%`,t.height=`${100*h/o}%`):this.setRotation(s)};let Ye=c0;var Cn,Jr,aT,lT;class oT extends Ye{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});S(this,Cn);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action),r=!0):t.attachment?(w(this,Cn,aT).call(this,s,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(w(this,Cn,lT).call(this,s,t.setOCGState),r=!0):t.dest?(this._bindLink(s,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(s),this.container}_bindLink(t,i){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&w(this,Cn,Jr).call(this)}_bindNamedAction(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),w(this,Cn,Jr).call(this)}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const o=s.get(r);o&&(t[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),w(this,Cn,Jr).call(this)}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),w(this,Cn,Jr).call(this),!this._fieldObjects){te('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var p;s==null||s();const{fields:r,refs:o,include:a}=i,l=[];if(r.length!==0||o.length!==0){const g=new Set(o);for(const m of r){const y=this._fieldObjects[m]||[];for(const{id:A}of y)g.add(A)}for(const m of Object.values(this._fieldObjects))for(const y of m)g.has(y.id)===a&&l.push(y)}else for(const g of Object.values(this._fieldObjects))l.push(...g);const u=this.annotationStorage,h=[];for(const g of l){const{id:m}=g;switch(h.push(m),g.type){case"text":{const A=g.defaultValue||"";u.setValue(m,{value:A});break}case"checkbox":case"radiobutton":{const A=g.defaultValue===g.exportValues;u.setValue(m,{value:A});break}case"combobox":case"listbox":{const A=g.defaultValue||"";u.setValue(m,{value:A});break}default:continue}const y=document.querySelector(`[data-element-id="${m}"]`);if(y){if(!ya.has(y)){te(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}Cn=new WeakSet,Jr=function(){this.container.setAttribute("data-internal-link","")},aT=function(t,i,s=null){t.href=this.linkService.getAnchorUrl(""),i.description&&(t.title=i.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(i.content,i.filename,s),!1},w(this,Cn,Jr).call(this)},lT=function(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),w(this,Cn,Jr).call(this)};class $L extends Ye{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Sa extends Ye{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return $t.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,s,r){i.includes("mouse")?e.addEventListener(i,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(i,o=>{var a;if(i==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}r&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(o)}}))})}_setEventListeners(e,t,i,s){var r,o,a;for(const[l,u]of i)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,u,s),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":W.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||zL,r=e.style;let o;const a=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a),h=Math.round(u/(Ig*s))||1,p=u/h;o=Math.min(s,l(p/Ig))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(s,l(u/Ig))}r.fontSize=`calc(${o}px * var(--scale-factor))`,r.color=W.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class WL extends Sa{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,s){const r=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=i),r.setValue(o.id,{[s]:i})}render(){var s,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let a=o.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let u=o.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=u??a,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",u??a),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),ya.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=dh,this._setRequired(i,this.data.required),l&&(i.maxLength=l),i.addEventListener("input",g=>{e.setValue(t,{value:g.target.value}),this.setPropertyOnSiblings(i,"value",g.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",g=>{const m=this.data.defaultFieldValue??"";i.value=h.userValue=m,h.formattedValue=null});let p=g=>{const{formattedValue:m}=h;m!=null&&(g.target.value=m),g.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",m=>{var A;if(h.focused)return;const{target:y}=m;h.userValue&&(y.value=h.userValue),h.lastCommittedValue=y.value,h.commitKey=1,(A=this.data.actions)!=null&&A.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",m=>{this.showElementAndHideCanvas(m.target);const y={value(A){h.userValue=A.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),A.target.value=h.userValue},formattedValue(A){const{formattedValue:T}=A.detail;h.formattedValue=T,T!=null&&A.target!==document.activeElement&&(A.target.value=T),e.setValue(t,{formattedValue:T})},selRange(A){A.target.setSelectionRange(...A.detail.selRange)},charLimit:A=>{var C;const{charLimit:T}=A.detail,{target:_}=A;if(T===0){_.removeAttribute("maxLength");return}_.setAttribute("maxLength",T);let E=h.userValue;!E||E.length<=T||(E=E.slice(0,T),_.value=h.userValue=E,e.setValue(t,{value:E}),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:1,selStart:_.selectionStart,selEnd:_.selectionEnd}}))}};this._dispatchEventFromSandbox(y,m)}),i.addEventListener("keydown",m=>{var T;h.commitKey=1;let y=-1;if(m.key==="Escape"?y=0:m.key==="Enter"&&!this.data.multiLine?y=2:m.key==="Tab"&&(h.commitKey=3),y===-1)return;const{value:A}=m.target;h.lastCommittedValue!==A&&(h.lastCommittedValue=A,h.userValue=A,(T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:y,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}}))});const g=p;p=null,i.addEventListener("blur",m=>{var A,T;if(!h.focused||!m.relatedTarget)return;(A=this.data.actions)!=null&&A.Blur||(h.focused=!1);const{value:y}=m.target;h.userValue=y,h.lastCommittedValue!==y&&((T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,willCommit:!0,commitKey:h.commitKey,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}})),g(m)}),(r=this.data.actions)!=null&&r.Keystroke&&i.addEventListener("beforeinput",m=>{var x;h.lastCommittedValue=null;const{data:y,target:A}=m,{value:T,selectionStart:_,selectionEnd:E}=A;let C=_,I=E;switch(m.inputType){case"deleteWordBackward":{const R=T.substring(0,_).match(/\w*[^\w]*$/);R&&(C-=R[0].length);break}case"deleteWordForward":{const R=T.substring(_).match(/^[^\w]*\w*/);R&&(I+=R[0].length);break}case"deleteContentBackward":_===E&&(C-=1);break;case"deleteContentForward":_===E&&(I+=1);break}m.preventDefault(),(x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,change:y||"",willCommit:!1,selStart:C,selEnd:I}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],m=>m.target.value)}if(p&&i.addEventListener("blur",p),this.data.comb){const m=(this.data.rect[2]-this.data.rect[0])/l;i.classList.add("comb"),i.style.letterSpacing=`calc(${m}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class YL extends Sa{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class KL extends Sa{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return ya.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=dh,r.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const u of this._getElementsByName(a,i)){const h=l&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}e.setValue(i,{value:l})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",o=>{const a={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class uT extends Sa{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(i,{value:s})),s)for(const o of this._getElementsByName(t.fieldName,i))e.setValue(o.id,{value:!1});const r=document.createElement("input");if(ya.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=dh,r.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const u of this._getElementsByName(a,i))e.setValue(u.id,{value:!1});e.setValue(i,{value:l})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;r.addEventListener("updatefromsandbox",a=>{const l={value:u=>{const h=o===u.detail.value;for(const p of this._getElementsByName(u.target.name)){const g=h&&p.id===i;p.domElement&&(p.domElement.checked=g),e.setValue(p.id,{value:g})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class JL extends oT{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class XL extends Sa{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");ya.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=dh;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",h=>{const p=this.data.defaultFieldValue;for(const g of s.options)g.selected=g.value===p});for(const h of this.data.options){const p=document.createElement("option");p.textContent=h.displayValue,p.value=h.exportValue,i.value.includes(h.exportValue)&&(p.setAttribute("selected",!0),r=!1),s.append(p)}let o=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),s.prepend(h),o=()=>{h.remove(),s.removeEventListener("input",o),o=null},s.addEventListener("input",o)}const a=h=>{const p=h?"value":"textContent",{options:g,multiple:m}=s;return m?Array.prototype.filter.call(g,y=>y.selected).map(y=>y[p]):g.selectedIndex===-1?null:g[g.selectedIndex][p]};let l=a(!1);const u=h=>{const p=h.target.options;return Array.prototype.map.call(p,g=>({displayValue:g.textContent,exportValue:g.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",h=>{const p={value(g){o==null||o();const m=g.detail.value,y=new Set(Array.isArray(m)?m:[m]);for(const A of s.options)A.selected=y.has(A.value);e.setValue(t,{value:a(!0)}),l=a(!1)},multipleSelection(g){s.multiple=!0},remove(g){const m=s.options,y=g.detail.remove;m[y].selected=!1,s.remove(y),m.length>0&&Array.prototype.findIndex.call(m,T=>T.selected)===-1&&(m[0].selected=!0),e.setValue(t,{value:a(!0),items:u(g)}),l=a(!1)},clear(g){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),l=a(!1)},insert(g){const{index:m,displayValue:y,exportValue:A}=g.detail.insert,T=s.children[m],_=document.createElement("option");_.textContent=y,_.value=A,T?T.before(_):s.append(_),e.setValue(t,{value:a(!0),items:u(g)}),l=a(!1)},items(g){const{items:m}=g.detail;for(;s.length!==0;)s.remove(0);for(const y of m){const{displayValue:A,exportValue:T}=y,_=document.createElement("option");_.textContent=A,_.value=T,s.append(_)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:a(!0),items:u(g)}),l=a(!1)},indices(g){const m=new Set(g.detail.indices);for(const y of g.target.options)y.selected=m.has(y.index);e.setValue(t,{value:a(!0)}),l=a(!1)},editable(g){g.target.disabled=!g.detail.editable}};this._dispatchEventFromSandbox(p,h)}),s.addEventListener("input",h=>{var m;const p=a(!0),g=a(!1);e.setValue(t,{value:p}),h.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:g,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):s.addEventListener("input",function(h){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class vy extends Ye{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:Ye._hasPopupData(t)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new QL({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const i of this.elements)i.popup=e,i.container.ariaHasPopup="dialog",t.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(i=>`${Zv}${i}`).join(",")),this.container}}var Ll,vp,_p,Fl,Ho,Be,gs,Ul,Cd,Td,Hl,ms,si,ys,Id,vs,xd,Vo,Oo,Ee,uf,_y,cT,dT,hT,fT,cf,df,Ay;class QL{constructor({container:e,color:t,elements:i,titleObj:s,modificationDate:r,contentsObj:o,richText:a,parent:l,rect:u,parentRect:h,open:p}){S(this,Ee);S(this,Ll,w(this,Ee,hT).bind(this));S(this,vp,w(this,Ee,Ay).bind(this));S(this,_p,w(this,Ee,df).bind(this));S(this,Fl,w(this,Ee,cf).bind(this));S(this,Ho,null);S(this,Be,null);S(this,gs,null);S(this,Ul,null);S(this,Cd,null);S(this,Td,null);S(this,Hl,null);S(this,ms,!1);S(this,si,null);S(this,ys,null);S(this,Id,null);S(this,vs,null);S(this,xd,null);S(this,Vo,null);S(this,Oo,!1);var g;v(this,Be,e),v(this,xd,s),v(this,gs,o),v(this,vs,a),v(this,Td,l),v(this,Ho,t),v(this,Id,u),v(this,Hl,h),v(this,Cd,i),v(this,Ul,t0.toDateObject(r)),this.trigger=i.flatMap(m=>m.getElementsToTriggerPopup());for(const m of this.trigger)m.addEventListener("click",c(this,Fl)),m.addEventListener("mouseenter",c(this,_p)),m.addEventListener("mouseleave",c(this,vp)),m.classList.add("popupTriggerArea");for(const m of i)(g=m.container)==null||g.addEventListener("keydown",c(this,Ll));c(this,Be).hidden=!0,p&&w(this,Ee,cf).call(this)}render(){if(c(this,si))return;const e=v(this,si,document.createElement("div"));if(e.className="popup",c(this,Ho)){const r=e.style.outlineColor=W.makeHexColor(...c(this,Ho));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:e.style.backgroundColor=W.makeHexColor(...c(this,Ho).map(a=>Math.floor(.7*(255-a)+a)))}const t=document.createElement("span");t.className="header";const i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=c(this,xd),e.append(t),c(this,Ul)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:c(this,Ul).valueOf()})),t.append(r)}const s=c(this,Ee,uf);if(s)rT.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(c(this,gs));e.append(r)}c(this,Be).append(e)}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const s=e.split(/(?:\r\n?|\n)/);for(let r=0,o=s.length;r<o;++r){const a=s[r];i.append(document.createTextNode(a)),r<o-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:e,popupContent:t}){var i;c(this,Vo)||v(this,Vo,{contentsObj:c(this,gs),richText:c(this,vs)}),e&&v(this,ys,null),t&&(v(this,vs,w(this,Ee,dT).call(this,t)),v(this,gs,null)),(i=c(this,si))==null||i.remove(),v(this,si,null)}resetEdited(){var e;c(this,Vo)&&({contentsObj:Ut(this,gs)._,richText:Ut(this,vs)._}=c(this,Vo),v(this,Vo,null),(e=c(this,si))==null||e.remove(),v(this,si,null),v(this,ys,null))}forceHide(){v(this,Oo,this.isVisible),c(this,Oo)&&(c(this,Be).hidden=!0)}maybeShow(){c(this,Oo)&&(c(this,si)||w(this,Ee,df).call(this),v(this,Oo,!1),c(this,Be).hidden=!1)}get isVisible(){return c(this,Be).hidden===!1}}Ll=new WeakMap,vp=new WeakMap,_p=new WeakMap,Fl=new WeakMap,Ho=new WeakMap,Be=new WeakMap,gs=new WeakMap,Ul=new WeakMap,Cd=new WeakMap,Td=new WeakMap,Hl=new WeakMap,ms=new WeakMap,si=new WeakMap,ys=new WeakMap,Id=new WeakMap,vs=new WeakMap,xd=new WeakMap,Vo=new WeakMap,Oo=new WeakMap,Ee=new WeakSet,uf=function(){const e=c(this,vs),t=c(this,gs);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&c(this,vs).html||null},_y=function(){var e,t,i;return((i=(t=(e=c(this,Ee,uf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.fontSize)||0},cT=function(){var e,t,i;return((i=(t=(e=c(this,Ee,uf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.color)||null},dT=function(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:c(this,Ee,cT),fontSize:c(this,Ee,_y)?`calc(${c(this,Ee,_y)}px * var(--scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:s});return i},hT=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&c(this,ms))&&w(this,Ee,cf).call(this)},fT=function(){if(c(this,ys)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:s,pageY:r}}}=c(this,Td);let o=!!c(this,Hl),a=o?c(this,Hl):c(this,Id);for(const y of c(this,Cd))if(!a||W.intersect(y.data.rect,a)!==null){a=y.data.rect,o=!0;break}const l=W.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),h=o?a[2]-a[0]+5:0,p=l[0]+h,g=l[1];v(this,ys,[100*(p-s)/t,100*(g-r)/i]);const{style:m}=c(this,Be);m.left=`${c(this,ys)[0]}%`,m.top=`${c(this,ys)[1]}%`},cf=function(){v(this,ms,!c(this,ms)),c(this,ms)?(w(this,Ee,df).call(this),c(this,Be).addEventListener("click",c(this,Fl)),c(this,Be).addEventListener("keydown",c(this,Ll))):(w(this,Ee,Ay).call(this),c(this,Be).removeEventListener("click",c(this,Fl)),c(this,Be).removeEventListener("keydown",c(this,Ll)))},df=function(){c(this,si)||this.render(),this.isVisible?c(this,ms)&&c(this,Be).classList.add("focused"):(w(this,Ee,fT).call(this),c(this,Be).hidden=!1,c(this,Be).style.zIndex=parseInt(c(this,Be).style.zIndex)+1e3)},Ay=function(){c(this,Be).classList.remove("focused"),!(c(this,ms)||!this.isVisible)&&(c(this,Be).hidden=!0,c(this,Be).style.zIndex=parseInt(c(this,Be).style.zIndex)-1e3)};class pT extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ee.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Pd;class ZL extends Ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Pd,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:i,height:s}=Fr(t.rect),r=this.svgFactory.create(i,s,!0),o=v(this,Pd,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Pd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Pd=new WeakMap;var Rd;class jL extends Ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Rd,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:i,height:s}=Fr(t.rect),r=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,a=v(this,Rd,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",i-o),a.setAttribute("height",s-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Rd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Rd=new WeakMap;var Md;class eF extends Ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Md,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:i,height:s}=Fr(t.rect),r=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,a=v(this,Md,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",i/2),a.setAttribute("cy",s/2),a.setAttribute("rx",i/2-o/2),a.setAttribute("ry",s/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Md)}addHighlightArea(){this.container.classList.add("highlightArea")}}Md=new WeakMap;var kd;class gT extends Ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,kd,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r}}=this;if(!i)return this.container;const{width:o,height:a}=Fr(t),l=this.svgFactory.create(o,a,!0);let u=[];for(let p=0,g=i.length;p<g;p+=2){const m=i[p]-t[0],y=t[3]-i[p+1];u.push(`${m},${y}`)}u=u.join(" ");const h=v(this,kd,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,kd)}addHighlightArea(){this.container.classList.add("highlightArea")}}kd=new WeakMap;class tF extends gT{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class nF extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Nd,Go,bd,Ey;class o0 extends Ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,bd);S(this,Nd,null);S(this,Go,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ee.HIGHLIGHT:ee.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:r,popupRef:o}}=this,{transform:a,width:l,height:u}=w(this,bd,Ey).call(this,i,t),h=this.svgFactory.create(l,u,!0),p=v(this,Nd,this.svgFactory.createElement("svg:g"));h.append(p),p.setAttribute("stroke-width",r.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",a);for(let g=0,m=s.length;g<m;g++){const y=this.svgFactory.createElement(this.svgElementName);c(this,Go).push(y),y.setAttribute("points",s[g].join(",")),p.append(y)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:r}=t,o=c(this,Nd);if(i>=0&&o.setAttribute("stroke-width",i||1),s)for(let a=0,l=c(this,Go).length;a<l;a++)c(this,Go)[a].setAttribute("points",s[a].join(","));if(r){const{transform:a,width:l,height:u}=w(this,bd,Ey).call(this,this.data.rotation,r);o.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return c(this,Go)}addHighlightArea(){this.container.classList.add("highlightArea")}}Nd=new WeakMap,Go=new WeakMap,bd=new WeakSet,Ey=function(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class mT extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ee.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class iF extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class sF extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class rF extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class yT extends Ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ee.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Dd,Ld,Sy;class oF extends Ye{constructor(t){var s;super(t,{isRenderable:!0});S(this,Ld);S(this,Dd,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",w(this,Ld,Sy).bind(this)),v(this,Dd,s);const{isMac:r}=$t.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&w(this,Ld,Sy).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return c(this,Dd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Dd=new WeakMap,Ld=new WeakSet,Sy=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Fd,Bo,zo,Ud,va,vT,wy;class aF{constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:o,structTreeLayer:a}){S(this,va);S(this,Fd,null);S(this,Bo,null);S(this,zo,new Map);S(this,Ud,null);this.div=e,v(this,Fd,t),v(this,Bo,i),v(this,Ud,a||null),this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return c(this,zo).size>0}async render(e){var o;const{annotations:t}=e,i=this.div;ga(i,this.viewport);const s=new Map,r={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new r0,annotationStorage:e.annotationStorage||new i0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const l=a.annotationType===Ze.POPUP;if(l){const p=s.get(a.id);if(!p)continue;r.elements=p}else{const{width:p,height:g}=Fr(a.rect);if(p<=0||g<=0)continue}r.data=a;const u=qL.create(r);if(!u.isRenderable)continue;if(!l&&a.popupRef){const p=s.get(a.popupRef);p?p.push(u):s.set(a.popupRef,[u])}const h=u.render();a.hidden&&(h.style.visibility="hidden"),await w(this,va,vT).call(this,h,a.id),u._isEditable&&(c(this,zo).set(u.data.id,u),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(u))}w(this,va,wy).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,ga(t,{rotation:e.rotation}),w(this,va,wy).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(c(this,zo).values())}getEditableAnnotation(e){return c(this,zo).get(e)}}Fd=new WeakMap,Bo=new WeakMap,zo=new WeakMap,Ud=new WeakMap,va=new WeakSet,vT=async function(e,t){var o,a;const i=e.firstChild||e,s=i.id=`${Zv}${t}`,r=await((o=c(this,Ud))==null?void 0:o.getAriaAttributes(s));if(r)for(const[l,u]of r)i.setAttribute(l,u);this.div.append(e),(a=c(this,Fd))==null||a.moveElementInDOM(this.div,e,i,!1)},wy=function(){if(!c(this,Bo))return;const e=this.div;for(const[t,i]of c(this,Bo)){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:r}=s;r?r.nodeName==="CANVAS"?r.replaceWith(i):r.classList.contains("annotationContent")?r.after(i):r.before(i):s.append(i)}c(this,Bo).clear()};const Nh=/\r\n?|\n/g;var ri,pn,Hd,qo,gn,Qe,_T,AT,ET,hf,ks,ff,pf,ST,Ty,wT;const we=class we extends He{constructor(t){super({...t,name:"freeTextEditor"});S(this,Qe);S(this,ri);S(this,pn,"");S(this,Hd,`${this.id}-editor`);S(this,qo,null);S(this,gn);v(this,ri,t.color||we._defaultColor||He._defaultLineColor),v(this,gn,t.fontSize||we._defaultFontSize)}static get _keyboardManager(){const t=we.prototype,i=o=>o.isEmpty(),s=ma.TRANSLATE_SMALL,r=ma.TRANSLATE_BIG;return oe(this,"_keyboardManager",new ch([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static initialize(t,i){He.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case ue.FREETEXT_SIZE:we._defaultFontSize=i;break;case ue.FREETEXT_COLOR:we._defaultColor=i;break}}updateParams(t,i){switch(t){case ue.FREETEXT_SIZE:w(this,Qe,_T).call(this,i);break;case ue.FREETEXT_COLOR:w(this,Qe,AT).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[ue.FREETEXT_SIZE,we._defaultFontSize],[ue.FREETEXT_COLOR,we._defaultColor||He._defaultLineColor]]}get propertiesToUpdate(){return[[ue.FREETEXT_SIZE,c(this,gn)],[ue.FREETEXT_COLOR,c(this,ri)]]}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-we._internalPadding*t,-(we._internalPadding+c(this,gn))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(ee.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),v(this,qo,new AbortController);const t=this._uiManager.combinedSignal(c(this,qo));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",c(this,Hd)),this._isDraggable=!0,(t=c(this,qo))==null||t.abort(),v(this,qo,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var i;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=c(this,pn),i=v(this,pn,w(this,Qe,ET).call(this).trimEnd());if(t===i)return;const s=r=>{if(v(this,pn,r),!r){this.remove();return}w(this,Qe,pf).call(this),this._uiManager.rebuild(this),w(this,Qe,hf).call(this)};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),w(this,Qe,hf).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){we._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,i;this.width&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",c(this,Hd)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${c(this,gn)}px * var(--scale-factor))`,s.color=c(this,ri),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),jf(this,this.div,["dblclick","keydown"]),this.width){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[h,p]=this.pageDimensions,[g,m]=this.pageTranslation;let y,A;switch(this.rotation){case 0:y=t+(a[0]-g)/h,A=i+this.height-(a[1]-m)/p;break;case 90:y=t+(a[0]-g)/h,A=i-(a[1]-m)/p,[l,u]=[u,-l];break;case 180:y=t-this.width+(a[0]-g)/h,A=i-(a[1]-m)/p,[l,u]=[-l,-u];break;case 270:y=t+(a[0]-g-this.height*p)/h,A=i+(a[1]-m-this.width*h)/p,[l,u]=[-u,l];break}this.setAt(y*r,A*o,l,u)}else this.setAt(t*r,i*o,this.width*r,this.height*o);w(this,Qe,pf).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var y,A,T;const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=w(y=we,ks,Ty).call(y,i.getData("text")||"").replaceAll(Nh,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!r.includes(`
`)){a.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:l,startOffset:u}=a,h=[],p=[];if(l.nodeType===Node.TEXT_NODE){const _=l.parentElement;if(p.push(l.nodeValue.slice(u).replaceAll(Nh,"")),_!==this.editorDiv){let E=h;for(const C of this.editorDiv.childNodes){if(C===_){E=p;continue}E.push(w(A=we,ks,ff).call(A,C))}}h.push(l.nodeValue.slice(0,u).replaceAll(Nh,""))}else if(l===this.editorDiv){let _=h,E=0;for(const C of this.editorDiv.childNodes)E++===u&&(_=p),_.push(w(T=we,ks,ff).call(T,C))}v(this,pn,`${h.join(`
`)}${r}${p.join(`
`)}`),w(this,Qe,pf).call(this);const g=new Range;let m=h.reduce((_,E)=>_+E.length,0);for(const{firstChild:_}of this.editorDiv.childNodes)if(_.nodeType===Node.TEXT_NODE){const E=_.nodeValue.length;if(m<=E){g.setStart(_,m),g.setEnd(_,m);break}m-=E}o.removeAllRanges(),o.addRange(g)}get contentDiv(){return this.editorDiv}static async deserialize(t,i,s){var a;let r=null;if(t instanceof pT){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:h,rotation:p,id:g,popupRef:m},textContent:y,textPosition:A,parent:{page:{pageNumber:T}}}=t;if(!y||y.length===0)return null;r=t={annotationType:ee.FREETEXT,color:Array.from(u),fontSize:l,value:y.join(`
`),position:A,pageIndex:T-1,rect:h.slice(0),rotation:p,id:g,deleted:!1,popupRef:m}}const o=await super.deserialize(t,i,s);return v(o,gn,t.fontSize),v(o,ri,W.makeHexColor(...t.color)),v(o,pn,w(a=we,ks,Ty).call(a,t.value)),o.annotationElementId=t.id||null,o._initialData=r,o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=we._internalPadding*this.parentScale,s=this.getRect(i,i),r=He._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:c(this,ri)),o={annotationType:ee.FREETEXT,color:r,fontSize:c(this,gn),value:w(this,Qe,ST).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?o:this.annotationElementId&&!w(this,Qe,wT).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(this.deleted)return i;const{style:s}=i;s.fontSize=`calc(${c(this,gn)}px * var(--scale-factor))`,s.color=c(this,ri),i.replaceChildren();for(const o of c(this,pn).split(`
`)){const a=document.createElement("div");a.append(o?document.createTextNode(o):document.createElement("br")),i.append(a)}const r=we._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:c(this,pn)}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};ri=new WeakMap,pn=new WeakMap,Hd=new WeakMap,qo=new WeakMap,gn=new WeakMap,Qe=new WeakSet,_T=function(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-c(this,gn))*this.parentScale),v(this,gn,r),w(this,Qe,hf).call(this)},s=c(this,gn);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ue.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},AT=function(t){const i=r=>{v(this,ri,this.editorDiv.style.color=r)},s=c(this,ri);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ue.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},ET=function(){var s;const t=[];this.editorDiv.normalize();let i=null;for(const r of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(w(s=we,ks,ff).call(s,r)),i=r);return t.join(`
`)},hf=function(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,a=o.style.display,l=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),s=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()},ks=new WeakSet,ff=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Nh,"")},pf=function(){if(this.editorDiv.replaceChildren(),!!c(this,pn))for(const t of c(this,pn).split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}},ST=function(){return c(this,pn).replaceAll(""," ")},Ty=function(t){return t.replaceAll(" ","")},wT=function(t){const{value:i,fontSize:s,color:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((a,l)=>a!==r[l])||t.pageIndex!==o},S(we,ks),J(we,"_freeTextDefaultContent",""),J(we,"_internalPadding",0),J(we,"_defaultColor",null),J(we,"_defaultFontSize",10),J(we,"_type","freetext"),J(we,"_editorType",ee.FREETEXT);let Cy=we;class G{toSVGPath(){Se("Abstract method `toSVGPath` must be implemented.")}get box(){Se("Abstract getter `box` must be implemented.")}serialize(e,t){Se("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,s,r,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a]*s,o[a+1]=i+e[a+1]*r;return o}static _rescaleAndSwap(e,t,i,s,r,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a+1]*s,o[a+1]=i+e[a]*r;return o}static _translate(e,t,i,s){s||(s=new Float32Array(e.length));for(let r=0,o=e.length;r<o;r+=2)s[r]=t+e[r],s[r+1]=i+e[r+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,s,r){switch(r){case 90:return[1-t/i,e/s];case 180:return[1-e/i,1-t/s];case 270:return[t/i,1-e/s];default:return[e/i,t/s]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,s,r,o){return[(e+5*i)/6,(t+5*s)/6,(5*i+r)/6,(5*s+o)/6,(i+r)/2,(s+o)/2]}}J(G,"PRECISION",1e-4);var mn,oi,Vl,Ol,Fi,re,$o,Wo,Vd,Od,Gl,Bl,pr,Gd,Ap,Ep,rt,Ju,CT,TT,IT,xT,PT,RT;const ji=class ji{constructor({x:e,y:t},i,s,r,o,a=0){S(this,rt);S(this,mn);S(this,oi,[]);S(this,Vl);S(this,Ol);S(this,Fi,[]);S(this,re,new Float32Array(18));S(this,$o);S(this,Wo);S(this,Vd);S(this,Od);S(this,Gl);S(this,Bl);S(this,pr,[]);v(this,mn,i),v(this,Bl,r*s),v(this,Ol,o),c(this,re).set([NaN,NaN,NaN,NaN,e,t],6),v(this,Vl,a),v(this,Od,c(ji,Gd)*s),v(this,Vd,c(ji,Ep)*s),v(this,Gl,s),c(this,pr).push(e,t)}isEmpty(){return isNaN(c(this,re)[8])}add({x:e,y:t}){var k;v(this,$o,e),v(this,Wo,t);const[i,s,r,o]=c(this,mn);let[a,l,u,h]=c(this,re).subarray(8,12);const p=e-u,g=t-h,m=Math.hypot(p,g);if(m<c(this,Vd))return!1;const y=m-c(this,Od),A=y/m,T=A*p,_=A*g;let E=a,C=l;a=u,l=h,u+=T,h+=_,(k=c(this,pr))==null||k.push(e,t);const I=-_/y,x=T/y,R=I*c(this,Bl),P=x*c(this,Bl);return c(this,re).set(c(this,re).subarray(2,8),0),c(this,re).set([u+R,h+P],4),c(this,re).set(c(this,re).subarray(14,18),12),c(this,re).set([u-R,h-P],16),isNaN(c(this,re)[6])?(c(this,Fi).length===0&&(c(this,re).set([a+R,l+P],2),c(this,Fi).push(NaN,NaN,NaN,NaN,(a+R-i)/r,(l+P-s)/o),c(this,re).set([a-R,l-P],14),c(this,oi).push(NaN,NaN,NaN,NaN,(a-R-i)/r,(l-P-s)/o)),c(this,re).set([E,C,a,l,u,h],6),!this.isEmpty()):(c(this,re).set([E,C,a,l,u,h],6),Math.abs(Math.atan2(C-l,E-a)-Math.atan2(_,T))<Math.PI/2?([a,l,u,h]=c(this,re).subarray(2,6),c(this,Fi).push(NaN,NaN,NaN,NaN,((a+u)/2-i)/r,((l+h)/2-s)/o),[a,l,E,C]=c(this,re).subarray(14,18),c(this,oi).push(NaN,NaN,NaN,NaN,((E+a)/2-i)/r,((C+l)/2-s)/o),!0):([E,C,a,l,u,h]=c(this,re).subarray(0,6),c(this,Fi).push(((E+5*a)/6-i)/r,((C+5*l)/6-s)/o,((5*a+u)/6-i)/r,((5*l+h)/6-s)/o,((a+u)/2-i)/r,((l+h)/2-s)/o),[u,h,a,l,E,C]=c(this,re).subarray(12,18),c(this,oi).push(((E+5*a)/6-i)/r,((C+5*l)/6-s)/o,((5*a+u)/6-i)/r,((5*l+h)/6-s)/o,((a+u)/2-i)/r,((l+h)/2-s)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=c(this,Fi),t=c(this,oi);if(isNaN(c(this,re)[6])&&!this.isEmpty())return w(this,rt,CT).call(this);const i=[];i.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);w(this,rt,IT).call(this,i);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return w(this,rt,TT).call(this,i),i.join(" ")}newFreeDrawOutline(e,t,i,s,r,o){return new MT(e,t,i,s,r,o)}getOutlines(){var p;const e=c(this,Fi),t=c(this,oi),i=c(this,re),[s,r,o,a]=c(this,mn),l=new Float32Array((((p=c(this,pr))==null?void 0:p.length)??0)+2);for(let g=0,m=l.length-2;g<m;g+=2)l[g]=(c(this,pr)[g]-s)/o,l[g+1]=(c(this,pr)[g+1]-r)/a;if(l[l.length-2]=(c(this,$o)-s)/o,l[l.length-1]=(c(this,Wo)-r)/a,isNaN(i[6])&&!this.isEmpty())return w(this,rt,xT).call(this,l);const u=new Float32Array(c(this,Fi).length+24+c(this,oi).length);let h=e.length;for(let g=0;g<h;g+=2){if(isNaN(e[g])){u[g]=u[g+1]=NaN;continue}u[g]=e[g],u[g+1]=e[g+1]}h=w(this,rt,RT).call(this,u,h);for(let g=t.length-6;g>=6;g-=6)for(let m=0;m<6;m+=2){if(isNaN(t[g+m])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=t[g+m],u[h+1]=t[g+m+1],h+=2}return w(this,rt,PT).call(this,u,h),this.newFreeDrawOutline(u,l,c(this,mn),c(this,Gl),c(this,Vl),c(this,Ol))}};mn=new WeakMap,oi=new WeakMap,Vl=new WeakMap,Ol=new WeakMap,Fi=new WeakMap,re=new WeakMap,$o=new WeakMap,Wo=new WeakMap,Vd=new WeakMap,Od=new WeakMap,Gl=new WeakMap,Bl=new WeakMap,pr=new WeakMap,Gd=new WeakMap,Ap=new WeakMap,Ep=new WeakMap,rt=new WeakSet,Ju=function(){const e=c(this,re).subarray(4,6),t=c(this,re).subarray(16,18),[i,s,r,o]=c(this,mn);return[(c(this,$o)+(e[0]-t[0])/2-i)/r,(c(this,Wo)+(e[1]-t[1])/2-s)/o,(c(this,$o)+(t[0]-e[0])/2-i)/r,(c(this,Wo)+(t[1]-e[1])/2-s)/o]},CT=function(){const[e,t,i,s]=c(this,mn),[r,o,a,l]=w(this,rt,Ju).call(this);return`M${(c(this,re)[2]-e)/i} ${(c(this,re)[3]-t)/s} L${(c(this,re)[4]-e)/i} ${(c(this,re)[5]-t)/s} L${r} ${o} L${a} ${l} L${(c(this,re)[16]-e)/i} ${(c(this,re)[17]-t)/s} L${(c(this,re)[14]-e)/i} ${(c(this,re)[15]-t)/s} Z`},TT=function(e){const t=c(this,oi);e.push(`L${t[4]} ${t[5]} Z`)},IT=function(e){const[t,i,s,r]=c(this,mn),o=c(this,re).subarray(4,6),a=c(this,re).subarray(16,18),[l,u,h,p]=w(this,rt,Ju).call(this);e.push(`L${(o[0]-t)/s} ${(o[1]-i)/r} L${l} ${u} L${h} ${p} L${(a[0]-t)/s} ${(a[1]-i)/r}`)},xT=function(e){const t=c(this,re),[i,s,r,o]=c(this,mn),[a,l,u,h]=w(this,rt,Ju).call(this),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(t[2]-i)/r,(t[3]-s)/o,NaN,NaN,NaN,NaN,(t[4]-i)/r,(t[5]-s)/o,NaN,NaN,NaN,NaN,a,l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(t[16]-i)/r,(t[17]-s)/o,NaN,NaN,NaN,NaN,(t[14]-i)/r,(t[15]-s)/o],0),this.newFreeDrawOutline(p,e,c(this,mn),c(this,Gl),c(this,Vl),c(this,Ol))},PT=function(e,t){const i=c(this,oi);return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6},RT=function(e,t){const i=c(this,re).subarray(4,6),s=c(this,re).subarray(16,18),[r,o,a,l]=c(this,mn),[u,h,p,g]=w(this,rt,Ju).call(this);return e.set([NaN,NaN,NaN,NaN,(i[0]-r)/a,(i[1]-o)/l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,p,g,NaN,NaN,NaN,NaN,(s[0]-r)/a,(s[1]-o)/l],t),t+=24},S(ji,Gd,8),S(ji,Ap,2),S(ji,Ep,c(ji,Gd)+c(ji,Ap));let np=ji;var zl,Yo,_s,Bd,yn,zd,$e,Sp,kT;class MT extends G{constructor(t,i,s,r,o,a){super();S(this,Sp);S(this,zl);S(this,Yo,new Float32Array(4));S(this,_s);S(this,Bd);S(this,yn);S(this,zd);S(this,$e);v(this,$e,t),v(this,yn,i),v(this,zl,s),v(this,zd,r),v(this,_s,o),v(this,Bd,a),this.lastPoint=[NaN,NaN],w(this,Sp,kT).call(this,a);const[l,u,h,p]=c(this,Yo);for(let g=0,m=t.length;g<m;g+=2)t[g]=(t[g]-l)/h,t[g+1]=(t[g+1]-u)/p;for(let g=0,m=i.length;g<m;g+=2)i[g]=(i[g]-l)/h,i[g+1]=(i[g+1]-u)/p}toSVGPath(){const t=[`M${c(this,$e)[4]} ${c(this,$e)[5]}`];for(let i=6,s=c(this,$e).length;i<s;i+=6){if(isNaN(c(this,$e)[i])){t.push(`L${c(this,$e)[i+4]} ${c(this,$e)[i+5]}`);continue}t.push(`C${c(this,$e)[i]} ${c(this,$e)[i+1]} ${c(this,$e)[i+2]} ${c(this,$e)[i+3]} ${c(this,$e)[i+4]} ${c(this,$e)[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],o){const a=s-t,l=r-i;let u,h;switch(o){case 0:u=G._rescale(c(this,$e),t,r,a,-l),h=G._rescale(c(this,yn),t,r,a,-l);break;case 90:u=G._rescaleAndSwap(c(this,$e),t,i,a,l),h=G._rescaleAndSwap(c(this,yn),t,i,a,l);break;case 180:u=G._rescale(c(this,$e),s,i,-a,l),h=G._rescale(c(this,yn),s,i,-a,l);break;case 270:u=G._rescaleAndSwap(c(this,$e),s,r,-a,-l),h=G._rescaleAndSwap(c(this,yn),s,r,-a,-l);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return c(this,Yo)}newOutliner(t,i,s,r,o,a=0){return new np(t,i,s,r,o,a)}getNewOutline(t,i){const[s,r,o,a]=c(this,Yo),[l,u,h,p]=c(this,zl),g=o*h,m=a*p,y=s*h+l,A=r*p+u,T=this.newOutliner({x:c(this,yn)[0]*g+y,y:c(this,yn)[1]*m+A},c(this,zl),c(this,zd),t,c(this,Bd),i??c(this,_s));for(let _=2;_<c(this,yn).length;_+=2)T.add({x:c(this,yn)[_]*g+y,y:c(this,yn)[_+1]*m+A});return T.getOutlines()}}zl=new WeakMap,Yo=new WeakMap,_s=new WeakMap,Bd=new WeakMap,yn=new WeakMap,zd=new WeakMap,$e=new WeakMap,Sp=new WeakSet,kT=function(t){const i=c(this,$e);let s=i[4],r=i[5],o=s,a=r,l=s,u=r,h=s,p=r;const g=t?Math.max:Math.min;for(let y=6,A=i.length;y<A;y+=6){if(isNaN(i[y]))o=Math.min(o,i[y+4]),a=Math.min(a,i[y+5]),l=Math.max(l,i[y+4]),u=Math.max(u,i[y+5]),p<i[y+5]?(h=i[y+4],p=i[y+5]):p===i[y+5]&&(h=g(h,i[y+4]));else{const T=W.bezierBoundingBox(s,r,...i.slice(y,y+6));o=Math.min(o,T[0]),a=Math.min(a,T[1]),l=Math.max(l,T[2]),u=Math.max(u,T[3]),p<T[3]?(h=T[2],p=T[3]):p===T[3]&&(h=g(h,T[2]))}s=i[y+4],r=i[y+5]}const m=c(this,Yo);m[0]=o-c(this,_s),m[1]=a-c(this,_s),m[2]=l-o+2*c(this,_s),m[3]=u-a+2*c(this,_s),this.lastPoint=[h,p]};var qd,$d,gr,ai,Yt,NT,gf,bT,DT,xy;class Iy{constructor(e,t=0,i=0,s=!0){S(this,Yt);S(this,qd);S(this,$d);S(this,gr,[]);S(this,ai,[]);let r=1/0,o=-1/0,a=1/0,l=-1/0;const u=10**-4;for(const{x:T,y:_,width:E,height:C}of e){const I=Math.floor((T-t)/u)*u,x=Math.ceil((T+E+t)/u)*u,R=Math.floor((_-t)/u)*u,P=Math.ceil((_+C+t)/u)*u,M=[I,R,P,!0],k=[x,R,P,!1];c(this,gr).push(M,k),r=Math.min(r,I),o=Math.max(o,x),a=Math.min(a,R),l=Math.max(l,P)}const h=o-r+2*i,p=l-a+2*i,g=r-i,m=a-i,y=c(this,gr).at(s?-1:-2),A=[y[0],y[2]];for(const T of c(this,gr)){const[_,E,C]=T;T[0]=(_-g)/h,T[1]=(E-m)/p,T[2]=(C-m)/p}v(this,qd,new Float32Array([g,m,h,p])),v(this,$d,A)}getOutlines(){c(this,gr).sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of c(this,gr))t[3]?(e.push(...w(this,Yt,xy).call(this,t)),w(this,Yt,bT).call(this,t)):(w(this,Yt,DT).call(this,t),e.push(...w(this,Yt,xy).call(this,t)));return w(this,Yt,NT).call(this,e)}}qd=new WeakMap,$d=new WeakMap,gr=new WeakMap,ai=new WeakMap,Yt=new WeakSet,NT=function(e){const t=[],i=new Set;for(const o of e){const[a,l,u]=o;t.push([a,l,o],[a,u,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const l=t[o][2],u=t[o+1][2];l.push(u),u.push(l),i.add(l),i.add(u)}const s=[];let r;for(;i.size>0;){const o=i.values().next().value;let[a,l,u,h,p]=o;i.delete(o);let g=a,m=l;for(r=[a,u],s.push(r);;){let y;if(i.has(h))y=h;else if(i.has(p))y=p;else break;i.delete(y),[a,l,u,h,p]=y,g!==a&&(r.push(g,m,a,m===l?l:u),g=a),m=m===l?u:l}r.push(g,m)}return new lF(s,c(this,qd),c(this,$d))},gf=function(e){const t=c(this,ai);let i=0,s=t.length-1;for(;i<=s;){const r=i+s>>1,o=t[r][0];if(o===e)return r;o<e?i=r+1:s=r-1}return s+1},bT=function([,e,t]){const i=w(this,Yt,gf).call(this,e);c(this,ai).splice(i,0,[e,t])},DT=function([,e,t]){const i=w(this,Yt,gf).call(this,e);for(let s=i;s<c(this,ai).length;s++){const[r,o]=c(this,ai)[s];if(r!==e)break;if(r===e&&o===t){c(this,ai).splice(s,1);return}}for(let s=i-1;s>=0;s--){const[r,o]=c(this,ai)[s];if(r!==e)break;if(r===e&&o===t){c(this,ai).splice(s,1);return}}},xy=function(e){const[t,i,s]=e,r=[[t,i,s]],o=w(this,Yt,gf).call(this,s);for(let a=0;a<o;a++){const[l,u]=c(this,ai)[a];for(let h=0,p=r.length;h<p;h++){const[,g,m]=r[h];if(!(u<=g||m<=l)){if(g>=l){if(m>u)r[h][1]=u;else{if(p===1)return[];r.splice(h,1),h--,p--}continue}r[h][2]=l,m>u&&r.push([t,u,m])}}}return r};var Wd,ql;class lF extends G{constructor(t,i,s){super();S(this,Wd);S(this,ql);v(this,ql,t),v(this,Wd,i),this.lastPoint=s}toSVGPath(){const t=[];for(const i of c(this,ql)){let[s,r]=i;t.push(`M${s} ${r}`);for(let o=2;o<i.length;o+=2){const a=i[o],l=i[o+1];a===s?(t.push(`V${l}`),r=l):l===r&&(t.push(`H${a}`),s=a)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],o){const a=[],l=s-t,u=r-i;for(const h of c(this,ql)){const p=new Array(h.length);for(let g=0;g<h.length;g+=2)p[g]=t+h[g]*l,p[g+1]=r-h[g+1]*u;a.push(p)}return a}get box(){return c(this,Wd)}get classNamesForOutlining(){return["highlightOutline"]}}Wd=new WeakMap,ql=new WeakMap;class Py extends np{newFreeDrawOutline(e,t,i,s,r,o){return new uF(e,t,i,s,r,o)}}class uF extends MT{newOutliner(e,t,i,s,r,o=0){return new Py(e,t,i,s,r,o)}}var li,Ko,$l,tt,Yd,Wl,Kd,Jd,mr,ui,Yl,Xd,Ae,Ry,My,ky,Xr,LT,zs;const jt=class jt{constructor({editor:e=null,uiManager:t=null}){S(this,Ae);S(this,li,null);S(this,Ko,null);S(this,$l);S(this,tt,null);S(this,Yd,!1);S(this,Wl,!1);S(this,Kd,null);S(this,Jd);S(this,mr,null);S(this,ui,null);S(this,Yl);var i;e?(v(this,Wl,!1),v(this,Yl,ue.HIGHLIGHT_COLOR),v(this,Kd,e)):(v(this,Wl,!0),v(this,Yl,ue.HIGHLIGHT_DEFAULT_COLOR)),v(this,ui,(e==null?void 0:e._uiManager)||t),v(this,Jd,c(this,ui)._eventBus),v(this,$l,(e==null?void 0:e.color)||((i=c(this,ui))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),c(jt,Xd)||v(jt,Xd,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return oe(this,"_keyboardManager",new ch([[["Escape","mac+Escape"],jt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],jt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],jt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],jt.prototype._moveToPrevious],[["Home","mac+Home"],jt.prototype._moveToBeginning],[["End","mac+End"],jt.prototype._moveToEnd]]))}renderButton(){const e=v(this,li,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=c(this,ui)._signal;e.addEventListener("click",w(this,Ae,Xr).bind(this),{signal:t}),e.addEventListener("keydown",w(this,Ae,ky).bind(this),{signal:t});const i=v(this,Ko,document.createElement("span"));return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=c(this,$l),e.append(i),e}renderMainDropdown(){const e=v(this,tt,w(this,Ae,Ry).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===c(this,li)){w(this,Ae,Xr).call(this,e);return}const t=e.target.getAttribute("data-color");t&&w(this,Ae,My).call(this,t,e)}_moveToNext(e){var t,i;if(!c(this,Ae,zs)){w(this,Ae,Xr).call(this,e);return}if(e.target===c(this,li)){(t=c(this,tt).firstChild)==null||t.focus();return}(i=e.target.nextSibling)==null||i.focus()}_moveToPrevious(e){var t,i;if(e.target===((t=c(this,tt))==null?void 0:t.firstChild)||e.target===c(this,li)){c(this,Ae,zs)&&this._hideDropdownFromKeyboard();return}c(this,Ae,zs)||w(this,Ae,Xr).call(this,e),(i=e.target.previousSibling)==null||i.focus()}_moveToBeginning(e){var t;if(!c(this,Ae,zs)){w(this,Ae,Xr).call(this,e);return}(t=c(this,tt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!c(this,Ae,zs)){w(this,Ae,Xr).call(this,e);return}(t=c(this,tt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=c(this,tt))==null||e.classList.add("hidden"),(t=c(this,mr))==null||t.abort(),v(this,mr,null)}_hideDropdownFromKeyboard(){var e;if(!c(this,Wl)){if(!c(this,Ae,zs)){(e=c(this,Kd))==null||e.unselect();return}this.hideDropdown(),c(this,li).focus({preventScroll:!0,focusVisible:c(this,Yd)})}}updateColor(e){if(c(this,Ko)&&(c(this,Ko).style.backgroundColor=e),!c(this,tt))return;const t=c(this,ui).highlightColors.values();for(const i of c(this,tt).children)i.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=c(this,li))==null||e.remove(),v(this,li,null),v(this,Ko,null),(t=c(this,tt))==null||t.remove(),v(this,tt,null)}};li=new WeakMap,Ko=new WeakMap,$l=new WeakMap,tt=new WeakMap,Yd=new WeakMap,Wl=new WeakMap,Kd=new WeakMap,Jd=new WeakMap,mr=new WeakMap,ui=new WeakMap,Yl=new WeakMap,Xd=new WeakMap,Ae=new WeakSet,Ry=function(){const e=document.createElement("div"),t=c(this,ui)._signal;e.addEventListener("contextmenu",vi,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,s]of c(this,ui).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=i,r.setAttribute("data-l10n-id",c(jt,Xd)[i]);const o=document.createElement("span");r.append(o),o.className="swatch",o.style.backgroundColor=s,r.setAttribute("aria-selected",s===c(this,$l)),r.addEventListener("click",w(this,Ae,My).bind(this,s),{signal:t}),e.append(r)}return e.addEventListener("keydown",w(this,Ae,ky).bind(this),{signal:t}),e},My=function(e,t){t.stopPropagation(),c(this,Jd).dispatch("switchannotationeditorparams",{source:this,type:c(this,Yl),value:e})},ky=function(e){jt._keyboardManager.exec(this,e)},Xr=function(e){if(c(this,Ae,zs)){this.hideDropdown();return}if(v(this,Yd,e.detail===0),c(this,mr)||(v(this,mr,new AbortController),window.addEventListener("pointerdown",w(this,Ae,LT).bind(this),{signal:c(this,ui).combinedSignal(c(this,mr))})),c(this,tt)){c(this,tt).classList.remove("hidden");return}const t=v(this,tt,w(this,Ae,Ry).call(this));c(this,li).append(t)},LT=function(e){var t;(t=c(this,tt))!=null&&t.contains(e.target)||this.hideDropdown()},zs=function(){return c(this,tt)&&!c(this,tt).classList.contains("hidden")},S(jt,Xd,null);let ip=jt;var Kl,Qd,As,Jo,Jl,nn,Zd,jd,Xo,Fn,vn,mt,Xl,Es,Mt,Ql,Un,eh,j,Ny,mf,FT,UT,HT,by,Qr,zn,Ma,VT,yf,Xu,OT,GT,BT,zT,qT;const ge=class ge extends He{constructor(t){super({...t,name:"highlightEditor"});S(this,j);S(this,Kl,null);S(this,Qd,0);S(this,As);S(this,Jo,null);S(this,Jl,null);S(this,nn,null);S(this,Zd,null);S(this,jd,0);S(this,Xo,null);S(this,Fn,null);S(this,vn,null);S(this,mt,!1);S(this,Xl,null);S(this,Es);S(this,Mt,null);S(this,Ql,"");S(this,Un);S(this,eh,"");this.color=t.color||ge._defaultColor,v(this,Un,t.thickness||ge._defaultThickness),v(this,Es,t.opacity||ge._defaultOpacity),v(this,As,t.boxes||null),v(this,eh,t.methodOfCreation||""),v(this,Ql,t.text||""),this._isDraggable=!1,t.highlightId>-1?(v(this,mt,!0),w(this,j,mf).call(this,t),w(this,j,Qr).call(this)):c(this,As)&&(v(this,Kl,t.anchorNode),v(this,Qd,t.anchorOffset),v(this,Zd,t.focusNode),v(this,jd,t.focusOffset),w(this,j,Ny).call(this),w(this,j,Qr).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=ge.prototype;return oe(this,"_keyboardManager",new ch([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:c(this,mt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:c(this,Un),methodOfCreation:c(this,eh)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,i){var s;He.initialize(t,i),ge._defaultColor||(ge._defaultColor=((s=i.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,i){switch(t){case ue.HIGHLIGHT_DEFAULT_COLOR:ge._defaultColor=i;break;case ue.HIGHLIGHT_THICKNESS:ge._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return c(this,Xl)}updateParams(t,i){switch(t){case ue.HIGHLIGHT_COLOR:w(this,j,FT).call(this,i);break;case ue.HIGHLIGHT_THICKNESS:w(this,j,UT).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[ue.HIGHLIGHT_DEFAULT_COLOR,ge._defaultColor],[ue.HIGHLIGHT_THICKNESS,ge._defaultThickness]]}get propertiesToUpdate(){return[[ue.HIGHLIGHT_COLOR,this.color||ge._defaultColor],[ue.HIGHLIGHT_THICKNESS,c(this,Un)||ge._defaultThickness],[ue.HIGHLIGHT_FREE,c(this,mt)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(v(this,Jl,new ip({editor:this})),t.addColorPicker(c(this,Jl))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(w(this,j,Xu).call(this))}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,w(this,j,Xu).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){w(this,j,by).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(w(this,j,Qr).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?w(this,j,by).call(this):t&&(w(this,j,Qr).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var r,o,a;const{drawLayer:i}=this.parent;let s;c(this,mt)?(t=(t-this.rotation+360)%360,s=w(r=ge,zn,Ma).call(r,c(this,Fn).box,t)):s=w(o=ge,zn,Ma).call(o,[this.x,this.y,this.width,this.height],t),i.updateProperties(c(this,vn),{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(c(this,Mt),{bbox:w(a=ge,zn,Ma).call(a,c(this,nn).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();c(this,Ql)&&(t.setAttribute("aria-label",c(this,Ql)),t.setAttribute("role","mark")),c(this,mt)?t.classList.add("free"):this.div.addEventListener("keydown",w(this,j,VT).bind(this),{signal:this._uiManager._signal});const i=v(this,Xo,document.createElement("div"));t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=c(this,Jo);const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),jf(this,c(this,Xo),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Mt),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Mt),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:w(this,j,yf).call(this,!0);break;case 1:case 3:w(this,j,yf).call(this,!1);break}}select(){var t;super.select(),c(this,Mt)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,Mt),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),c(this,Mt)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,Mt),{rootClass:{selected:!1}}),c(this,mt)||w(this,j,yf).call(this,!1))}get _mustFixPosition(){return!c(this,mt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(c(this,vn),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(c(this,Mt),{rootClass:{hidden:!t}}))}static startHighlighting(t,i,{target:s,x:r,y:o}){const{x:a,y:l,width:u,height:h}=s.getBoundingClientRect(),p=new AbortController,g=t.combinedSignal(p),m=y=>{p.abort(),w(this,zn,zT).call(this,t,y)};window.addEventListener("blur",m,{signal:g}),window.addEventListener("pointerup",m,{signal:g}),window.addEventListener("pointerdown",Tn,{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",vi,{signal:g}),s.addEventListener("pointermove",w(this,zn,BT).bind(this,t),{signal:g}),this._freeHighlight=new Py({x:r,y:o},[a,l,u,h],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,i,s){var A,T,_,E;let r=null;if(t instanceof mT){const{data:{quadPoints:C,rect:I,rotation:x,id:R,color:P,opacity:M,popupRef:k},parent:{page:{pageNumber:N}}}=t;r=t={annotationType:ee.HIGHLIGHT,color:Array.from(P),opacity:M,quadPoints:C,boxes:null,pageIndex:N-1,rect:I.slice(0),rotation:x,id:R,deleted:!1,popupRef:k}}else if(t instanceof o0){const{data:{inkLists:C,rect:I,rotation:x,id:R,color:P,borderStyle:{rawWidth:M},popupRef:k},parent:{page:{pageNumber:N}}}=t;r=t={annotationType:ee.HIGHLIGHT,color:Array.from(P),thickness:M,inkLists:C,boxes:null,pageIndex:N-1,rect:I.slice(0),rotation:x,id:R,deleted:!1,popupRef:k}}const{color:o,quadPoints:a,inkLists:l,opacity:u}=t,h=await super.deserialize(t,i,s);h.color=W.makeHexColor(...o),v(h,Es,u||1),l&&v(h,Un,t.thickness),h.annotationElementId=t.id||null,h._initialData=r;const[p,g]=h.pageDimensions,[m,y]=h.pageTranslation;if(a){const C=v(h,As,[]);for(let I=0;I<a.length;I+=8)C.push({x:(a[I]-m)/p,y:1-(a[I+1]-y)/g,width:(a[I+2]-a[I])/p,height:(a[I+1]-a[I+5])/g});w(A=h,j,Ny).call(A),w(T=h,j,Qr).call(T),h.rotate(h.rotation)}else if(l){v(h,mt,!0);const C=l[0],I={x:C[0]-m,y:g-(C[1]-y)},x=new Py(I,[0,0,p,g],1,c(h,Un)/2,!0,.001);for(let M=0,k=C.length;M<k;M+=2)I.x=C[M]-m,I.y=g-(C[M+1]-y),x.add(I);const{id:R,clipPathId:P}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:x.toSVGPath()}},!0,!0);w(_=h,j,mf).call(_,{highlightOutlines:x.getOutlines(),highlightId:R,clipPathId:P}),w(E=h,j,Qr).call(E)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=this.getRect(0,0),s=He._colorManager.convert(this.color),r={annotationType:ee.HIGHLIGHT,color:s,opacity:c(this,Es),thickness:c(this,Un),quadPoints:w(this,j,OT).call(this),outlines:w(this,j,GT).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:w(this,j,Xu).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!w(this,j,qT).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Kl=new WeakMap,Qd=new WeakMap,As=new WeakMap,Jo=new WeakMap,Jl=new WeakMap,nn=new WeakMap,Zd=new WeakMap,jd=new WeakMap,Xo=new WeakMap,Fn=new WeakMap,vn=new WeakMap,mt=new WeakMap,Xl=new WeakMap,Es=new WeakMap,Mt=new WeakMap,Ql=new WeakMap,Un=new WeakMap,eh=new WeakMap,j=new WeakSet,Ny=function(){const t=new Iy(c(this,As),.001);v(this,Fn,t.getOutlines()),[this.x,this.y,this.width,this.height]=c(this,Fn).box;const i=new Iy(c(this,As),.0025,.001,this._uiManager.direction==="ltr");v(this,nn,i.getOutlines());const{lastPoint:s}=c(this,nn);v(this,Xl,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},mf=function({highlightOutlines:t,highlightId:i,clipPathId:s}){var p,g;if(v(this,Fn,t),v(this,nn,t.getNewOutline(c(this,Un)/2+1.5,.0025)),i>=0)v(this,vn,i),v(this,Jo,s),this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),v(this,Mt,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:c(this,nn).box,path:{d:c(this,nn).toSVGPath()}},!0));else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(c(this,vn),{bbox:w(p=ge,zn,Ma).call(p,c(this,Fn).box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(c(this,Mt),{bbox:w(g=ge,zn,Ma).call(g,c(this,nn).box,m),path:{d:c(this,nn).toSVGPath()}})}const[o,a,l,u]=t.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=l,this.height=u;break;case 90:{const[m,y]=this.parentDimensions;this.x=a,this.y=1-o,this.width=l*y/m,this.height=u*m/y;break}case 180:this.x=1-o,this.y=1-a,this.width=l,this.height=u;break;case 270:{const[m,y]=this.parentDimensions;this.x=1-a,this.y=o,this.width=l*y/m,this.height=u*m/y;break}}const{lastPoint:h}=c(this,nn);v(this,Xl,[(h[0]-o)/l,(h[1]-a)/u])},FT=function(t){const i=(o,a)=>{var l,u;this.color=o,v(this,Es,a),(l=this.parent)==null||l.drawLayer.updateProperties(c(this,vn),{root:{fill:o,"fill-opacity":a}}),(u=c(this,Jl))==null||u.updateColor(o)},s=this.color,r=c(this,Es);this.addCommands({cmd:i.bind(this,t,ge._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ue.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},UT=function(t){const i=c(this,Un),s=r=>{v(this,Un,r),w(this,j,HT).call(this,r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ue.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},HT=function(t){if(!c(this,mt))return;w(this,j,mf).call(this,{highlightOutlines:c(this,Fn).getNewOutline(t/2)}),this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)},by=function(){c(this,vn)===null||!this.parent||(this.parent.drawLayer.remove(c(this,vn)),v(this,vn,null),this.parent.drawLayer.remove(c(this,Mt)),v(this,Mt,null))},Qr=function(t=this.parent){c(this,vn)===null&&({id:Ut(this,vn)._,clipPathId:Ut(this,Jo)._}=t.drawLayer.draw({bbox:c(this,Fn).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":c(this,Es)},rootClass:{highlight:!0,free:c(this,mt)},path:{d:c(this,Fn).toSVGPath()}},!1,!0),v(this,Mt,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:c(this,mt)},bbox:c(this,nn).box,path:{d:c(this,nn).toSVGPath()}},c(this,mt))),c(this,Xo)&&(c(this,Xo).style.clipPath=c(this,Jo)))},zn=new WeakSet,Ma=function([t,i,s,r],o){switch(o){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]},VT=function(t){ge._keyboardManager.exec(this,t)},yf=function(t){if(!c(this,Kl))return;const i=window.getSelection();t?i.setPosition(c(this,Kl),c(this,Qd)):i.setPosition(c(this,Zd),c(this,jd))},Xu=function(){return c(this,mt)?this.rotation:0},OT=function(){if(c(this,mt))return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,o=c(this,As),a=new Float32Array(o.length*8);let l=0;for(const{x:u,y:h,width:p,height:g}of o){const m=u*t+s,y=(1-h)*i+r;a[l]=a[l+4]=m,a[l+1]=a[l+3]=y,a[l+2]=a[l+6]=m+p*t,a[l+5]=a[l+7]=y-g*i,l+=8}return a},GT=function(t){return c(this,Fn).serialize(t,w(this,j,Xu).call(this))},BT=function(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},zT=function(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},qT=function(t){const{color:i}=this._initialData;return t.color.some((s,r)=>s!==i[r])},S(ge,zn),J(ge,"_defaultColor",null),J(ge,"_defaultOpacity",1),J(ge,"_defaultThickness",12),J(ge,"_type","highlight"),J(ge,"_editorType",ee.HIGHLIGHT),J(ge,"_freeHighlightId",-1),J(ge,"_freeHighlight",null),J(ge,"_freeHighlightClipId","");let sp=ge;var Qo;class cF{constructor(){S(this,Qo,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))this.updateProperty(t,i)}updateSVGProperty(e,t){c(this,Qo)[e]=t}toSVGProperties(){const e=c(this,Qo);return v(this,Qo,Object.create(null)),{root:e}}reset(){v(this,Qo,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Se("Not implemented")}}Qo=new WeakMap;var _n,Zl,ut,Zo,jo,yr,vr,_r,ea,he,Ly,Fy,Uy,Qu,$T,vf,Zu,ka;const z=class z extends He{constructor(t){super(t);S(this,he);S(this,_n,null);S(this,Zl);J(this,"_drawId",null);v(this,Zl,t.mustBeCommitted||!1),t.drawOutlines&&(w(this,he,Ly).call(this,t),w(this,he,Qu).call(this))}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,o]of Object.entries(i))s.has(r)?Object.assign(t[r],o):t[r]=o;return t}static getDefaultDrawingOptions(t){Se("Not implemented")}static get typesMap(){Se("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(c(z,ut).updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,o=r[i],a=l=>{var h;r.updateProperty(i,l);const u=c(this,_n).updateProperty(i,l);u&&w(this,he,Zu).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:a.bind(this,s),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,z._mergeSVGProperties(c(this,_n).getPathResizingSVGProperties(w(this,he,vf).call(this)),{bbox:w(this,he,ka).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,z._mergeSVGProperties(c(this,_n).getPathResizedSVGProperties(w(this,he,vf).call(this)),{bbox:w(this,he,ka).call(this)}))}_onTranslating(t,i){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:w(this,he,ka).call(this,t,i)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,z._mergeSVGProperties(c(this,_n).getPathTranslatedSVGProperties(w(this,he,vf).call(this),this.parentDimensions),{bbox:w(this,he,ka).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,c(this,Zl)&&(v(this,Zl,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){w(this,he,Uy).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(w(this,he,Qu).call(this),w(this,he,Zu).call(this,c(this,_n).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),w(this,he,Uy).call(this)):t&&(this._uiManager.addShouldRescale(this),w(this,he,Qu).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,z._mergeSVGProperties({bbox:w(this,he,ka).call(this)},c(this,_n).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&w(this,he,Zu).call(this,c(this,_n).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const i=document.createElement("div");t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,i,s,r,o){Se("Not implemented")}static startDrawing(t,i,s,r){var T;const{target:o,offsetX:a,offsetY:l,pointerId:u,pointerType:h}=r;if(c(z,vr)&&c(z,vr)!==h)return;const{viewport:{rotation:p}}=t,{width:g,height:m}=o.getBoundingClientRect(),y=v(z,Zo,new AbortController),A=t.combinedSignal(y);if(c(z,yr)||v(z,yr,u),c(z,vr)??v(z,vr,h),window.addEventListener("pointerup",_=>{var E;c(z,yr)===_.pointerId?this._endDraw(_):(E=c(z,_r))==null||E.delete(_.pointerId)},{signal:A}),window.addEventListener("pointercancel",_=>{var E;c(z,yr)===_.pointerId?this._currentParent.endDrawingSession():(E=c(z,_r))==null||E.delete(_.pointerId)},{signal:A}),window.addEventListener("pointerdown",_=>{c(z,vr)===_.pointerType&&((c(z,_r)||v(z,_r,new Set)).add(_.pointerId),c(z,ut).isCancellable()&&(c(z,ut).removeLastElement(),c(z,ut).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:A}),window.addEventListener("contextmenu",vi,{signal:A}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:A}),o.addEventListener("touchmove",_=>{_.timeStamp===c(z,ea)&&Tn(_)},{signal:A}),t.toggleDrawing(),(T=i._editorUndoBar)==null||T.hide(),c(z,ut)){t.drawLayer.updateProperties(this._currentDrawId,c(z,ut).startNew(a,l,g,m,p));return}i.updateUIForDefaultProperties(this),v(z,ut,this.createDrawerInstance(a,l,g,m,p)),v(z,jo,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(c(z,jo).toSVGProperties(),c(z,ut).defaultSVGProperties),!0,!1)}static _drawMove(t){var o;if(v(z,ea,-1),!c(z,ut))return;const{offsetX:i,offsetY:s,pointerId:r}=t;if(c(z,yr)===r){if(((o=c(z,_r))==null?void 0:o.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,c(z,ut).add(i,s)),v(z,ea,t.timeStamp),Tn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,v(z,ut,null),v(z,jo,null),v(z,vr,null),v(z,ea,NaN)),c(z,Zo)&&(c(z,Zo).abort(),v(z,Zo,null),v(z,yr,NaN),v(z,_r,null))}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t&&i.drawLayer.updateProperties(this._currentDrawId,c(z,ut).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=c(z,ut),r=this._currentDrawId,o=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,s.setLastElement(o))},undo:()=>{i.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:ue.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(ue.DRAW_STEP),!c(z,ut).isEmpty()){const{pageDimensions:[s,r],scale:o}=i,a=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:c(z,ut).getOutlines(s*o,r*o,o,this._INNER_MARGIN),drawingOptions:c(z,jo),mustBeCommitted:!t});return this._cleanup(!0),a}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,o,a){Se("Not implemented")}static async deserialize(t,i,s){var p,g;const{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:l}}=i.viewport,u=this.deserializeDraw(a,l,r,o,this._INNER_MARGIN,t),h=await super.deserialize(t,i,s);return h.createDrawingOptions(t),w(p=h,he,Ly).call(p,{drawOutlines:u}),w(g=h,he,Qu).call(g),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[i,s]=this.pageTranslation,[r,o]=this.pageDimensions;return c(this,_n).serialize([i,s,r,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};_n=new WeakMap,Zl=new WeakMap,ut=new WeakMap,Zo=new WeakMap,jo=new WeakMap,yr=new WeakMap,vr=new WeakMap,_r=new WeakMap,ea=new WeakMap,he=new WeakSet,Ly=function({drawOutlines:t,drawId:i,drawingOptions:s}){v(this,_n,t),this._drawingOptions||(this._drawingOptions=s),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=w(this,he,Fy).call(this,t,this.parent),w(this,he,Zu).call(this,t.box)},Fy=function(t,i){const{id:s}=i.drawLayer.draw(z._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},Uy=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Qu=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=w(this,he,Fy).call(this,c(this,_n),t)}},$T=function([t,i,s,r]){const{parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[i,1-t,s*(a/o),r*(o/a)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(a/o),r*(o/a)];default:return[t,i,s,r]}},vf=function(){const{x:t,y:i,width:s,height:r,parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[1-i,t,s*(o/a),r*(a/o)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(o/a),r*(a/o)];default:return[t,i,s,r]}},Zu=function(t){if([this.x,this.y,this.width,this.height]=w(this,he,$T).call(this,t),this.div){this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)}this._onResized()},ka=function(){const{x:t,y:i,width:s,height:r,rotation:o,parentRotation:a,parentDimensions:[l,u]}=this;switch((o*4+a)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(l/u),r*(u/l),s*(l/u)];case 5:return[1-i,t,s*(l/u),r*(u/l)];case 6:return[1-t-r*(u/l),1-i,r*(u/l),s*(l/u)];case 7:return[i-s*(l/u),1-t-r*(u/l),s*(l/u),r*(u/l)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(u/l),i,r*(u/l),s*(l/u)];case 13:return[1-i-s*(l/u),t-r*(u/l),s*(l/u),r*(u/l)];case 14:return[1-t,1-i-s*(l/u),r*(u/l),s*(l/u)];case 15:return[i,1-t,s*(l/u),r*(u/l)];default:return[t,i,s,r]}},J(z,"_currentDrawId",-1),J(z,"_currentParent",null),S(z,ut,null),S(z,Zo,null),S(z,jo,null),S(z,yr,NaN),S(z,vr,null),S(z,_r,null),S(z,ea,NaN),J(z,"_INNER_MARGIN",3);let Dy=z;var Ui,ct,dt,ta,jl,Ot,yt,Hn,na,ia,sa,eu,_f;class dF{constructor(e,t,i,s,r,o){S(this,eu);S(this,Ui,new Float64Array(6));S(this,ct);S(this,dt);S(this,ta);S(this,jl);S(this,Ot);S(this,yt,"");S(this,Hn,0);S(this,na,new rp);S(this,ia);S(this,sa);v(this,ia,i),v(this,sa,s),v(this,ta,r),v(this,jl,o),[e,t]=w(this,eu,_f).call(this,e,t);const a=v(this,ct,[NaN,NaN,NaN,NaN,e,t]);v(this,Ot,[e,t]),v(this,dt,[{line:a,points:c(this,Ot)}]),c(this,Ui).set(a,0)}updateProperty(e,t){e==="stroke-width"&&v(this,jl,t)}isEmpty(){return!c(this,dt)||c(this,dt).length===0}isCancellable(){return c(this,Ot).length<=10}add(e,t){[e,t]=w(this,eu,_f).call(this,e,t);const[i,s,r,o]=c(this,Ui).subarray(2,6),a=e-r,l=t-o;return Math.hypot(c(this,ia)*a,c(this,sa)*l)<=2?null:(c(this,Ot).push(e,t),isNaN(i)?(c(this,Ui).set([r,o,e,t],2),c(this,ct).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(c(this,Ui)[0])&&c(this,ct).splice(6,6),c(this,Ui).set([i,s,r,o,e,t],0),c(this,ct).push(...G.createBezierPoints(i,s,r,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(c(this,Ot).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,s,r){v(this,ia,i),v(this,sa,s),v(this,ta,r),[e,t]=w(this,eu,_f).call(this,e,t);const o=v(this,ct,[NaN,NaN,NaN,NaN,e,t]);v(this,Ot,[e,t]);const a=c(this,dt).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),c(this,dt).push({line:o,points:c(this,Ot)}),c(this,Ui).set(o,0),v(this,Hn,0),this.toSVGPath(),null}getLastElement(){return c(this,dt).at(-1)}setLastElement(e){return c(this,dt)?(c(this,dt).push(e),v(this,ct,e.line),v(this,Ot,e.points),v(this,Hn,0),{path:{d:this.toSVGPath()}}):c(this,na).setLastElement(e)}removeLastElement(){if(!c(this,dt))return c(this,na).removeLastElement();c(this,dt).pop(),v(this,yt,"");for(let e=0,t=c(this,dt).length;e<t;e++){const{line:i,points:s}=c(this,dt)[e];v(this,ct,i),v(this,Ot,s),v(this,Hn,0),this.toSVGPath()}return{path:{d:c(this,yt)}}}toSVGPath(){const e=G.svgRound(c(this,ct)[4]),t=G.svgRound(c(this,ct)[5]);if(c(this,Ot).length===2)return v(this,yt,`${c(this,yt)} M ${e} ${t} Z`),c(this,yt);if(c(this,Ot).length<=6){const s=c(this,yt).lastIndexOf("M");v(this,yt,`${c(this,yt).slice(0,s)} M ${e} ${t}`),v(this,Hn,6)}if(c(this,Ot).length===4){const s=G.svgRound(c(this,ct)[10]),r=G.svgRound(c(this,ct)[11]);return v(this,yt,`${c(this,yt)} L ${s} ${r}`),v(this,Hn,12),c(this,yt)}const i=[];c(this,Hn)===0&&(i.push(`M ${e} ${t}`),v(this,Hn,6));for(let s=c(this,Hn),r=c(this,ct).length;s<r;s+=6){const[o,a,l,u,h,p]=c(this,ct).slice(s,s+6).map(G.svgRound);i.push(`C${o} ${a} ${l} ${u} ${h} ${p}`)}return v(this,yt,c(this,yt)+i.join(" ")),v(this,Hn,c(this,ct).length),c(this,yt)}getOutlines(e,t,i,s){const r=c(this,dt).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),c(this,na).build(c(this,dt),e,t,i,c(this,ta),c(this,jl),s),v(this,Ui,null),v(this,ct,null),v(this,dt,null),v(this,yt,null),c(this,na)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Ui=new WeakMap,ct=new WeakMap,dt=new WeakMap,ta=new WeakMap,jl=new WeakMap,Ot=new WeakMap,yt=new WeakMap,Hn=new WeakMap,na=new WeakMap,ia=new WeakMap,sa=new WeakMap,eu=new WeakSet,_f=function(e,t){return G._normalizePoint(e,t,c(this,ia),c(this,sa),c(this,ta))};var Gt,th,nh,An,Hi,Vi,tu,nu,iu,At,Xi,WT,YT,KT;const d0=class d0 extends G{constructor(){super(...arguments);S(this,At);S(this,Gt);S(this,th,0);S(this,nh);S(this,An);S(this,Hi);S(this,Vi);S(this,tu);S(this,nu);S(this,iu)}build(t,i,s,r,o,a,l){v(this,Hi,i),v(this,Vi,s),v(this,tu,r),v(this,nu,o),v(this,iu,a),v(this,nh,l??0),v(this,An,t),w(this,At,YT).call(this)}setLastElement(t){return c(this,An).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return c(this,An).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of c(this,An)){if(t.push(`M${G.svgRound(i[4])} ${G.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12){t.push(`L${G.svgRound(i[10])} ${G.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[o,a,l,u,h,p]=i.subarray(s,s+6).map(G.svgRound);t.push(`C${o} ${a} ${l} ${u} ${h} ${p}`)}}return t.join("")}serialize([t,i,s,r],o){const a=[],l=[],[u,h,p,g]=w(this,At,WT).call(this);let m,y,A,T,_,E,C,I,x;switch(c(this,nu)){case 0:x=G._rescale,m=t,y=i+r,A=s,T=-r,_=t+u*s,E=i+(1-h-g)*r,C=t+(u+p)*s,I=i+(1-h)*r;break;case 90:x=G._rescaleAndSwap,m=t,y=i,A=s,T=r,_=t+h*s,E=i+u*r,C=t+(h+g)*s,I=i+(u+p)*r;break;case 180:x=G._rescale,m=t+s,y=i,A=-s,T=r,_=t+(1-u-p)*s,E=i+h*r,C=t+(1-u)*s,I=i+(h+g)*r;break;case 270:x=G._rescaleAndSwap,m=t+s,y=i+r,A=-s,T=-r,_=t+(1-h-g)*s,E=i+(1-u-p)*r,C=t+(1-h)*s,I=i+(1-u)*r;break}for(const{line:R,points:P}of c(this,An))a.push(x(R,m,y,A,T,o?new Array(R.length):null)),l.push(x(P,m,y,A,T,o?new Array(P.length):null));return{lines:a,points:l,rect:[_,E,C,I]}}static deserialize(t,i,s,r,o,{paths:{lines:a,points:l},rotation:u,thickness:h}){const p=[];let g,m,y,A,T;switch(u){case 0:T=G._rescale,g=-t/s,m=i/r+1,y=1/s,A=-1/r;break;case 90:T=G._rescaleAndSwap,g=-i/r,m=-t/s,y=1/r,A=1/s;break;case 180:T=G._rescale,g=t/s+1,m=-i/r,y=-1/s,A=1/r;break;case 270:T=G._rescaleAndSwap,g=i/r+1,m=t/s+1,y=-1/r,A=-1/s;break}if(!a){a=[];for(const E of l){const C=E.length;if(C===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(C===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const I=new Float32Array(3*(C-2));a.push(I);let[x,R,P,M]=E.subarray(0,4);I.set([NaN,NaN,NaN,NaN,x,R],0);for(let k=4;k<C;k+=2){const N=E[k],L=E[k+1];I.set(G.createBezierPoints(x,R,P,M,N,L),(k-2)*3),[x,R,P,M]=[P,M,N,L]}}}for(let E=0,C=a.length;E<C;E++)p.push({line:T(a[E].map(I=>I??NaN),g,m,y,A),points:T(l[E].map(I=>I??NaN),g,m,y,A)});const _=new d0;return _.build(p,s,r,1,u,h,o),_}get box(){return c(this,Gt)}updateProperty(t,i){return t==="stroke-width"?w(this,At,KT).call(this,i):null}updateParentDimensions([t,i],s){const[r,o]=w(this,At,Xi).call(this);v(this,Hi,t),v(this,Vi,i),v(this,tu,s);const[a,l]=w(this,At,Xi).call(this),u=a-r,h=l-o,p=c(this,Gt);return p[0]-=u,p[1]-=h,p[2]+=2*u,p[3]+=2*h,p}updateRotation(t){return v(this,th,t),{path:{transform:this.rotationTransform}}}get viewBox(){return c(this,Gt).map(G.svgRound).join(" ")}get defaultProperties(){const[t,i]=c(this,Gt);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=c(this,Gt);let s=0,r=0,o=0,a=0,l=0,u=0;switch(c(this,th)){case 90:r=i/t,o=-t/i,l=t;break;case 180:s=-1,a=-1,l=t,u=i;break;case 270:r=-i/t,o=t/i,u=i;break;default:return""}return`matrix(${s} ${r} ${o} ${a} ${G.svgRound(l)} ${G.svgRound(u)})`}getPathResizingSVGProperties([t,i,s,r]){const[o,a]=w(this,At,Xi).call(this),[l,u,h,p]=c(this,Gt);if(Math.abs(h-o)<=G.PRECISION||Math.abs(p-a)<=G.PRECISION){const T=t+s/2-(l+h/2),_=i+r/2-(u+p/2);return{path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(i)}`,transform:`${this.rotationTransform} translate(${T} ${_})`}}}const g=(s-2*o)/(h-2*o),m=(r-2*a)/(p-2*a),y=h/s,A=p/r;return{path:{"transform-origin":`${G.svgRound(l)} ${G.svgRound(u)}`,transform:`${this.rotationTransform} scale(${y} ${A}) translate(${G.svgRound(o)} ${G.svgRound(a)}) scale(${g} ${m}) translate(${G.svgRound(-o)} ${G.svgRound(-a)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[o,a]=w(this,At,Xi).call(this),l=c(this,Gt),[u,h,p,g]=l;if(l[0]=t,l[1]=i,l[2]=s,l[3]=r,Math.abs(p-o)<=G.PRECISION||Math.abs(g-a)<=G.PRECISION){const _=t+s/2-(u+p/2),E=i+r/2-(h+g/2);for(const{line:C,points:I}of c(this,An))G._translate(C,_,E,C),G._translate(I,_,E,I);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(s-2*o)/(p-2*o),y=(r-2*a)/(g-2*a),A=-m*(u+o)+t+o,T=-y*(h+a)+i+a;if(m!==1||y!==1||A!==0||T!==0)for(const{line:_,points:E}of c(this,An))G._rescale(_,A,T,m,y,_),G._rescale(E,A,T,m,y,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,o]=s,a=c(this,Gt),l=t-a[0],u=i-a[1];if(c(this,Hi)===r&&c(this,Vi)===o)for(const{line:h,points:p}of c(this,An))G._translate(h,l,u,h),G._translate(p,l,u,p);else{const h=c(this,Hi)/r,p=c(this,Vi)/o;v(this,Hi,r),v(this,Vi,o);for(const{line:g,points:m}of c(this,An))G._rescale(g,l,u,h,p,g),G._rescale(m,l,u,h,p,m);a[2]*=h,a[3]*=p}return a[0]=t,a[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${G.svgRound(t)} ${G.svgRound(i)}`}}}get defaultSVGProperties(){const t=c(this,Gt);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${G.svgRound(t[0])} ${G.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Gt=new WeakMap,th=new WeakMap,nh=new WeakMap,An=new WeakMap,Hi=new WeakMap,Vi=new WeakMap,tu=new WeakMap,nu=new WeakMap,iu=new WeakMap,At=new WeakSet,Xi=function(t=c(this,iu)){const i=c(this,nh)+t/2*c(this,tu);return c(this,nu)%180===0?[i/c(this,Hi),i/c(this,Vi)]:[i/c(this,Vi),i/c(this,Hi)]},WT=function(){const[t,i,s,r]=c(this,Gt),[o,a]=w(this,At,Xi).call(this,0);return[t+o,i+a,s-2*o,r-2*a]},YT=function(){const t=v(this,Gt,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of c(this,An)){if(r.length<=12){for(let l=4,u=r.length;l<u;l+=6){const[h,p]=r.subarray(l,l+2);t[0]=Math.min(t[0],h),t[1]=Math.min(t[1],p),t[2]=Math.max(t[2],h),t[3]=Math.max(t[3],p)}continue}let o=r[4],a=r[5];for(let l=6,u=r.length;l<u;l+=6){const[h,p,g,m,y,A]=r.subarray(l,l+6);W.bezierBoundingBox(o,a,h,p,g,m,y,A,t),o=y,a=A}}const[i,s]=w(this,At,Xi).call(this);t[0]=Math.min(1,Math.max(0,t[0]-i)),t[1]=Math.min(1,Math.max(0,t[1]-s)),t[2]=Math.min(1,Math.max(0,t[2]+i)),t[3]=Math.min(1,Math.max(0,t[3]+s)),t[2]-=t[0],t[3]-=t[1]},KT=function(t){const[i,s]=w(this,At,Xi).call(this);v(this,iu,t);const[r,o]=w(this,At,Xi).call(this),[a,l]=[r-i,o-s],u=c(this,Gt);return u[0]-=a,u[1]-=l,u[2]+=2*a,u[3]+=2*l,u};let rp=d0;var su;const h0=class h0 extends cF{constructor(t){super();S(this,su);v(this,su,t),super.updateProperties({fill:"none",stroke:He._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??(i=this["stroke-width"]),i*=c(this,su).realScale),super.updateSVGProperty(t,i)}clone(){const t=new h0(c(this,su));return t.updateAll(this),t}};su=new WeakMap;let Hy=h0;var wp,JT;const Wa=class Wa extends Dy{constructor(t){super({...t,name:"inkEditor"});S(this,wp);this._willKeepAspectRatio=!0}static initialize(t,i){He.initialize(t,i),this._defaultDrawingOptions=new Hy(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return oe(this,"typesMap",new Map([[ue.INK_THICKNESS,"stroke-width"],[ue.INK_COLOR,"stroke"],[ue.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,r,o){return new dF(t,i,s,r,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,r,o,a){return rp.deserialize(t,i,s,r,o,a)}static async deserialize(t,i,s){let r=null;if(t instanceof o0){const{data:{inkLists:a,rect:l,rotation:u,id:h,color:p,opacity:g,borderStyle:{rawWidth:m},popupRef:y},parent:{page:{pageNumber:A}}}=t;r=t={annotationType:ee.INK,color:Array.from(p),thickness:m,opacity:g,paths:{points:a},boxes:null,pageIndex:A-1,rect:l.slice(0),rotation:u,id:h,deleted:!1,popupRef:y}}const o=await super.deserialize(t,i,s);return o.annotationElementId=t.id||null,o._initialData=r,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=Wa.getDefaultDrawingOptions({stroke:W.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":a,"stroke-width":l}}=this,u={annotationType:ee.INK,color:He._colorManager.convert(o),opacity:a,thickness:l,paths:{lines:i,points:s},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?u:this.annotationElementId&&!w(this,wp,JT).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(t){const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i}),null}};wp=new WeakSet,JT=function(t){const{color:i,thickness:s,opacity:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((a,l)=>a!==i[l])||t.thickness!==s||t.opacity!==r||t.pageIndex!==o},J(Wa,"_type","ink"),J(Wa,"_editorType",ee.INK),J(Wa,"_defaultDrawingOptions",null);let Vy=Wa;var Fe,vt,Ar,Ss,Er,ru,Oi,Gi,En,ou,fe,ju,ec,Af,Gy,Ef,By,Sf,XT;const hc=class hc extends He{constructor(t){super({...t,name:"stampEditor"});S(this,fe);S(this,Fe,null);S(this,vt,null);S(this,Ar,null);S(this,Ss,null);S(this,Er,null);S(this,ru,"");S(this,Oi,null);S(this,Gi,null);S(this,En,!1);S(this,ou,!1);v(this,Ss,t.bitmapUrl),v(this,Er,t.bitmapFile)}static initialize(t,i){He.initialize(t,i)}static get supportedTypes(){return oe(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(i=>`image/${i}`))}static get supportedTypesStr(){return oe(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,i){i.pasteEditor(ee.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:a}=t||this.copyCanvas(null,null,!0).imageData,l=await s.guess({name:"altText",request:{data:r,width:o,height:a,channels:r.length/(o*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),i&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;c(this,vt)&&(v(this,Fe,null),this._uiManager.imageManager.deleteId(c(this,vt)),(t=c(this,Oi))==null||t.remove(),v(this,Oi,null),c(this,Gi)&&(clearTimeout(c(this,Gi)),v(this,Gi,null))),super.remove()}rebuild(){if(!this.parent){c(this,vt)&&w(this,fe,Af).call(this);return}super.rebuild(),this.div!==null&&(c(this,vt)&&c(this,Oi)===null&&w(this,fe,Af).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(c(this,Ar)||c(this,Fe)||c(this,Ss)||c(this,Er)||c(this,vt))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;if(this.width&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),c(this,Fe)?w(this,fe,Gy).call(this):w(this,fe,Af).call(this),this.width&&!this.annotationElementId){const[s,r]=this.parentDimensions;this.setAt(t*s,i*r,this.width*s,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;c(this,Gi)!==null&&clearTimeout(c(this,Gi)),v(this,Gi,setTimeout(()=>{v(this,Gi,null),w(this,fe,By).call(this)},200))}copyCanvas(t,i,s=!1){var m;t||(t=224);const{width:r,height:o}=c(this,Fe),a=new Hm;let l=c(this,Fe),u=r,h=o,p=null;if(i){if(r>i||o>i){const M=Math.min(i/r,i/o);u=Math.floor(r*M),h=Math.floor(o*M)}p=document.createElement("canvas");const y=p.width=Math.ceil(u*a.sx),A=p.height=Math.ceil(h*a.sy);c(this,En)||(l=w(this,fe,Ef).call(this,y,A));const T=p.getContext("2d");T.filter=this._uiManager.hcmFilter;let _="white",E="#cfcfd8";this._uiManager.hcmFilter!=="none"?E="black":(m=window.matchMedia)!=null&&m.call(window,"(prefers-color-scheme: dark)").matches&&(_="#8f8f9d",E="#42414d");const C=15,I=C*a.sx,x=C*a.sy,R=new OffscreenCanvas(I*2,x*2),P=R.getContext("2d");P.fillStyle=_,P.fillRect(0,0,I*2,x*2),P.fillStyle=E,P.fillRect(0,0,I,x),P.fillRect(I,x,I,x),T.fillStyle=T.createPattern(R,"repeat"),T.fillRect(0,0,y,A),T.drawImage(l,0,0,l.width,l.height,0,0,y,A)}let g=null;if(s){let y,A;if(a.symmetric&&l.width<t&&l.height<t)y=l.width,A=l.height;else if(l=c(this,Fe),r>t||o>t){const E=Math.min(t/r,t/o);y=Math.floor(r*E),A=Math.floor(o*E),c(this,En)||(l=w(this,fe,Ef).call(this,y,A))}const _=new OffscreenCanvas(y,A).getContext("2d",{willReadFrequently:!0});_.drawImage(l,0,0,l.width,l.height,0,0,y,A),g={width:y,height:A,data:_.getImageData(0,0,y,A).data}}return{canvas:p,width:u,height:h,imageData:g}}getImageForAltText(){return c(this,Oi)}static async deserialize(t,i,s){var A;let r=null;if(t instanceof yT){const{data:{rect:T,rotation:_,id:E,structParent:C,popupRef:I},container:x,parent:{page:{pageNumber:R}}}=t,P=x.querySelector("canvas"),M=s.imageManager.getFromCanvas(x.id,P);P.remove();const k=((A=await i._structTree.getAriaAttributes(`${Zv}${E}`))==null?void 0:A.get("aria-label"))||"";r=t={annotationType:ee.STAMP,bitmapId:M.id,bitmap:M.bitmap,pageIndex:R-1,rect:T.slice(0),rotation:_,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:k},isSvg:!1,structParent:C,popupRef:I}}const o=await super.deserialize(t,i,s),{rect:a,bitmap:l,bitmapUrl:u,bitmapId:h,isSvg:p,accessibilityData:g}=t;h&&s.imageManager.isValidId(h)?(v(o,vt,h),l&&v(o,Fe,l)):v(o,Ss,u),v(o,En,p);const[m,y]=o.pageDimensions;return o.width=(a[2]-a[0])/m,o.height=(a[3]-a[1])/y,o.annotationElementId=t.id||null,g&&(o.altTextData=g),o._initialData=r,v(o,ou,!!r),o}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:ee.STAMP,bitmapId:c(this,vt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:c(this,En),structTreeParentId:this._structTreeParentId};if(t)return s.bitmapUrl=w(this,fe,Sf).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(s.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const l=w(this,fe,XT).call(this,s);if(l.isSame)return null;l.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,i===null)return s;i.stamps||(i.stamps=new Map);const a=c(this,En)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(c(this,vt)))i.stamps.set(c(this,vt),{area:a,serialized:s}),s.bitmap=w(this,fe,Sf).call(this,!1);else if(c(this,En)){const l=i.stamps.get(c(this,vt));a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=w(this,fe,Sf).call(this,!1))}return s}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};Fe=new WeakMap,vt=new WeakMap,Ar=new WeakMap,Ss=new WeakMap,Er=new WeakMap,ru=new WeakMap,Oi=new WeakMap,Gi=new WeakMap,En=new WeakMap,ou=new WeakMap,fe=new WeakSet,ju=function(t,i=!1){if(!t){this.remove();return}v(this,Fe,t.bitmap),i||(v(this,vt,t.id),v(this,En,t.isSvg)),t.file&&v(this,ru,t.file.name),w(this,fe,Gy).call(this)},ec=function(){if(v(this,Ar,null),this._uiManager.enableWaiting(!1),!!c(this,Oi)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,Fe)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,Fe)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Af=function(){if(c(this,vt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(c(this,vt)).then(s=>w(this,fe,ju).call(this,s,!0)).finally(()=>w(this,fe,ec).call(this));return}if(c(this,Ss)){const s=c(this,Ss);v(this,Ss,null),this._uiManager.enableWaiting(!0),v(this,Ar,this._uiManager.imageManager.getFromUrl(s).then(r=>w(this,fe,ju).call(this,r)).finally(()=>w(this,fe,ec).call(this)));return}if(c(this,Er)){const s=c(this,Er);v(this,Er,null),this._uiManager.enableWaiting(!0),v(this,Ar,this._uiManager.imageManager.getFromFile(s).then(r=>w(this,fe,ju).call(this,r)).finally(()=>w(this,fe,ec).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=hc.supportedTypesStr;const i=this._uiManager._signal;v(this,Ar,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),w(this,fe,ju).call(this,r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>w(this,fe,ec).call(this))),t.click()},Gy=function(){var p;const{div:t}=this;let{width:i,height:s}=c(this,Fe);const[r,o]=this.pageDimensions,a=.75;if(this.width)i=this.width*r,s=this.height*o;else if(i>a*r||s>a*o){const g=Math.min(a*r/i,a*o/s);i*=g,s*=g}const[l,u]=this.parentDimensions;this.setDims(i*l/r,s*u/o),this._uiManager.enableWaiting(!1);const h=v(this,Oi,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=i/r,this.height=s/o,(p=this._initialOptions)!=null&&p.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),w(this,fe,By).call(this),c(this,ou)||(this.parent.addUndoableEditor(this),v(this,ou,!0)),this._reportTelemetry({action:"inserted_image"}),c(this,ru)&&h.setAttribute("aria-label",c(this,ru))},Ef=function(t,i){const{width:s,height:r}=c(this,Fe);let o=s,a=r,l=c(this,Fe);for(;o>2*t||a>2*i;){const u=o,h=a;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*i&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const p=new OffscreenCanvas(o,a);p.getContext("2d").drawImage(l,0,0,u,h,0,0,o,a),l=p.transferToImageBitmap()}return l},By=function(){const[t,i]=this.parentDimensions,{width:s,height:r}=this,o=new Hm,a=Math.ceil(s*t*o.sx),l=Math.ceil(r*i*o.sy),u=c(this,Oi);if(!u||u.width===a&&u.height===l)return;u.width=a,u.height=l;const h=c(this,En)?c(this,Fe):w(this,fe,Ef).call(this,a,l),p=u.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(h,0,0,h.width,h.height,0,0,a,l)},Sf=function(t){if(t){if(c(this,En)){const r=this._uiManager.imageManager.getSvgUrl(c(this,vt));if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=c(this,Fe),i.getContext("2d").drawImage(c(this,Fe),0,0),i.toDataURL()}if(c(this,En)){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*Or.PDF_TO_CSS_UNITS),o=Math.round(this.height*s*Or.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(r,o);return a.getContext("2d").drawImage(c(this,Fe),0,0,c(this,Fe).width,c(this,Fe).height,0,0,r,o),a.transferToImageBitmap()}return structuredClone(c(this,Fe))},XT=function(t){var a;const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===i,o=(((a=t.accessibilityData)==null?void 0:a.alt)||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&o,isSameAltText:o}},J(hc,"_type","stamp"),J(hc,"_editorType",ee.STAMP);let Oy=hc;var ra,au,Bi,Sr,ws,Vn,wr,lu,oa,ci,Cs,kt,Ts,q,Cr,Ne,QT,Ci,qy,$y,wf;const Qn=class Qn{constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:o,drawLayer:a,textLayer:l,viewport:u,l10n:h}){S(this,Ne);S(this,ra);S(this,au,!1);S(this,Bi,null);S(this,Sr,null);S(this,ws,null);S(this,Vn,new Map);S(this,wr,!1);S(this,lu,!1);S(this,oa,!1);S(this,ci,null);S(this,Cs,null);S(this,kt,null);S(this,Ts,null);S(this,q);const p=[...c(Qn,Cr).values()];if(!Qn._initialized){Qn._initialized=!0;for(const g of p)g.initialize(h,e)}e.registerEditorTypes(p),v(this,q,e),this.pageIndex=t,this.div=i,v(this,ra,r),v(this,Bi,o),this.viewport=u,v(this,kt,l),this.drawLayer=a,this._structTree=s,c(this,q).addLayer(this)}get isEmpty(){return c(this,Vn).size===0}get isInvisible(){return this.isEmpty&&c(this,q).getMode()===ee.NONE}updateToolbar(e){c(this,q).updateToolbar(e)}updateMode(e=c(this,q).getMode()){switch(w(this,Ne,wf).call(this),e){case ee.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ee.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ee.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of c(Qn,Cr).values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=c(this,kt))==null?void 0:t.div)}setEditingState(e){c(this,q).setEditingState(e)}addCommands(e){c(this,q).addCommands(e)}cleanUndoStack(e){c(this,q).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=c(this,Bi))==null||t.div.classList.toggle("disabled",!e)}async enable(){v(this,oa,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const i of c(this,Vn).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(c(this,q).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));if(!c(this,Bi)){v(this,oa,!1);return}const t=c(this,Bi).getEditableAnnotations();for(const i of t){if(i.hide(),c(this,q).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}v(this,oa,!1)}disable(){var s;v(this,lu,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of c(this,Vn).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(s=this.getEditableAnnotation(r.annotationElementId))==null||s.show(),r.remove()}if(c(this,Bi)){const r=c(this,Bi).getEditableAnnotations();for(const o of r){const{id:a}=o.data;if(c(this,q).isDeletedAnnotationElement(a))continue;let l=t.get(a);if(l){l.resetAnnotationElement(o),l.show(!1),o.show();continue}l=e.get(a),l&&(c(this,q).addChangedExistingAnnotation(l),l.renderAnnotationElement(o)&&l.show(!1)),o.show()}}w(this,Ne,wf).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of c(Qn,Cr).values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),v(this,lu,!1)}getEditableAnnotation(e){var t;return((t=c(this,Bi))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){c(this,q).getActive()!==e&&c(this,q).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=c(this,kt))!=null&&e.div&&!c(this,Ts)){v(this,Ts,new AbortController);const t=c(this,q).combinedSignal(c(this,Ts));c(this,kt).div.addEventListener("pointerdown",w(this,Ne,QT).bind(this),{signal:t}),c(this,kt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=c(this,kt))!=null&&e.div&&c(this,Ts)&&(c(this,Ts).abort(),v(this,Ts,null),c(this,kt).div.classList.remove("highlighting"))}enableClick(){if(c(this,Sr))return;v(this,Sr,new AbortController);const e=c(this,q).combinedSignal(c(this,Sr));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=c(this,Sr))==null||e.abort(),v(this,Sr,null)}attach(e){c(this,Vn).set(e.id,e);const{annotationElementId:t}=e;t&&c(this,q).isDeletedAnnotationElement(t)&&c(this,q).removeDeletedAnnotationElement(e)}detach(e){var t;c(this,Vn).delete(e.id),(t=c(this,ra))==null||t.removePointerInTextLayer(e.contentDiv),!c(this,lu)&&e.annotationElementId&&c(this,q).addDeletedAnnotationElement(e)}remove(e){this.detach(e),c(this,q).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(c(this,q).addDeletedAnnotationElement(e.annotationElementId),He.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),c(this,q).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!c(this,oa)),c(this,q).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var i;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!c(this,ws)&&(e._focusEventsAllowed=!1,v(this,ws,setTimeout(()=>{v(this,ws,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:c(this,q)._signal}),t.focus())},0))),e._structTreeParentId=(i=c(this,ra))==null?void 0:i.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return c(this,q).getId()}combinedSignal(e){return c(this,q).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=c(this,Ne,Ci))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){c(this,q).updateToolbar(e),c(this,q).updateMode(e);const{offsetX:i,offsetY:s}=w(this,Ne,$y).call(this),r=this.getNextId(),o=w(this,Ne,qy).call(this,{parent:this,id:r,x:i,y:s,uiManager:c(this,q),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=c(Qn,Cr).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,c(this,q)))||null}createAndAddNewEditor(e,t,i={}){const s=this.getNextId(),r=w(this,Ne,qy).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:c(this,q),isCentered:t,...i});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(w(this,Ne,$y).call(this),!0)}setSelected(e){c(this,q).setSelected(e)}toggleSelected(e){c(this,q).toggleSelected(e)}unselect(e){c(this,q).unselect(e)}pointerup(e){var i;const{isMac:t}=$t.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&c(this,wr)&&(v(this,wr,!1),!((i=c(this,Ne,Ci))!=null&&i.isDrawer&&c(this,Ne,Ci).supportMultipleDrawings))){if(!c(this,au)){v(this,au,!0);return}if(c(this,q).getMode()===ee.STAMP){c(this,q).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var s;if(c(this,q).getMode()===ee.HIGHLIGHT&&this.enableTextSelection(),c(this,wr)){v(this,wr,!1);return}const{isMac:t}=$t.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(v(this,wr,!0),(s=c(this,Ne,Ci))!=null&&s.isDrawer){this.startDrawingSession(e);return}const i=c(this,q).getActive();v(this,au,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus(),c(this,ci)){c(this,Ne,Ci).startDrawing(this,c(this,q),!1,e);return}c(this,q).setCurrentDrawingSession(this),v(this,ci,new AbortController);const t=c(this,q).combinedSignal(c(this,ci));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(v(this,Cs,null),this.commitOrRemove())},{signal:t}),c(this,Ne,Ci).startDrawing(this,c(this,q),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&v(this,Cs,t);return}c(this,Cs)&&setTimeout(()=>{var t;(t=c(this,Cs))==null||t.focus(),v(this,Cs,null)},0)}endDrawingSession(e=!1){return c(this,ci)?(c(this,q).setCurrentDrawingSession(null),c(this,ci).abort(),v(this,ci,null),v(this,Cs,null),c(this,Ne,Ci).endDrawing(e)):null}findNewParent(e,t,i){const s=c(this,q).findParent(t,i);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return c(this,ci)?(this.endDrawingSession(),!0):!1}onScaleChanging(){c(this,ci)&&c(this,Ne,Ci).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=c(this,q).getActive())==null?void 0:e.parent)===this&&(c(this,q).commitOrRemove(),c(this,q).setActiveEditor(null)),c(this,ws)&&(clearTimeout(c(this,ws)),v(this,ws,null));for(const i of c(this,Vn).values())(t=c(this,ra))==null||t.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,c(this,Vn).clear(),c(this,q).removeLayer(this)}render({viewport:e}){this.viewport=e,ga(this.div,e);for(const t of c(this,q).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){c(this,q).commitOrRemove(),w(this,Ne,wf).call(this);const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,ga(this.div,{rotation:i}),t!==i)for(const s of c(this,Vn).values())s.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return c(this,q).viewParameters.realScale}};ra=new WeakMap,au=new WeakMap,Bi=new WeakMap,Sr=new WeakMap,ws=new WeakMap,Vn=new WeakMap,wr=new WeakMap,lu=new WeakMap,oa=new WeakMap,ci=new WeakMap,Cs=new WeakMap,kt=new WeakMap,Ts=new WeakMap,q=new WeakMap,Cr=new WeakMap,Ne=new WeakSet,QT=function(e){c(this,q).unselectAll();const{target:t}=e;if(t===c(this,kt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&c(this,kt).div.contains(t)){const{isMac:i}=$t.platform;if(e.button!==0||e.ctrlKey&&i)return;c(this,q).showAllEditors("highlight",!0,!0),c(this,kt).div.classList.add("free"),this.toggleDrawing(),sp.startHighlighting(this,c(this,q).direction==="ltr",{target:c(this,kt).div,x:e.x,y:e.y}),c(this,kt).div.addEventListener("pointerup",()=>{c(this,kt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:c(this,q)._signal}),e.preventDefault()}},Ci=function(){return c(Qn,Cr).get(c(this,q).getMode())},qy=function(e){const t=c(this,Ne,Ci);return t?new t.prototype.constructor(e):null},$y=function(){const{x:e,y:t,width:i,height:s}=this.div.getBoundingClientRect(),r=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+i),l=Math.min(window.innerHeight,t+s),u=(r+a)/2-e,h=(o+l)/2-t,[p,g]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:p,offsetY:g}},wf=function(){for(const e of c(this,Vn).values())e.isEmpty()&&e.remove()},J(Qn,"_initialized",!1),S(Qn,Cr,new Map([Cy,Vy,Oy,sp].map(e=>[e._editorType,e])));let zy=Qn;var di,ih,Bt,aa,Cp,ZT,Wi,Yy,jT,Ky;const xt=class xt{constructor({pageIndex:e}){S(this,Wi);S(this,di,null);S(this,ih,0);S(this,Bt,new Map);S(this,aa,new Map);this.pageIndex=e}setParent(e){if(!c(this,di)){v(this,di,e);return}if(c(this,di)!==e){if(c(this,Bt).size>0)for(const t of c(this,Bt).values())t.remove(),e.append(t);v(this,di,e)}}static get _svgFactory(){return oe(this,"_svgFactory",new r0)}draw(e,t=!1,i=!1){const s=Ut(this,ih)._++,r=w(this,Wi,Yy).call(this),o=xt._svgFactory.createElement("defs");r.append(o);const a=xt._svgFactory.createElement("path");o.append(a);const l=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke"),t&&c(this,aa).set(s,a);const u=i?w(this,Wi,jT).call(this,o,l):null,h=xt._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(r,e),c(this,Bt).set(s,r),{id:s,clipPathId:`url(#${u})`}}drawOutline(e,t){const i=Ut(this,ih)._++,s=w(this,Wi,Yy).call(this),r=xt._svgFactory.createElement("defs");s.append(r);const o=xt._svgFactory.createElement("path");r.append(o);const a=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const p=xt._svgFactory.createElement("mask");r.append(p),l=`mask_p${this.pageIndex}_${i}`,p.setAttribute("id",l),p.setAttribute("maskUnits","objectBoundingBox");const g=xt._svgFactory.createElement("rect");p.append(g),g.setAttribute("width","1"),g.setAttribute("height","1"),g.setAttribute("fill","white");const m=xt._svgFactory.createElement("use");p.append(m),m.setAttribute("href",`#${a}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const u=xt._svgFactory.createElement("use");s.append(u),u.setAttribute("href",`#${a}`),l&&u.setAttribute("mask",`url(#${l})`);const h=u.cloneNode();return s.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(s,e),c(this,Bt).set(i,s),i}finalizeDraw(e,t){c(this,aa).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:i,bbox:s,rootClass:r,path:o}=t,a=typeof e=="number"?c(this,Bt).get(e):e;if(a){if(i&&w(this,Wi,Ky).call(this,a,i),s&&w(l=xt,Cp,ZT).call(l,a,s),r){const{classList:u}=a;for(const[h,p]of Object.entries(r))u.toggle(h,p)}if(o){const h=a.firstChild.firstChild;w(this,Wi,Ky).call(this,h,o)}}}updateParent(e,t){if(t===this)return;const i=c(this,Bt).get(e);i&&(c(t,di).append(i),c(this,Bt).delete(e),c(t,Bt).set(e,i))}remove(e){c(this,aa).delete(e),c(this,di)!==null&&(c(this,Bt).get(e).remove(),c(this,Bt).delete(e))}destroy(){v(this,di,null);for(const e of c(this,Bt).values())e.remove();c(this,Bt).clear(),c(this,aa).clear()}};di=new WeakMap,ih=new WeakMap,Bt=new WeakMap,aa=new WeakMap,Cp=new WeakSet,ZT=function(e,[t,i,s,r]){const{style:o}=e;o.top=`${100*i}%`,o.left=`${100*t}%`,o.width=`${100*s}%`,o.height=`${100*r}%`},Wi=new WeakSet,Yy=function(){const e=xt._svgFactory.create(1,1,!0);return c(this,di).append(e),e.setAttribute("aria-hidden",!0),e},jT=function(e,t){const i=xt._svgFactory.createElement("clipPath");e.append(i);const s=`clip_${t}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const r=xt._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),s},Ky=function(e,t){for(const[i,s]of Object.entries(t))s===null?e.removeAttribute(i):e.setAttribute(i,s)},S(xt,Cp);let Wy=xt;globalThis.pdfjsTestingUtils={HighlightOutliner:Iy};Z.AbortException;Z.AnnotationEditorLayer;Z.AnnotationEditorParamsType;Z.AnnotationEditorType;Z.AnnotationEditorUIManager;Z.AnnotationLayer;Z.AnnotationMode;Z.ColorPicker;Z.DOMSVGFactory;Z.DrawLayer;Z.FeatureTest;var hF=Z.GlobalWorkerOptions;Z.ImageKind;Z.InvalidPDFException;Z.MissingPDFException;Z.OPS;Z.OutputScale;Z.PDFDataRangeTransport;Z.PDFDateString;Z.PDFWorker;Z.PasswordResponses;Z.PermissionFlag;Z.PixelsPerInch;Z.RenderingCancelledException;Z.TextLayer;Z.TouchManager;Z.UnexpectedResponseException;Z.Util;Z.VerbosityLevel;Z.XfaLayer;Z.build;Z.createValidAbsoluteUrl;Z.fetchData;var fF=Z.getDocument;Z.getFilenameFromUrl;Z.getPdfFilenameFromUrl;Z.getXfaPageViewport;Z.isDataScheme;Z.isPdfFile;Z.noContextMenu;Z.normalizeUnicode;Z.setLayerDimensions;Z.shadow;Z.stopEvent;Z.version;const pF=n=>D.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:[D.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.432 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),D.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),gF=n=>D.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:D.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243l-4.243-4.243"})}),mF="NIN-EN-2024@",yF=({onLoginSuccess:n})=>{const[e,t]=nt.useState(""),[i,s]=nt.useState(""),[r,o]=nt.useState(!1),a=l=>{l.preventDefault(),e===mF?(s(""),n()):(s("Falsches Passwort. Bitte versuchen Sie es erneut."),t(""))};return D.jsx("div",{className:"min-h-screen bg-gray-100 text-gray-800 flex flex-col items-center justify-center p-4",children:D.jsxs("div",{className:"w-full max-w-sm",children:[D.jsxs("div",{className:"text-center mb-8",children:[D.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-[#88bd24]",children:"KI-Mngelbericht"}),D.jsx("p",{className:"mt-2 text-gray-600",children:"Bitte authentifizieren Sie sich, um fortzufahren."})]}),D.jsxs("form",{onSubmit:a,className:"bg-white p-6 rounded-2xl shadow-lg border border-gray-200 flex flex-col gap-4",children:[D.jsxs("div",{children:[D.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Passwort"}),D.jsxs("div",{className:"relative",children:[D.jsx("input",{id:"password",type:r?"text":"password",value:e,onChange:l=>t(l.target.value),className:"w-full bg-gray-50 rounded-lg p-3 pr-10 text-gray-800 border border-gray-300 focus:ring-2 focus:ring-[#88bd24] focus:border-[#88bd24] transition-colors",required:!0,autoFocus:!0,"aria-describedby":"password-error"}),D.jsx("button",{type:"button",onClick:()=>o(!r),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":r?"Passwort ausblenden":"Passwort anzeigen",children:r?D.jsx(gF,{className:"h-5 w-5"}):D.jsx(pF,{className:"h-5 w-5"})})]})]}),i&&D.jsx("p",{id:"password-error",className:"text-red-600 text-sm -mt-2",children:i}),D.jsx("button",{type:"submit",className:"w-full flex items-center justify-center gap-3 px-6 py-3 rounded-lg font-semibold text-white transition-all duration-300 ease-in-out bg-[#88bd24] hover:bg-[#79a820] disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105",children:"Anmelden"})]}),D.jsx("footer",{className:"w-full text-center mt-8 text-gray-500 text-sm",children:D.jsx("p",{children:"by Didier Arm"})})]})})};hF.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.4.168/build/pdf.worker.mjs";const gE="app_authenticated",vF=()=>{const[n,e]=nt.useState(()=>sessionStorage.getItem(gE)==="true"),[t,i]=nt.useState(""),[s,r]=nt.useState([]),[o,a]=nt.useState(""),[l,u]=nt.useState(""),[h,p]=nt.useState(!1),[g,m]=nt.useState(!1),[y,A]=nt.useState(""),T=()=>{sessionStorage.setItem(gE,"true"),e(!0)},_=x=>{i(x),u(""),A("")},E=x=>{r(x),u(""),A("")};nt.useEffect(()=>{(async()=>{if(s.length===0){a("");return}m(!0),A("");let R="";try{for(const P of s){const M=await P.arrayBuffer(),k=await fF(M).promise,N=k.numPages;for(let L=1;L<=N;L++){const se=(await(await k.getPage(L)).getTextContent()).items.map(De=>"str"in De?De.str:"").join(" ");R+=se+`

`}}a(R)}catch(P){console.error("Error parsing PDFs:",P),A("Fehler beim Verarbeiten der PDF-Dateien. Bitte stellen Sie sicher, dass es sich um gltige PDF-Dokumente handelt."),r([]),a("")}finally{m(!1)}})()},[s]);const C=nt.useCallback(async()=>{if(!t){A("Bitte geben Sie zuerst eine Beschreibung ein.");return}p(!0),A(""),u("");try{const x=await hD(t,o);u(x)}catch(x){console.error(x),A("Fehler bei der Analyse der Beschreibung. Bitte versuchen Sie es erneut.")}finally{p(!1)}},[t,o]),I=h||g;return n?D.jsxs("div",{className:"min-h-screen bg-gray-100 text-gray-800 flex flex-col items-center p-4 sm:p-6 lg:p-8",children:[D.jsxs("header",{className:"w-full max-w-4xl text-center mb-8",children:[D.jsx("div",{className:"flex items-center justify-center gap-3",children:D.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-[#88bd24]",children:"KI-Mngelbericht"})}),D.jsx("p",{className:"mt-2 text-gray-600",children:"Analysieren Sie eine Elektroinstallation mit optionalem Dokumenten-Kontext fr przisere Ergebnisse."})]}),D.jsxs("main",{className:"w-full max-w-4xl flex-grow flex flex-col gap-8",children:[D.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg border border-gray-200",children:[D.jsx(NP,{onDescriptionChange:_,description:t}),D.jsx(LP,{files:s,onFilesChange:E,isParsing:g}),D.jsx("h2",{className:"text-xl font-semibold my-4 text-gray-700",children:"3. Analyse starten"}),D.jsx("button",{onClick:C,disabled:!t||I,className:"w-full flex items-center justify-center gap-3 px-6 py-3 rounded-lg font-semibold text-white transition-all duration-300 ease-in-out bg-[#88bd24] hover:bg-[#79a820] disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 disabled:scale-100 shadow-lg",children:I?D.jsxs(D.Fragment,{children:[D.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[D.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),D.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),g?"Verarbeite PDFs...":"Analysiere..."]}):"Mngel analysieren"})]}),D.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg border border-gray-200 flex flex-col",children:[D.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-700",children:"Analyseergebnis"}),y&&D.jsxs("div",{className:"bg-red-100 text-red-800 border border-red-300 rounded-lg p-4 mb-4 flex items-center gap-3",children:[D.jsx("span",{role:"img","aria-label":"Warning",className:"text-xl",children:""}),D.jsx("span",{children:y})]}),D.jsx(UP,{result:l,isLoading:h})]})]}),D.jsx("footer",{className:"w-full max-w-4xl text-center mt-8 text-gray-500 text-sm",children:D.jsx("p",{children:"by Didier Arm"})})]}):D.jsx(yF,{onLoginSuccess:T})},eI=document.getElementById("root");if(!eI)throw new Error("Could not find root element to mount to");const _F=bg.createRoot(eI);_F.render(D.jsx(AI.StrictMode,{children:D.jsx(vF,{})}));
